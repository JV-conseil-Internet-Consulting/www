{"version":3,"file":"push-state-deepdive-9.1.7.min.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEiC;AACqC;AAE1B;AAE5C,IAAMQ,UAAU,GAAG,6YAAuC;;AAE1D;AACA,IAAMC,QAAQ,GAAIC,GAAG,IAAK;EAAA,IAAAC,oBAAA;EACxB,IAAMC,OAAO,GAAGF,GAAG,CAACG,cAAc,CAAC,UAAU,CAAC;EAC9C,IAAMC,SAAS,GAAGF,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEG,aAAa,CAAC,aAAa,CAAC;EACvD,IAAMC,SAAS,GAAGN,GAAG,CAACG,cAAc,CAAC,YAAY,CAAC;EAClD;EACA;EACA;EACA,OAAO,CACLG,SAAS,aAATA,SAAS,wBAAAL,oBAAA,GAATK,SAAS,CAAEC,SAAS,cAAAN,oBAAA,uBAApBA,oBAAA,CAAsBO,IAAI,EAAE,EAC5BN,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEO,SAAS,EAClBL,SAAS,aAATA,SAAS,uBAATA,SAAS,CAAEK,SAAS,EACpBL,SAAS,aAATA,SAAS,uBAATA,SAAS,CAAEM,KAAK,CAACC,eAAe,CACjC,CAACC,IAAI,CAAC,IAAI,CAAC;AACd,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,SAASC,UAAUA,CAAAC,IAAA,EAAiD;EAAA,IAAhD;IAAEC,QAAQ;IAAEC;EAAK,CAAC,GAAAF,IAAA;EAAA,IAAEG,QAAQ,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAGG,MAAM,CAACJ,QAAQ;EAChE,OAAOF,QAAQ,KAAKE,QAAQ,CAACF,QAAQ,IAAIC,IAAI,KAAKC,QAAQ,CAACD,IAAI;AACjE;AAEA,IAAMM,UAAU,GAAG,IAAIC,OAAO,EAAE;AAEzB,MAAMC,UAAU,CAAC;EACtB;EACAC,WAAWA,CAACC,YAAY,EAAE;IACxB,IAAI,CAACxB,OAAO,GAAGyB,QAAQ,CAACxB,cAAc,CAAC,UAAU,CAAC;IAClD,IAAI,CAACuB,YAAY,GAAGA,YAAY;IAChC,IAAI,CAACE,QAAQ,GAAG7B,QAAQ,CAAC4B,QAAQ,CAAC;IAClC,IAAI,CAACE,YAAY,GAAGF,QAAQ,CAACtB,aAAa,CAAC,0BAA0B,CAAC;EACxE;;EAEA;EACAyB,WAAWA,CAACC,WAAW,EAAE;IAAA,IAAAC,qBAAA,EAAAC,sBAAA;IACvB,IAAM;MAAEtB,eAAe,GAAG;IAAG,CAAC,IAAAqB,qBAAA,IAAAC,sBAAA,GAAGF,WAAW,CAAC1B,aAAa,CAAC,aAAa,CAAC,cAAA4B,sBAAA,uBAAxCA,sBAAA,CAA0CvB,KAAK,cAAAsB,qBAAA,cAAAA,qBAAA,GAAI,CAAC,CAAC;IACtF,IAAME,MAAM,GAAGpC,UAAU,CAACqC,IAAI,CAACxB,eAAe,CAAC;IAC/C,IAAI,CAACuB,MAAM,EAAE;MACX,OAAO3C,wCAAE,CAAC,EAAE,CAAC;IACf;IAEA,IAAM6C,GAAG,GAAG,IAAIC,GAAG,CAACH,MAAM,CAAC,CAAC,CAAC,EAAEb,MAAM,CAACJ,QAAQ,CAACqB,MAAM,CAAC;IAEtD,OAAOzC,gDAAO,CAACuC,GAAG,CAACG,IAAI,EAAAC,aAAA;MACrBC,MAAM,EAAE,KAAK;MACbC,OAAO,EAAE;QAAEC,MAAM,EAAE;MAAU;IAAC,GAC1B9B,UAAU,CAACuB,GAAG,CAAC,GAAG;MAAEQ,IAAI,EAAE;IAAO,CAAC,GAAG,CAAC,CAAC,EAC3C,CAACC,IAAI,CACLlD,yDAAS,CAAEmD,CAAC,IAAKA,CAAC,CAACC,IAAI,EAAE,CAAC,EAC1BrD,mDAAG,CAAEqD,IAAI,IAAKV,GAAG,CAACW,eAAe,CAACD,IAAI,CAAC,CAAC,EACxCvD,0DAAU,CAAC,MAAMD,wCAAE,CAAC6C,GAAG,CAACG,IAAI,CAAC,CAAC,CAC/B;EACH;;EAEA;EACAU,UAAUA,CAAClB,WAAW,EAAE;IACtB,IAAMmB,IAAI,GAAGnD,QAAQ,CAACgC,WAAW,CAAC;IAClC,IAAImB,IAAI,KAAK,IAAI,CAACtB,QAAQ,EAAE,OAAOtC,uCAAK;IAExC,OAAO,IAAI,CAACwC,WAAW,CAACC,WAAW,CAAC,CAACc,IAAI,CACvCnD,mDAAG,CAAEyD,SAAS,IAAK;MAAA,IAAAC,sBAAA;MACjB;MACA,IAAMC,GAAG,IAAAD,sBAAA,GAAGrB,WAAW,CAAC1B,aAAa,CAAC,aAAa,CAAC,cAAA+C,sBAAA,cAAAA,sBAAA,GAAIzB,QAAQ,CAAC2B,aAAa,CAAC,KAAK,CAAC;MAErF,IAAIH,SAAS,EAAE;QACbE,GAAG,CAAC3C,KAAK,CAACC,eAAe,UAAA4C,MAAA,CAAUJ,SAAS,MAAG;QAC/C7B,UAAU,CAACkC,GAAG,CAACH,GAAG,EAAEF,SAAS,CAAC;MAChC;MAEA,OAAO,CAACE,GAAG,EAAEH,IAAI,EAAEnB,WAAW,CAAC;IACjC,CAAC,CAAC,CACH;EACH;;EAEA;EACA0B,WAAWA,CAAC1B,WAAW,EAAE;IAAA,IAAA2B,qBAAA;IACvB,IAAMjD,SAAS,IAAAiD,qBAAA,GAAG3B,WAAW,CAAC5B,cAAc,CAAC,UAAU,CAAC,cAAAuD,qBAAA,uBAAtCA,qBAAA,CAAwCjD,SAAS;IACnE,IAAIA,SAAS,EAAE,IAAI,CAACP,OAAO,CAACyD,YAAY,CAAC,OAAO,EAAElD,SAAS,CAAC;IAE5D,IAAI,IAAI,CAACoB,YAAY,EAAE;MAAA,IAAA+B,qBAAA;MACrB,IAAMC,UAAU,IAAAD,qBAAA,GAAG7B,WAAW,CAAC+B,IAAI,CAACzD,aAAa,CAAC,0BAA0B,CAAC,cAAAuD,qBAAA,uBAA1DA,qBAAA,CAA4DG,OAAO;MACtF,IAAIF,UAAU,EAAE;QACdxC,MAAM,CAAC2C,UAAU,CAAC,MAAM;UACtB,IAAI,IAAI,CAACnC,YAAY,EAAE;YACrB,IAAI,CAACA,YAAY,CAACkC,OAAO,GAAGF,UAAU;UACxC;QACF,CAAC,EAAE,GAAG,CAAC;MACT;IACF;IAEA,IAAI;MAAA,IAAAI,qBAAA;MACF,IAAM3D,SAAS,GAAGqB,QAAQ,CAACxB,cAAc,CAAC,YAAY,CAAC;MACvD,IAAM+D,YAAY,GAAGnC,WAAW,CAAC5B,cAAc,CAAC,YAAY,CAAC;MAC7D,IAAI,CAAC+D,YAAY,EAAE;MACnB5D,SAAS,aAATA,SAAS,wBAAA2D,qBAAA,GAAT3D,SAAS,CAAE6D,UAAU,cAAAF,qBAAA,uBAArBA,qBAAA,CAAuBG,YAAY,CAACF,YAAY,EAAE5D,SAAS,CAAC;IAC9D,CAAC,CAAC,OAAO+D,CAAC,EAAE;MACV,IAAIC,IAAiB,EAAEG,OAAO,CAACC,KAAK,CAACL,CAAC,CAAC;IACzC;EACF;;EAEA;AACF;AACA;AACA;EACEM,IAAIA,CAAAC,KAAA,EAAAC,KAAA,EAAsC;IAAA,IAAAC,mBAAA;IAAA,IAArC,CAACC,OAAO,CAAC,GAAAH,KAAA;IAAA,IAAE,CAACvB,GAAG,EAAEH,IAAI,EAAEnB,WAAW,CAAC,GAAA8C,KAAA;IACtCE,OAAO,aAAPA,OAAO,wBAAAD,mBAAA,GAAPC,OAAO,CAAEZ,UAAU,cAAAW,mBAAA,uBAAnBA,mBAAA,CAAqBE,YAAY,CAAC3B,GAAG,EAAE0B,OAAO,CAACE,kBAAkB,CAAC;IAElE,IAAI,CAACxB,WAAW,CAAC1B,WAAW,CAAC;;IAE7B;IACA,IAAI,CAACH,QAAQ,GAAGsB,IAAI;IAEpB,OAAOtD,gDAAO,CAACyD,GAAG,EAAE,CAAC;MAAE6B,OAAO,EAAE;IAAE,CAAC,EAAE;MAAEA,OAAO,EAAE;IAAE,CAAC,CAAC,EAAE;MACpDC,QAAQ,EAAE,IAAI,CAACzD,YAAY;MAC3B0D,MAAM,EAAE;IACV,CAAC,CAAC,CAACvC,IAAI,CACLpD,wDAAQ,CAAC,MAAM;MAAA,IAAA4F,oBAAA;MACb,IAAI/D,UAAU,CAACgE,GAAG,CAACP,OAAO,CAAC,EAAE1C,GAAG,CAACkD,eAAe,CAACjE,UAAU,CAACkE,GAAG,CAACT,OAAO,CAAC,CAAC;MACzEA,OAAO,aAAPA,OAAO,wBAAAM,oBAAA,GAAPN,OAAO,CAAEZ,UAAU,cAAAkB,oBAAA,uBAAnBA,oBAAA,CAAqBI,WAAW,CAACV,OAAO,CAAC;IAC3C,CAAC,CAAC,CACH;EACH;AACF;;;;;;;;;;;;;;;;;ACnJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAE6B;AACW;AAEC;AAEzC,IAAMc,UAAU,GAAG,CAAC,OAAO,CAAC;AAErB,SAASC,SAASA,CAACC,MAAM,EAAEC,MAAM,EAAEC,OAAO,EAAEC,OAAO,EAAE;EAC1D,IAAMC,MAAM,GAAGJ,MAAM,CAAClD,IAAI,CAAC8C,sDAAM,CAAC7E,IAAA;IAAA,IAAC;MAAEsF;IAAS,CAAC,GAAAtF,IAAA;IAAA,OAAK,CAAC+E,UAAU,CAACQ,QAAQ,CAACD,QAAQ,CAAC;EAAA,EAAC,CAAC;EAEpF,OAAOV,2CAAK,CAACE,sDAAc,CAACG,MAAM,EAAEC,MAAM,EAAEC,OAAO,EAAEC,OAAO,CAAC,EAAEC,MAAM,CAAC;AACxE;;;;;;;;;;;;;;;;;;;;;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAE2C;AAC4B;AAE5B;AAE3C,IAAMO,cAAc,GAAG,0BAA0B;;AAEjD;AACA;AACA;AACA;AACA;AACA;AACO,SAASd,cAAcA,CAACG,MAAM,EAAEC,MAAM,EAAEC,OAAO,EAAAnF,IAAA,EAA+B;EAAA,IAA7B;IAAE6F,aAAa;IAAEC;EAAS,CAAC,GAAA9F,IAAA;EACjF,IAAI,CAAC6F,aAAa,EAAE,OAAOZ,MAAM;EAEjC,IAAMc,KAAK,GAAGd,MAAM,CAAClD,IAAI,CACvB8C,sDAAM,CAACf,KAAA;IAAA,IAAC;MAAEwB;IAAS,CAAC,GAAAxB,KAAA;IAAA,OAAKwB,QAAQ,KAAK,OAAO;EAAA,EAAC,EAC9CzG,yDAAS,CAACkF,KAAA,IAAgB;IAAA,IAAf;MAAEiC;IAAO,CAAC,GAAAjC,KAAA;IACnB,IAAI,CAACiC,MAAM,EAAE,OAAOvH,wCAAE,CAAC,CAAC,CAAC,CAAC;IAE1B,IAAMwH,KAAK,GAAGpF,QAAQ,CAAC2B,aAAa,CAAC,IAAI,CAAC;IAE1CyD,KAAK,CAACtG,SAAS,CAACuG,GAAG,CAAC,YAAY,CAAC;IACjCD,KAAK,CAACE,WAAW,GAAGH,MAAM,CAACG,WAAW;IACtCF,KAAK,CAACrG,KAAK,CAACwG,eAAe,GAAG,UAAU;IAExC,IAAMC,IAAI,GAAGR,aAAa,CAACtG,aAAa,CAAC,OAAO,CAAC;IACjD,IAAI,CAAC8G,IAAI,EAAE,OAAO5H,wCAAE,CAAC,CAAC,CAAC,CAAC;IAExBkH,+CAAU,CAACU,IAAI,CAAC;IAChBA,IAAI,CAACE,WAAW,CAACN,KAAK,CAAC;IAEvBJ,aAAa,CAACjG,KAAK,CAAC4G,QAAQ,GAAG,OAAO;IACtCX,aAAa,CAACjG,KAAK,CAACwE,OAAO,GAAG,CAAC;IAE/B,IAAMqC,KAAK,GAAGT,MAAM,CAACU,qBAAqB,EAAE;IAC5C,IAAMC,IAAI,GAAGV,KAAK,CAACS,qBAAqB,EAAE;IAC1C,IAAME,aAAa,GAAGC,QAAQ,CAACC,gBAAgB,CAACd,MAAM,CAAC,CAACe,QAAQ,EAAE,EAAE,CAAC;IACrE,IAAMC,YAAY,GAAGH,QAAQ,CAACC,gBAAgB,CAACb,KAAK,CAAC,CAACc,QAAQ,EAAE,EAAE,CAAC;IAEnE,IAAME,OAAO,GAAGR,KAAK,CAACS,IAAI,GAAGP,IAAI,CAACO,IAAI;IACtC,IAAMC,OAAO,GAAGV,KAAK,CAACW,GAAG,GAAGT,IAAI,CAACS,GAAG;IACpC,IAAMC,WAAW,GAAGT,aAAa,GAAGI,YAAY;IAEhDhB,MAAM,CAACpG,KAAK,CAACwE,OAAO,GAAG,CAAC;IAExB,IAAMkD,SAAS,GAAG,CAChB;MACEA,SAAS,iBAAA7E,MAAA,CAAiBwE,OAAO,UAAAxE,MAAA,CAAO0E,OAAO,mBAAA1E,MAAA,CAAgB4E,WAAW;IAC5E,CAAC,EACD;MAAEC,SAAS,EAAE;IAAgC,CAAC,CAC/C;IAED,OAAOxI,gDAAO,CAACmH,KAAK,EAAEqB,SAAS,EAAExB,QAAQ,CAAC,CAAC/D,IAAI,CAC7C2D,mDAAG,CAAC;MACF6B,QAAQA,CAAA,EAAG;QACT1B,aAAa,CAACjG,KAAK,CAAC4G,QAAQ,GAAG,UAAU;MAC3C;IACF,CAAC,CAAC,CACH;EACH,CAAC,CAAC,CACH;EAEDvB,MAAM,CACHlD,IAAI,CACHlD,yDAAS,CAAC2I,KAAA;IAAA,IAAC;MAAElC;IAAS,CAAC,GAAAkC,KAAA;IAAA,OACrB/B,yCAAG,CACDP,MAAM,CAACnD,IAAI,CACT8C,sDAAM,CAAC,MAAMS,QAAQ,KAAK,OAAO,CAAC,EAClC1G,mDAAG,CAAC6I,KAAA,IAA4B;MAAA,IAA3B;QAAEC,UAAU,EAAE,CAACC,IAAI;MAAE,CAAC,GAAAF,KAAA;MACzB,IAAMxB,KAAK,GAAG0B,IAAI,CAACpI,aAAa,CAACqG,cAAc,CAAC;MAChD,IAAIK,KAAK,EAAEA,KAAK,CAACrG,KAAK,CAACwE,OAAO,GAAG,CAAC;MAClC,OAAO6B,KAAK;IACd,CAAC,CAAC,CACH,EACDd,OAAO,CACR,CAACpD,IAAI,CACJnD,mDAAG,CAACgJ,KAAA;MAAA,IAAC,CAACC,CAAC,CAAC,GAAAD,KAAA;MAAA,OAAKC,CAAC;IAAA,EAAC,EACfnC,mDAAG,CAAEO,KAAK,IAAK;MACb,IAAIA,KAAK,EAAEA,KAAK,CAACrG,KAAK,CAACwE,OAAO,GAAG,CAAC;MAClCyB,aAAa,CAACjG,KAAK,CAACwE,OAAO,GAAG,CAAC;IACjC,CAAC,CAAC,EACFzF,wDAAQ,CAAC,MAAM;MACbkH,aAAa,CAACjG,KAAK,CAACwE,OAAO,GAAG,CAAC;MAE/B,IAAMiC,IAAI,GAAGR,aAAa,CAACtG,aAAa,CAAC,OAAO,CAAC;MACjDoG,+CAAU,CAACU,IAAI,CAAC;IAClB,CAAC,CAAC,CACH;EAAA,EACF,CACF,CACAyB,SAAS,EAAE;EAEd,OAAO/B,KAAK;AACd;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEoD;AAY5B;AAEsD;AACnC;AACR;AAEnC2C,iBAAA,CAAC,aAAY;EACX,MAAMC,OAAO,CAACC,GAAG,CAAC,CAChB,IAAI,OAAO,IAAIrI,MAAM,GAAG,EAAE,GAAG,CAAC,gTAA2D,CAAC,CAAC,EAC3F,IAAI,gBAAgB,IAAIA,MAAM,GAC1B,EAAE,GACF,CAAC,gVAA2E,CAAC,CAAC,EAClF,IAAI,SAAS,IAAIsI,OAAO,CAACC,SAAS,GAAG,EAAE,GAAG,CAAC,mNAAmE,CAAC,CAAC,EAChH,IAAI,sBAAsB,IAAIvI,MAAM,GAChC,EAAE,GACF,CAAC,8OAA+E,CAAC,CAAC,CACvF,CAAC;EAEF,MAAMkI,uDAAkB;EAExB,IAAMM,UAAU,GAAG,oCAAoC;EAEvD,IAAMC,mBAAmB,GAAG,IAAI;EAEhC,IAAMC,QAAQ,GAAG,CAAC;IAAE7E,OAAO,EAAE;EAAE,CAAC,EAAE;IAAEA,OAAO,EAAE;EAAE,CAAC,CAAC;EACjD,IAAM8E,OAAO,GAAG,CACd;IAAE9E,OAAO,EAAE,CAAC;IAAEkD,SAAS,EAAE;EAAoB,CAAC,EAC9C;IAAElD,OAAO,EAAE,CAAC;IAAEkD,SAAS,EAAE;EAAgB,CAAC,CAC3C;EAED,SAAS6B,kBAAkBA,CAACC,WAAW,EAAE;IAAA,IAAAC,qBAAA;IACvCD,WAAW,aAAXA,WAAW,wBAAAC,qBAAA,GAAXD,WAAW,CAAE/F,UAAU,cAAAgG,qBAAA,uBAAvBA,qBAAA,CAAyBnF,YAAY,CAACsE,uDAAc,CAAC,qBAAqB,CAAC,EAAEY,WAAW,CAAC;IACzF,OAAOA,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEE,sBAAsB;EAC5C;EAEA,SAASC,YAAYA,CAACC,QAAQ,EAAE;IAC9BA,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEjD,WAAW,CAACiC,uDAAc,CAAC,mBAAmB,CAAC,CAAC;IAC1D,OAAOgB,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEC,gBAAgB;EACnC;EAEA,SAASC,cAAcA,CAAC/B,IAAI,EAAErG,GAAG,EAAE;IACjC,IAAM;MAAEqI;IAAS,CAAC,GAAGrI,GAAG;IACxB,IAAMsC,KAAK,GAAG4E,uDAAc,CAAC,iBAAiB,CAAC;IAC/C,IAAMxC,MAAM,GAAGpC,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAErE,aAAa,CAAC,YAAY,CAAC;IACjD,IAAIyG,MAAM,EAAE;MACVA,MAAM,CAACvE,IAAI,GAAGkI,QAAQ;MACtB3D,MAAM,CAACG,WAAW,GAAGwD,QAAQ;IAC/B;IACAhC,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEpB,WAAW,CAAC3C,KAAK,CAAC;IACxB,OAAO+D,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAE8B,gBAAgB;EAC/B;EAEA,SAASG,WAAWA,CAACC,EAAE,EAAE;IAAA,IAAAC,gBAAA;IACvB,IAAID,EAAE,aAAFA,EAAE,eAAFA,EAAE,CAAElK,SAAS,CAACoK,QAAQ,CAAC,YAAY,CAAC,EAAE,OAAO,OAAO;IACxD,IAAIF,EAAE,aAAFA,EAAE,eAAFA,EAAE,CAAElK,SAAS,CAACoK,QAAQ,CAAC,cAAc,CAAC,EAAE,OAAO,SAAS;IAC5D,OAAOF,EAAE,aAAFA,EAAE,wBAAAC,gBAAA,GAAFD,EAAE,CAAEG,YAAY,cAAAF,gBAAA,uBAAhBA,gBAAA,CAAAxD,IAAA,CAAAuD,EAAE,EAAiB,WAAW,CAAC;EACxC;EAEA,IAAMT,WAAW,GAAGvI,QAAQ,CAACtB,aAAa,CAAC,eAAe,CAAC;EAC3D,IAAI,CAAC6J,WAAW,EAAE;EAElB,IAAM/E,QAAQ,GAAG4F,MAAM,CAACb,WAAW,CAACY,YAAY,CAAC,UAAU,CAAC,CAAC,IAAI,GAAG;EACpE,IAAMlE,QAAQ,GAAG;IACfzB,QAAQ,EAAEA,QAAQ;IAClBC,MAAM,EAAE;EACV,CAAC;EAED,IAAM4F,cAAc,GAAGpG,KAAA;IAAA,IAAC;MAAE6D;IAAK,CAAC,GAAA7D,KAAA;IAAA,OAAKhF,gDAAO,CAAC6I,IAAI,EAAEsB,QAAQ,EAAAvH,aAAA,CAAAA,aAAA,KAAOoE,QAAQ;MAAEqE,IAAI,EAAE;IAAU,GAAG,CAACpI,IAAI,CAACmG,qDAAK,CAAC;MAAEP;IAAK,CAAC,CAAC,CAAC;EAAA;EAErH,IAAMyC,aAAa,GAAGrG,KAAA;IAAA,IAAC;MAAE2D,UAAU,EAAE,CAACC,IAAI,CAAC;MAAErC;IAAS,CAAC,GAAAvB,KAAA;IAAA,OACrDjF,gDAAO,CAAC6I,IAAI,EAAEuB,OAAO,EAAEpD,QAAQ,CAAC,CAAC/D,IAAI,CAACmG,qDAAK,CAAC;MAAEP,IAAI;MAAErC;IAAS,CAAC,CAAC,CAAC;EAAA;EAElE,IAAM+E,QAAQ,GAAGxJ,QAAQ,CAACtB,aAAa,CAAC,WAAW,CAAC;EACpD,IAAMiK,QAAQ,GAAG3I,QAAQ,CAACtB,aAAa,CAACwJ,UAAU,CAAC;EAEnD,IAAMlD,aAAa,GAAGsD,kBAAkB,CAACC,WAAW,CAAC;EACrD,IAAMkB,SAAS,GAAGf,YAAY,CAACC,QAAQ,CAAC;EAExC,IAAMe,UAAU,GAAGA,CAACC,SAAS,EAAEC,KAAK,KAClC1C,+CAAS,CAACqB,WAAW,EAAEoB,SAAS,CAAC,CAACzI,IAAI,CACpCnD,mDAAG,CAAC4I,KAAA;IAAA,IAAC;MAAEkD;IAAO,CAAC,GAAAlD,KAAA;IAAA,OAAKkD,MAAM;EAAA,EAAC,EAC3BD,KAAK,GAAG7L,mDAAG,CAAC6L,KAAK,CAAC,GAAIE,CAAC,IAAKA,CAAC,EAC7BtC,qDAAK,EAAE,CACR;EAEH,IAAMpD,MAAM,GAAGsF,UAAU,CAAC,qBAAqB,EAAGG,MAAM,IACtDE,MAAM,CAACC,MAAM,CAACH,MAAM,EAAE;IAAEpF,QAAQ,EAAEsE,WAAW,CAACc,MAAM,CAAC1E,MAAM;EAAE,CAAC,CAAC,CAChE;EACD,IAAMd,MAAM,GAAGqF,UAAU,CAAC,qBAAqB,CAAC;EAChD,IAAMO,MAAM,GAAGP,UAAU,CAAC,qBAAqB,CAAC;EAChD,IAAMQ,SAAS,GAAGR,UAAU,CAAC,wBAAwB,CAAC;EACtD,IAAMS,MAAM,GAAGT,UAAU,CAAC,4BAA4B,CAAC;EAEvD,IAAMU,QAAQ,GAAGhG,MAAM,CAAClD,IAAI,CAC1BnD,mDAAG,CAAEsM,OAAO,IAAKN,MAAM,CAACC,MAAM,CAACK,OAAO,EAAE;IAAEvD,IAAI,EAAE9G,QAAQ,CAACxB,cAAc,CAAC,OAAO;EAAE,CAAC,CAAC,CAAC,EACpFqG,mDAAG,CAAC+B,KAAA,IAAc;IAAA,IAAb;MAAEE;IAAK,CAAC,GAAAF,KAAA;IACXE,IAAI,CAAC/H,KAAK,CAACuL,aAAa,GAAG,MAAM;EACnC,CAAC,CAAC,EACF5K,MAAM,CAAC6K,SAAS,IAAIf,QAAQ,aAARA,QAAQ,eAARA,QAAQ,CAAE1K,SAAS,CAACoK,QAAQ,CAAC,OAAO,CAAC,GACrDrE,mDAAG,CAAC,MAAM;IAAA,IAAA2F,oBAAA;IACRhB,QAAQ,CAAC1K,SAAS,CAAC2L,MAAM,CAAC,OAAO,CAAC;IAClC,CAAAD,oBAAA,GAAAhB,QAAQ,CAAChH,UAAU,cAAAgI,oBAAA,uBAAnBA,oBAAA,CAAqB9E,WAAW,CAAC8D,QAAQ,CAAC;EAC5C,CAAC,CAAC,GACDM,CAAC,IAAKA,CAAC,EACZ1C,0DAAU,CAACiC,cAAc,CAAC,EAC1BxE,mDAAG,CAACkC,KAAA;IAAA,IAAC;MAAED;IAAK,CAAC,GAAAC,KAAA;IAAA,OAAKjC,+CAAU,CAACgC,IAAI,CAAC;EAAA,EAAC,EACnCU,qDAAK,EAAE,CACR;EAED,IAAIiC,SAAS,EAAE;IACbS,SAAS,CAACjD,SAAS,CAAC,MAAM;MACxBwC,SAAS,CAAC1K,KAAK,CAAC2L,OAAO,GAAG,MAAM;IAClC,CAAC,CAAC;IACFrG,MAAM,CAAC4C,SAAS,CAAC,MAAM;MACrBwC,SAAS,CAAC1K,KAAK,CAAC2L,OAAO,GAAG,MAAM;IAClC,CAAC,CAAC;EACJ;EAEA,IAAMpG,OAAO,GAAG2F,MAAM,CAAC/I,IAAI,CACzBlD,yDAAS,CAAEqM,OAAO,IAAK;IACrB,IAAMM,CAAC,GAAGpB,aAAa,CAACc,OAAO,CAAC,CAACO,SAAS,EAAE;IAC5CP,OAAO,CAACQ,eAAe,CAACF,CAAC,CAAC;IAC1B,OAAOA,CAAC;EACV,CAAC,CAAC,EACFnD,qDAAK,EAAE,CACR;EAED,IAAMtC,KAAK,GAAGf,gDAAS,CAACC,MAAM,EAAEC,MAAM,EAAEN,4CAAK,CAACO,OAAO,EAAE6F,MAAM,CAAC,EAAE;IAC9DnF,aAAa;IACbC,QAAQ,EAAEA;EACZ,CAAC,CAAC,CAAC/D,IAAI,CAACsG,qDAAK,EAAE,CAAC;EAEhBpD,MAAM,CACHlD,IAAI,CACHlD,yDAAS,CAAEqM,OAAO,IAAK;IACrB,IAAMS,OAAO,GAAGlG,0CAAG,CAACuC,4CAAK,CAAC3D,QAAQ,CAAC,EAAE4G,QAAQ,EAAElF,KAAK,CAAC,CAAC0F,SAAS,EAAE;IACjEP,OAAO,CAACQ,eAAe,CAACC,OAAO,CAAC;IAChC,OAAOA,OAAO;EAChB,CAAC,CAAC,CACH,CACA7D,SAAS,EAAE;;EAEd;EACAmD,QAAQ,CAACnD,SAAS,EAAE;EACpB/B,KAAK,CAAC+B,SAAS,EAAE;EAEjB,IAAMxI,SAAS,GAAGuB,QAAQ,CAACtB,aAAa,CAAC,aAAa,CAAC;EACvD,IAAID,SAAS,EAAE;IACb,IAAMsM,UAAU,GAAG,IAAIlL,oDAAU,CAACsI,mBAAmB,CAAC;IACtD8B,MAAM,CACH/I,IAAI,CACHlD,yDAAS,CAACgN,KAAA;MAAA,IAAC;QAAEhL;MAAS,CAAC,GAAAgL,KAAA;MAAA,OACrBpG,0CAAG,CAACmG,UAAU,CAACzJ,UAAU,CAACtB,QAAQ,CAAC,EAAEsE,OAAO,CAAC,CAACpD,IAAI,CAChDnD,mDAAG,CAACkN,KAAA;QAAA,IAAC,CAACjE,CAAC,CAAC,GAAAiE,KAAA;QAAA,OAAKjE,CAAC;MAAA,EAAC,EACfU,0DAAS,CAACtD,MAAM,CAAC,CAClB;IAAA,EACF,EACDqD,0DAAS,CAAC,CAAChJ,SAAS,CAAC,CAAC,EACtB8I,yDAAQ,EAAE,EACVD,yDAAQ,CAAC4D,KAAA;MAAA,IAAC,CAACC,IAAI,EAAEC,IAAI,CAAC,GAAAF,KAAA;MAAA,OAAKH,UAAU,CAAC/H,IAAI,CAACmI,IAAI,EAAEC,IAAI,CAAC;IAAA,EAAC,CACxD,CACAnE,SAAS,EAAE;EAChB;EAEAkD,MAAM,CACHjJ,IAAI,CACHlD,yDAAS,CAACqN,MAAA,IAAa;IAAA,IAAZ;MAAE5K;IAAI,CAAC,GAAA4K,MAAA;IAChB,IAAI5B,SAAS,EAAEA,SAAS,CAAC1K,KAAK,CAAC2L,OAAO,GAAG,MAAM;IAE/C,IAAM5D,IAAI,GAAG9G,QAAQ,CAACxB,cAAc,CAAC,OAAO,CAAC;IAC7C,IAAIsI,IAAI,EAAEA,IAAI,CAAC/H,KAAK,CAACuL,aAAa,GAAG,EAAE;IACvCxF,+CAAU,CAACE,aAAa,aAAbA,aAAa,uBAAbA,aAAa,CAAEtG,aAAa,CAAC,OAAO,CAAC,CAAC;IACjDoG,+CAAU,CAACgC,IAAI,CAAC;IAEhB+B,cAAc,CAAC/B,IAAI,EAAErG,GAAG,CAAC;IAEzB,OAAOxC,gDAAO,CAAC6I,IAAI,EAAEuB,OAAO,EAAAxH,aAAA,CAAAA,aAAA,KAAOoE,QAAQ;MAAEqE,IAAI,EAAE;IAAU,GAAG;EAClE,CAAC,CAAC,CACH,CACArC,SAAS,EAAE;EAEd,0KAAyD;EAEzDvH,MAAM,CAAC4L,UAAU,GAAG/C,WAAW;AACjC,CAAC,GAAG","sources":["webpack://deepdive/./_js/src/cross-fader.js","webpack://deepdive/./_js/src/flip/index.js","webpack://deepdive/./_js/src/flip/title.js","webpack://deepdive/./_js/src/push-state.js"],"sourcesContent":["// Copyright (c) 2023 JV conseil <https://www.jv-conseil.net/>\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport { EMPTY, of } from 'rxjs';\nimport { catchError, finalize, map, switchMap } from 'rxjs/operators';\n\nimport { animate, fetchRx } from './common';\n\nconst RE_CSS_URL = /url\\s*\\(['\"]?(([^'\"\\\\]|\\\\.)*)['\"]?\\)/u;\n\n/** @param {Document} doc */\nconst calcHash = (doc) => {\n  const sidebar = doc.getElementById('_sidebar');\n  const sidebarBg = sidebar?.querySelector('.sidebar-bg');\n  const pageStyle = doc.getElementById('_pageStyle');\n  // const rule = Array.from(pageStyle?.sheet?.rules ?? []).find(r => r.selectorText === 'html');\n  // const accentColor = rule?.style.getPropertyValue('--accent-color') ?? '';\n  // const themeColor = rule?.style.getPropertyValue('--theme-color') ?? '';\n  return [\n    pageStyle?.innerText?.trim(),\n    sidebar?.classList,\n    sidebarBg?.classList,\n    sidebarBg?.style.backgroundImage,\n  ].join('\\n');\n};\n\n/**\n * Consider a URL external if either the protocol, hostname or port is different.\n * @param {URL} param0\n * @param {Location=} location\n */\nfunction isExternal({ protocol, host }, location = window.location) {\n  return protocol !== location.protocol || host !== location.host;\n}\n\nconst objectURLs = new WeakMap();\n\nexport class CrossFader {\n  /** @param {number} fadeDuration */\n  constructor(fadeDuration) {\n    this.sidebar = document.getElementById('_sidebar');\n    this.fadeDuration = fadeDuration;\n    this.prevHash = calcHash(document);\n    this.themeColorEl = document.querySelector('meta[name=\"theme-color\"]');\n  }\n\n  /** @param {Document} newDocument */\n  fetchImage2(newDocument) {\n    const { backgroundImage = '' } = newDocument.querySelector('.sidebar-bg')?.style ?? {};\n    const result = RE_CSS_URL.exec(backgroundImage);\n    if (!result) {\n      return of('');\n    }\n\n    const url = new URL(result[1], window.location.origin);\n\n    return fetchRx(url.href, {\n      method: 'GET',\n      headers: { Accept: 'image/*' },\n      ...(isExternal(url) ? { mode: 'cors' } : {}),\n    }).pipe(\n      switchMap((r) => r.blob()),\n      map((blob) => URL.createObjectURL(blob)),\n      catchError(() => of(url.href)),\n    );\n  }\n\n  /** @param {Document} newDocument */\n  fetchImage(newDocument) {\n    const hash = calcHash(newDocument);\n    if (hash === this.prevHash) return EMPTY;\n\n    return this.fetchImage2(newDocument).pipe(\n      map((objectURL) => {\n        /** @type {HTMLDivElement} */\n        const div = newDocument.querySelector('.sidebar-bg') ?? document.createElement('div');\n\n        if (objectURL) {\n          div.style.backgroundImage = `url(${objectURL})`;\n          objectURLs.set(div, objectURL);\n        }\n\n        return [div, hash, newDocument];\n      }),\n    );\n  }\n\n  /** @param {Document} newDocument */\n  updateStyle(newDocument) {\n    const classList = newDocument.getElementById('_sidebar')?.classList;\n    if (classList) this.sidebar.setAttribute('class', classList);\n\n    if (this.themeColorEl) {\n      const themeColor = newDocument.head.querySelector('meta[name=\"theme-color\"]')?.content;\n      if (themeColor) {\n        window.setTimeout(() => {\n          if (this.themeColorEl) {\n            this.themeColorEl.content = themeColor;\n          }\n        }, 250);\n      }\n    }\n\n    try {\n      const pageStyle = document.getElementById('_pageStyle');\n      const newPageStyle = newDocument.getElementById('_pageStyle');\n      if (!newPageStyle) return;\n      pageStyle?.parentNode?.replaceChild(newPageStyle, pageStyle);\n    } catch (e) {\n      if (process.env.DEBUG) console.error(e);\n    }\n  }\n\n  /**\n   * @param {[HTMLDivElement]} param0\n   * @param {[HTMLDListElement, string, Document]} param1\n   */\n  fade([prevDiv], [div, hash, newDocument]) {\n    prevDiv?.parentNode?.insertBefore(div, prevDiv.nextElementSibling);\n\n    this.updateStyle(newDocument);\n\n    // Only update the prev hash after we're actually in the fade stage\n    this.prevHash = hash;\n\n    return animate(div, [{ opacity: 0 }, { opacity: 1 }], {\n      duration: this.fadeDuration,\n      easing: 'ease',\n    }).pipe(\n      finalize(() => {\n        if (objectURLs.has(prevDiv)) URL.revokeObjectURL(objectURLs.get(prevDiv));\n        prevDiv?.parentNode?.removeChild(prevDiv);\n      }),\n    );\n  }\n}\n","// Copyright (c) 2023 JV conseil <https://www.jv-conseil.net/>\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport { merge } from 'rxjs';\nimport { filter } from 'rxjs/operators';\n\nimport { setupFLIPTitle } from './title';\n\nconst FLIP_TYPES = ['title'];\n\nexport function setupFLIP(start$, ready$, fadeIn$, options) {\n  const other$ = start$.pipe(filter(({ flipType }) => !FLIP_TYPES.includes(flipType)));\n\n  return merge(setupFLIPTitle(start$, ready$, fadeIn$, options), other$);\n}\n","// Copyright (c) 2023 JV conseil <https://www.jv-conseil.net/>\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport { Observable, of, zip } from 'rxjs';\nimport { tap, finalize, filter, map, switchMap } from 'rxjs/operators';\n\nimport { animate, empty } from '../common';\n\nconst TITLE_SELECTOR = '.page-title, .post-title';\n\n/**\n * @param {Observable<any>} start$\n * @param {Observable<any>} ready$\n * @param {Observable<any>} fadeIn$\n * @param {any} opts\n */\nexport function setupFLIPTitle(start$, ready$, fadeIn$, { animationMain, settings }) {\n  if (!animationMain) return start$;\n\n  const flip$ = start$.pipe(\n    filter(({ flipType }) => flipType === 'title'),\n    switchMap(({ anchor }) => {\n      if (!anchor) return of({});\n\n      const title = document.createElement('h1');\n\n      title.classList.add('page-title');\n      title.textContent = anchor.textContent;\n      title.style.transformOrigin = 'left top';\n\n      const page = animationMain.querySelector('.page');\n      if (!page) return of({});\n\n      empty.call(page);\n      page.appendChild(title);\n\n      animationMain.style.position = 'fixed';\n      animationMain.style.opacity = 1;\n\n      const first = anchor.getBoundingClientRect();\n      const last = title.getBoundingClientRect();\n      const firstFontSize = parseInt(getComputedStyle(anchor).fontSize, 10);\n      const lastFontSize = parseInt(getComputedStyle(title).fontSize, 10);\n\n      const invertX = first.left - last.left;\n      const invertY = first.top - last.top;\n      const invertScale = firstFontSize / lastFontSize;\n\n      anchor.style.opacity = 0;\n\n      const transform = [\n        {\n          transform: `translate3d(${invertX}px, ${invertY}px, 0) scale(${invertScale})`,\n        },\n        { transform: 'translate3d(0, 0, 0) scale(1)' },\n      ];\n\n      return animate(title, transform, settings).pipe(\n        tap({\n          complete() {\n            animationMain.style.position = 'absolute';\n          },\n        }),\n      );\n    }),\n  );\n\n  start$\n    .pipe(\n      switchMap(({ flipType }) =>\n        zip(\n          ready$.pipe(\n            filter(() => flipType === 'title'),\n            map(({ replaceEls: [main] }) => {\n              const title = main.querySelector(TITLE_SELECTOR);\n              if (title) title.style.opacity = 0;\n              return title;\n            }),\n          ),\n          fadeIn$,\n        ).pipe(\n          map(([x]) => x),\n          tap((title) => {\n            if (title) title.style.opacity = 1;\n            animationMain.style.opacity = 0;\n          }),\n          finalize(() => {\n            animationMain.style.opacity = 0;\n\n            const page = animationMain.querySelector('.page');\n            empty.call(page);\n          }),\n        ),\n      ),\n    )\n    .subscribe();\n\n  return flip$;\n}\n","// Copyright (c) 2023 JV conseil <https://www.jv-conseil.net/>\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport { fromEvent, merge, timer, zip } from 'rxjs';\nimport {\n  tap,\n  exhaustMap,\n  map,\n  mapTo,\n  mergeMap,\n  pairwise,\n  share,\n  startWith,\n  switchMap,\n  takeUntil,\n} from 'rxjs/operators';\n\nimport { animate, empty, importTemplate, webComponentsReady } from './common';\nimport { CrossFader } from './cross-fader';\nimport { setupFLIP } from './flip';\n\n(async () => {\n  await Promise.all([\n    ...('fetch' in window ? [] : [import(/* webpackChunkName: \"fetch\" */ './polyfills/fetch')]),\n    ...('customElements' in window\n      ? []\n      : [import(/* webpackChunkName: \"webcomponents\" */ './polyfills/webcomponents')]),\n    ...('animate' in Element.prototype ? [] : [import(/* webpackChunkName: \"webanimations\" */ 'web-animations-js')]),\n    ...('IntersectionObserver' in window\n      ? []\n      : [import(/* webpackChunkName: \"intersection-observer\" */ 'intersection-observer')]),\n  ]);\n\n  await webComponentsReady;\n\n  const NAVBAR_SEL = '#_navbar > .content > .nav-btn-bar';\n\n  const CROSS_FADE_DURATION = 2000;\n\n  const FADE_OUT = [{ opacity: 1 }, { opacity: 0 }];\n  const FADE_IN = [\n    { opacity: 0, transform: 'translateY(-3rem)' },\n    { opacity: 1, transform: 'translateY(0)' },\n  ];\n\n  function setupAnimationMain(pushStateEl) {\n    pushStateEl?.parentNode?.insertBefore(importTemplate('_animation-template'), pushStateEl);\n    return pushStateEl?.previousElementSibling;\n  }\n\n  function setupLoading(navbarEl) {\n    navbarEl?.appendChild(importTemplate('_loading-template'));\n    return navbarEl?.lastElementChild;\n  }\n\n  function setupErrorPage(main, url) {\n    const { pathname } = url;\n    const error = importTemplate('_error-template');\n    const anchor = error?.querySelector('.this-link');\n    if (anchor) {\n      anchor.href = pathname;\n      anchor.textContent = pathname;\n    }\n    main?.appendChild(error);\n    return main?.lastElementChild;\n  }\n\n  function getFlipType(el) {\n    if (el?.classList.contains('flip-title')) return 'title';\n    if (el?.classList.contains('flip-project')) return 'project';\n    return el?.getAttribute?.('data-flip');\n  }\n\n  const pushStateEl = document.querySelector('hy-push-state');\n  if (!pushStateEl) return;\n\n  const duration = Number(pushStateEl.getAttribute('duration')) || 350;\n  const settings = {\n    duration: duration,\n    easing: 'ease',\n  };\n\n  const animateFadeOut = ({ main }) => animate(main, FADE_OUT, { ...settings, fill: 'forwards' }).pipe(mapTo({ main }));\n\n  const animateFadeIn = ({ replaceEls: [main], flipType }) =>\n    animate(main, FADE_IN, settings).pipe(mapTo({ main, flipType }));\n\n  const drawerEl = document.querySelector('hy-drawer');\n  const navbarEl = document.querySelector(NAVBAR_SEL);\n\n  const animationMain = setupAnimationMain(pushStateEl);\n  const loadingEl = setupLoading(navbarEl);\n\n  const fromEventX = (eventName, mapFn) =>\n    fromEvent(pushStateEl, eventName).pipe(\n      map(({ detail }) => detail),\n      mapFn ? map(mapFn) : (_) => _,\n      share(),\n    );\n\n  const start$ = fromEventX('hy-push-state-start', (detail) =>\n    Object.assign(detail, { flipType: getFlipType(detail.anchor) }),\n  );\n  const ready$ = fromEventX('hy-push-state-ready');\n  const after$ = fromEventX('hy-push-state-after');\n  const progress$ = fromEventX('hy-push-state-progress');\n  const error$ = fromEventX('hy-push-state-networkerror');\n\n  const fadeOut$ = start$.pipe(\n    map((context) => Object.assign(context, { main: document.getElementById('_main') })),\n    tap(({ main }) => {\n      main.style.pointerEvents = 'none';\n    }),\n    window._noDrawer && drawerEl?.classList.contains('cover')\n      ? tap(() => {\n          drawerEl.classList.remove('cover');\n          drawerEl.parentNode?.appendChild(drawerEl);\n        })\n      : (_) => _,\n    exhaustMap(animateFadeOut),\n    tap(({ main }) => empty.call(main)),\n    share(),\n  );\n\n  if (loadingEl) {\n    progress$.subscribe(() => {\n      loadingEl.style.display = 'flex';\n    });\n    ready$.subscribe(() => {\n      loadingEl.style.display = 'none';\n    });\n  }\n\n  const fadeIn$ = after$.pipe(\n    switchMap((context) => {\n      const p = animateFadeIn(context).toPromise();\n      context.transitionUntil(p);\n      return p;\n    }),\n    share(),\n  );\n\n  const flip$ = setupFLIP(start$, ready$, merge(fadeIn$, error$), {\n    animationMain,\n    settings: settings,\n  }).pipe(share());\n\n  start$\n    .pipe(\n      switchMap((context) => {\n        const promise = zip(timer(duration), fadeOut$, flip$).toPromise();\n        context.transitionUntil(promise);\n        return promise;\n      }),\n    )\n    .subscribe();\n\n  // FIXME: Keeping permanent subscription? turn into hot observable?\n  fadeOut$.subscribe();\n  flip$.subscribe();\n\n  const sidebarBg = document.querySelector('.sidebar-bg');\n  if (sidebarBg) {\n    const crossFader = new CrossFader(CROSS_FADE_DURATION);\n    after$\n      .pipe(\n        switchMap(({ document }) =>\n          zip(crossFader.fetchImage(document), fadeIn$).pipe(\n            map(([x]) => x),\n            takeUntil(start$),\n          ),\n        ),\n        startWith([sidebarBg]),\n        pairwise(),\n        mergeMap(([prev, curr]) => crossFader.fade(prev, curr)),\n      )\n      .subscribe();\n  }\n\n  error$\n    .pipe(\n      switchMap(({ url }) => {\n        if (loadingEl) loadingEl.style.display = 'none';\n\n        const main = document.getElementById('_main');\n        if (main) main.style.pointerEvents = '';\n        empty.call(animationMain?.querySelector('.page'));\n        empty.call(main);\n\n        setupErrorPage(main, url);\n\n        return animate(main, FADE_IN, { ...settings, fill: 'forwards' });\n      }),\n    )\n    .subscribe();\n\n  import(/* webpackMode: \"eager\" */ '@hydecorp/push-state');\n\n  window._pushState = pushStateEl;\n})();\n"],"names":["EMPTY","of","catchError","finalize","map","switchMap","animate","fetchRx","RE_CSS_URL","calcHash","doc","_pageStyle$innerText","sidebar","getElementById","sidebarBg","querySelector","pageStyle","innerText","trim","classList","style","backgroundImage","join","isExternal","_ref","protocol","host","location","arguments","length","undefined","window","objectURLs","WeakMap","CrossFader","constructor","fadeDuration","document","prevHash","themeColorEl","fetchImage2","newDocument","_newDocument$querySel","_newDocument$querySel2","result","exec","url","URL","origin","href","_objectSpread","method","headers","Accept","mode","pipe","r","blob","createObjectURL","fetchImage","hash","objectURL","_newDocument$querySel3","div","createElement","concat","set","updateStyle","_newDocument$getEleme","setAttribute","_newDocument$head$que","themeColor","head","content","setTimeout","_pageStyle$parentNode","newPageStyle","parentNode","replaceChild","e","process","env","DEBUG","console","error","fade","_ref2","_ref3","_prevDiv$parentNode","prevDiv","insertBefore","nextElementSibling","opacity","duration","easing","_prevDiv$parentNode2","has","revokeObjectURL","get","removeChild","merge","filter","setupFLIPTitle","FLIP_TYPES","setupFLIP","start$","ready$","fadeIn$","options","other$","flipType","includes","Observable","zip","tap","empty","TITLE_SELECTOR","animationMain","settings","flip$","anchor","title","add","textContent","transformOrigin","page","call","appendChild","position","first","getBoundingClientRect","last","firstFontSize","parseInt","getComputedStyle","fontSize","lastFontSize","invertX","left","invertY","top","invertScale","transform","complete","_ref4","_ref5","replaceEls","main","_ref6","x","subscribe","fromEvent","timer","exhaustMap","mapTo","mergeMap","pairwise","share","startWith","takeUntil","importTemplate","webComponentsReady","_asyncToGenerator","Promise","all","Element","prototype","NAVBAR_SEL","CROSS_FADE_DURATION","FADE_OUT","FADE_IN","setupAnimationMain","pushStateEl","_pushStateEl$parentNo","previousElementSibling","setupLoading","navbarEl","lastElementChild","setupErrorPage","pathname","getFlipType","el","_el$getAttribute","contains","getAttribute","Number","animateFadeOut","fill","animateFadeIn","drawerEl","loadingEl","fromEventX","eventName","mapFn","detail","_","Object","assign","after$","progress$","error$","fadeOut$","context","pointerEvents","_noDrawer","_drawerEl$parentNode","remove","display","p","toPromise","transitionUntil","promise","crossFader","_ref7","_ref8","_ref9","prev","curr","_ref10","_pushState"],"sourceRoot":""}