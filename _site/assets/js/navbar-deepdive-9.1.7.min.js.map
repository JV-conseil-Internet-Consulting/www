{"version":3,"file":"navbar-deepdive-9.1.7.min.js","mappings":"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","sources":["webpack://deepdive/./_js/src/navbar.js","webpack://deepdive/../../../../src/internal/operators/merge.ts","webpack://deepdive/../../../../src/internal/operators/mergeWith.ts","webpack://deepdive/../../../../src/internal/util/argsOrArgArray.ts"],"sourcesContent":["// Copyright (c) 2023 JV conseil <https://www.jv-conseil.net/>\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport { fromEvent, timer, merge } from 'rxjs';\nimport {\n  map,\n  filter,\n  pairwise,\n  mergeWith,\n  mapTo,\n  tap,\n  switchMap,\n  startWith,\n  share,\n  debounceTime,\n} from 'rxjs/operators';\n\nimport { hasCSSOM, getScrollTop, stylesheetReady, filterWhen } from './common';\n\n(async () => {\n  await stylesheetReady;\n\n  const navbarEl = document.getElementById('_navbar');\n  if (!navbarEl) return;\n\n  // FIXME: update when size changes\n  const height = navbarEl.clientHeight;\n\n  let offset = 0;\n\n  const tv = hasCSSOM ? new CSSTransformValue([new CSSTranslate(CSS.px(0), CSS.px(0))]) : null;\n\n  const checkNavbarInactive = () => !document.activeElement?.classList.contains('nav-btn');\n\n  const hashchange$ = fromEvent(window, 'hashchange').pipe(\n    map((e) => new URL(e.newURL).hash),\n    filter((hash) => hash !== '' && hash !== '#_search-input'),\n    share(),\n  );\n\n  // To disable the navbar while the \"scroll into view\" animation is active.\n  // Wait for 50ms after scrolling has stopped before unlocking the navbar.\n  const notScrollIntoView$ = hashchange$.pipe(\n    switchMap(() => fromEvent(document, 'scroll').pipe(debounceTime(50), mapTo(true), startWith(false))),\n    startWith(true),\n  );\n\n  // Certain events should make the navbar \"jump\" to a new position.\n  const jump$ = merge(\n    // Focusing any navbar element should show the navbar to enable keyboard-only interaction.\n    fromEvent(navbarEl, 'focus', { capture: true }).pipe(mapTo(2 * height)),\n    // Scrolling to a certain headline should hide the navbar to prevent hiding it.\n    hashchange$.pipe(mapTo(-2 * height)),\n  );\n\n  fromEvent(document, 'scroll', { passive: true })\n    .pipe(\n      filterWhen(notScrollIntoView$),\n      map(getScrollTop),\n      filter((x) => x >= 0),\n      pairwise(),\n      map(([prev, curr]) => prev - curr),\n      filter(checkNavbarInactive),\n      mergeWith(jump$),\n      tap((x) => {\n        offset += x;\n        offset = Math.max(-height, Math.min(0, offset));\n        if (hasCSSOM) {\n          tv[0].y.value = offset;\n          navbarEl.attributeStyleMap.set('transform', tv);\n        } else {\n          navbarEl.style.transform = `translateY(${offset}px)`;\n        }\n      }),\n    )\n    .subscribe();\n})();\n"],"names":["fromEvent","timer","merge","map","filter","pairwise","mergeWith","mapTo","tap","switchMap","startWith","share","debounceTime","hasCSSOM","getScrollTop","stylesheetReady","filterWhen","_asyncToGenerator","navbarEl","document","getElementById","height","clientHeight","offset","tv","CSSTransformValue","CSSTranslate","CSS","px","checkNavbarInactive","_document$activeEleme","activeElement","classList","contains","hashchange$","window","pipe","e","URL","newURL","hash","notScrollIntoView$","jump$","capture","passive","x","_ref2","prev","curr","Math","max","min","y","value","attributeStyleMap","set","style","transform","concat","subscribe","operate","argsOrArgArray","mergeAll","popNumber","popScheduler","from","args","_i","arguments","length","scheduler","concurrent","Infinity","source","subscriber","__spreadArray","__read","otherSources","apply","isArray","Array"],"sourceRoot":""}