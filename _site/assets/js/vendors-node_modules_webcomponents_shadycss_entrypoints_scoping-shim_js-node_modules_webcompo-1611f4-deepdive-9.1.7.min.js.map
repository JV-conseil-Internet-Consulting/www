{"version":3,"file":"vendors-node_modules_webcomponents_shadycss_entrypoints_scoping-shim_js-node_modules_webcompo-1611f4-deepdive-9.1.7.min.js","mappings":"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","sources":["webpack://deepdive/./node_modules/@webcomponents/shadycss/entrypoints/scoping-shim.js","webpack://deepdive/./node_modules/@webcomponents/shadycss/src/apply-shim-utils.js","webpack://deepdive/./node_modules/@webcomponents/shadycss/src/common-regex.js","webpack://deepdive/./node_modules/@webcomponents/shadycss/src/common-utils.js","webpack://deepdive/./node_modules/@webcomponents/shadycss/src/css-parse.js","webpack://deepdive/./node_modules/@webcomponents/shadycss/src/custom-style-interface.js","webpack://deepdive/./node_modules/@webcomponents/shadycss/src/document-wait.js","webpack://deepdive/./node_modules/@webcomponents/shadycss/src/document-watcher.js","webpack://deepdive/./node_modules/@webcomponents/shadycss/src/scoping-shim.js","webpack://deepdive/./node_modules/@webcomponents/shadycss/src/style-cache.js","webpack://deepdive/./node_modules/@webcomponents/shadycss/src/style-info.js","webpack://deepdive/./node_modules/@webcomponents/shadycss/src/style-placeholder.js","webpack://deepdive/./node_modules/@webcomponents/shadycss/src/style-properties.js","webpack://deepdive/./node_modules/@webcomponents/shadycss/src/style-settings.js","webpack://deepdive/./node_modules/@webcomponents/shadycss/src/style-transformer.js","webpack://deepdive/./node_modules/@webcomponents/shadycss/src/style-util.js","webpack://deepdive/./node_modules/@webcomponents/shadycss/src/template-map.js","webpack://deepdive/./node_modules/@webcomponents/shadycss/src/unscoped-style-handler.js","webpack://deepdive/src/shady-data.js","webpack://deepdive/ [synthetic:es6/util/arrayiterator] ","webpack://deepdive/ [synthetic:es6/util/makeiterator] ","webpack://deepdive/ [synthetic:es6/util/arrayfromiterable] ","webpack://deepdive/ [synthetic:es6/util/arrayfromiterator] ","webpack://deepdive/ [synthetic:util/global] ","webpack://deepdive/src/utils.js","webpack://deepdive/src/patch-native.js","webpack://deepdive/src/flush.js","webpack://deepdive/src/observe-changes.js","webpack://deepdive/src/innerHTML.js","webpack://deepdive/src/patch-instances.js","webpack://deepdive/src/patch-events.js","webpack://deepdive/src/array-splice.js","webpack://deepdive/src/patches/EventTarget.js","webpack://deepdive/src/style-scoping.js","webpack://deepdive/src/patches/Node.js","webpack://deepdive/src/attach-shadow.js","webpack://deepdive/src/patches/Slotable.js","webpack://deepdive/src/selector-parser.js","webpack://deepdive/src/patches/ParentNode.js","webpack://deepdive/src/patches/ChildNode.js","webpack://deepdive/src/patches/Element.js","webpack://deepdive/src/patches/ElementOrShadowRoot.js","webpack://deepdive/src/patches/HTMLElement.js","webpack://deepdive/src/patches/Slot.js","webpack://deepdive/src/patches/DocumentOrFragment.js","webpack://deepdive/src/patches/DocumentOrShadowRoot.js","webpack://deepdive/src/patches/Document.js","webpack://deepdive/src/patches/Window.js","webpack://deepdive/src/patch-prototypes.js","webpack://deepdive/src/link-nodes.js","webpack://deepdive/src/patches/ShadowRoot.js","webpack://deepdive/src/patch-shadyRoot.js","webpack://deepdive/src/wrapper.js","webpack://deepdive/src/shadydom.js"],"sourcesContent":["/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport ScopingShim from '../src/scoping-shim.js';\n// prettier-ignore\nimport {nativeCssVariables, nativeShadow, cssBuild, disableRuntime} from '../src/style-settings.js';\n\n/** @const {ScopingShim} */\nconst scopingShim = new ScopingShim();\n\nlet ApplyShim, CustomStyleInterface;\n\nif (window['ShadyCSS']) {\n  ApplyShim = window['ShadyCSS']['ApplyShim'];\n  CustomStyleInterface = window['ShadyCSS']['CustomStyleInterface'];\n}\n\nwindow.ShadyCSS = {\n  ScopingShim: scopingShim,\n  /**\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   * @param {string=} elementExtends\n   */\n  prepareTemplate(template, elementName, elementExtends) {\n    scopingShim.flushCustomStyles();\n    scopingShim.prepareTemplate(template, elementName, elementExtends);\n  },\n\n  /**\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   */\n  prepareTemplateDom(template, elementName) {\n    scopingShim.prepareTemplateDom(template, elementName);\n  },\n\n  /**\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   * @param {string=} elementExtends\n   */\n  prepareTemplateStyles(template, elementName, elementExtends) {\n    scopingShim.flushCustomStyles();\n    scopingShim.prepareTemplateStyles(template, elementName, elementExtends);\n  },\n  /**\n   * @param {!HTMLElement} element\n   * @param {Object=} properties\n   */\n  styleSubtree(element, properties) {\n    scopingShim.flushCustomStyles();\n    scopingShim.styleSubtree(element, properties);\n  },\n\n  /**\n   * @param {!HTMLElement} element\n   */\n  styleElement(element) {\n    scopingShim.flushCustomStyles();\n    scopingShim.styleElement(element);\n  },\n\n  /**\n   * @param {Object=} properties\n   */\n  styleDocument(properties) {\n    scopingShim.flushCustomStyles();\n    scopingShim.styleDocument(properties);\n  },\n\n  flushCustomStyles() {\n    scopingShim.flushCustomStyles();\n  },\n\n  /**\n   * @param {Element} element\n   * @param {string} property\n   * @return {string}\n   */\n  getComputedStyleValue(element, property) {\n    return scopingShim.getComputedStyleValue(element, property);\n  },\n\n  nativeCss: nativeCssVariables,\n\n  nativeShadow: nativeShadow,\n\n  cssBuild: cssBuild,\n\n  disableRuntime: disableRuntime,\n};\n\nif (ApplyShim) {\n  window.ShadyCSS.ApplyShim = ApplyShim;\n}\n\nif (CustomStyleInterface) {\n  window.ShadyCSS.CustomStyleInterface = CustomStyleInterface;\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\nimport templateMap from './template-map.js';\nimport {StyleNode} from './css-parse.js'; // eslint-disable-line @typescript-eslint/no-unused-vars\n\n/*\n * Utilities for handling invalidating apply-shim mixins for a given template.\n *\n * The invalidation strategy involves keeping track of the \"current\" version of a template's mixins, and updating that count when a mixin is invalidated.\n * The template\n */\n\n/** @const {string} */\nconst CURRENT_VERSION = '_applyShimCurrentVersion';\n\n/** @const {string} */\nconst NEXT_VERSION = '_applyShimNextVersion';\n\n/** @const {string} */\nconst VALIDATING_VERSION = '_applyShimValidatingVersion';\n\n/**\n * @const {Promise<void>}\n */\nconst promise = Promise.resolve();\n\n/**\n * @param {string} elementName\n */\nexport function invalidate(elementName) {\n  let template = templateMap[elementName];\n  if (template) {\n    invalidateTemplate(template);\n  }\n}\n\n/**\n * This function can be called multiple times to mark a template invalid\n * and signal that the style inside must be regenerated.\n *\n * Use `startValidatingTemplate` to begin an asynchronous validation cycle.\n * During that cycle, call `templateIsValidating` to see if the template must\n * be revalidated\n * @param {HTMLTemplateElement} template\n */\nexport function invalidateTemplate(template) {\n  // default the current version to 0\n  template[CURRENT_VERSION] = template[CURRENT_VERSION] || 0;\n  // ensure the \"validating for\" flag exists\n  template[VALIDATING_VERSION] = template[VALIDATING_VERSION] || 0;\n  // increment the next version\n  template[NEXT_VERSION] = (template[NEXT_VERSION] || 0) + 1;\n}\n\n/**\n * @param {string} elementName\n * @return {boolean}\n */\nexport function isValid(elementName) {\n  let template = templateMap[elementName];\n  if (template) {\n    return templateIsValid(template);\n  }\n  return true;\n}\n\n/**\n * @param {HTMLTemplateElement} template\n * @return {boolean}\n */\nexport function templateIsValid(template) {\n  return template[CURRENT_VERSION] === template[NEXT_VERSION];\n}\n\n/**\n * @param {string} elementName\n * @return {boolean}\n */\nexport function isValidating(elementName) {\n  let template = templateMap[elementName];\n  if (template) {\n    return templateIsValidating(template);\n  }\n  return false;\n}\n\n/**\n * Returns true if the template is currently invalid and `startValidating` has been called since the last invalidation.\n * If false, the template must be validated.\n * @param {HTMLTemplateElement} template\n * @return {boolean}\n */\nexport function templateIsValidating(template) {\n  return (\n    !templateIsValid(template) &&\n    template[VALIDATING_VERSION] === template[NEXT_VERSION]\n  );\n}\n\n/**\n * the template is marked as `validating` for one microtask so that all instances\n * found in the tree crawl of `applyStyle` will update themselves,\n * but the template will only be updated once.\n * @param {string} elementName\n */\nexport function startValidating(elementName) {\n  let template = templateMap[elementName];\n  startValidatingTemplate(template);\n}\n\n/**\n * Begin an asynchronous invalidation cycle.\n * This should be called after every validation of a template\n *\n * After one microtask, the template will be marked as valid until the next call to `invalidateTemplate`\n * @param {HTMLTemplateElement} template\n */\nexport function startValidatingTemplate(template) {\n  // remember that the current \"next version\" is the reason for this validation cycle\n  template[VALIDATING_VERSION] = template[NEXT_VERSION];\n  // however, there only needs to be one async task to clear the counters\n  if (!template._validating) {\n    template._validating = true;\n    promise.then(function () {\n      // sync the current version to let future invalidations cause a refresh cycle\n      template[CURRENT_VERSION] = template[NEXT_VERSION];\n      template._validating = false;\n    });\n  }\n}\n\n/**\n * @return {boolean}\n */\nexport function elementsAreInvalid() {\n  for (let elementName in templateMap) {\n    let template = templateMap[elementName];\n    if (!templateIsValid(template)) {\n      return true;\n    }\n  }\n  return false;\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nexport const VAR_ASSIGN = /(?:^|[;\\s{]\\s*)(--[\\w-]*?)\\s*:\\s*(?:((?:'(?:\\\\'|.)*?'|\"(?:\\\\\"|.)*?\"|\\([^)]*?\\)|[^};{])+)|\\{([^}]*)\\}(?:(?=[;\\s}])|$))/gi;\nexport const MIXIN_MATCH = /(?:^|\\W+)@apply\\s*\\(?([^);\\n]*)\\)?/gi;\nexport const VAR_CONSUMED = /(--[\\w-]+)\\s*([:,;)]|$)/gi;\nexport const ANIMATION_MATCH = /(animation\\s*:)|(animation-name\\s*:)/;\nexport const MEDIA_MATCH = /@media\\s(.*)/;\nexport const IS_VAR = /^--/;\nexport const BRACKETED = /\\{[^}]*\\}/g;\nexport const HOST_PREFIX = '(?:^|[^.#[:])';\nexport const HOST_SUFFIX = '($|[.:[\\\\s>+~])';\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {MIXIN_MATCH, VAR_ASSIGN} from './common-regex.js';\n\n/**\n * @param {Element} element\n * @param {Object=} properties\n */\nexport function updateNativeProperties(element, properties) {\n  // remove previous properties\n  for (let p in properties) {\n    // NOTE: for bc with shim, don't apply null values.\n    if (p === null) {\n      element.style.removeProperty(p);\n    } else {\n      element.style.setProperty(p, properties[p]);\n    }\n  }\n}\n\n/**\n * @param {Element} element\n * @param {string} property\n * @return {string}\n */\nexport function getComputedStyleValue(element, property) {\n  /**\n   * @const {string}\n   */\n  const value = window.getComputedStyle(element).getPropertyValue(property);\n  if (!value) {\n    return '';\n  } else {\n    return value.trim();\n  }\n}\n\n/**\n * return true if `cssText` contains a mixin definition or consumption\n * @param {string} cssText\n * @return {boolean}\n */\nexport function detectMixin(cssText) {\n  const has = MIXIN_MATCH.test(cssText) || VAR_ASSIGN.test(cssText);\n  // reset state of the regexes\n  MIXIN_MATCH.lastIndex = 0;\n  VAR_ASSIGN.lastIndex = 0;\n  return has;\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n/*\nExtremely simple css parser. Intended to be not more than what we need\nand definitely not necessarily correct =).\n*/\n\n'use strict';\n\n/** @unrestricted */\nclass StyleNode {\n  constructor() {\n    /** @type {number} */\n    this['start'] = 0;\n    /** @type {number} */\n    this['end'] = 0;\n    /** @type {StyleNode} */\n    this['previous'] = null;\n    /** @type {StyleNode} */\n    this['parent'] = null;\n    /** @type {Array<StyleNode>} */\n    this['rules'] = null;\n    /** @type {string} */\n    this['parsedCssText'] = '';\n    /** @type {string} */\n    this['cssText'] = '';\n    /** @type {boolean} */\n    this['atRule'] = false;\n    /** @type {number} */\n    this['type'] = 0;\n    /** @type {string} */\n    this['keyframesName'] = '';\n    /** @type {string} */\n    this['selector'] = '';\n    /** @type {string} */\n    this['parsedSelector'] = '';\n  }\n}\n\nexport {StyleNode};\n\n// given a string of css, return a simple rule tree\n/**\n * @param {string} text\n * @return {StyleNode}\n */\nexport function parse(text) {\n  text = clean(text);\n  return parseCss(lex(text), text);\n}\n\n// remove stuff we don't care about that may hinder parsing\n/**\n * @param {string} cssText\n * @return {string}\n */\nfunction clean(cssText) {\n  return cssText.replace(RX.comments, '').replace(RX.port, '');\n}\n\n// super simple {...} lexer that returns a node tree\n/**\n * @param {string} text\n * @return {!StyleNode}\n */\nfunction lex(text) {\n  let root = new StyleNode();\n  root['start'] = 0;\n  root['end'] = text.length;\n  let n = root;\n  for (let i = 0, l = text.length; i < l; i++) {\n    if (text[i] === OPEN_BRACE) {\n      if (!n['rules']) {\n        n['rules'] = [];\n      }\n      let p = n;\n      let previous = p['rules'][p['rules'].length - 1] || null;\n      n = new StyleNode();\n      n['start'] = i + 1;\n      n['parent'] = p;\n      n['previous'] = previous;\n      p['rules'].push(n);\n    } else if (text[i] === CLOSE_BRACE) {\n      n['end'] = i + 1;\n      n = n['parent'] || root;\n    }\n  }\n  return root;\n}\n\n// add selectors/cssText to node tree\n/**\n * @param {StyleNode} node\n * @param {string} text\n * @return {!StyleNode}\n */\nfunction parseCss(node, text) {\n  let t = text.substring(node['start'], node['end'] - 1);\n  node['parsedCssText'] = node['cssText'] = t.trim();\n  if (node['parent']) {\n    let ss = node['previous']\n      ? node['previous']['end']\n      : node['parent']['start'];\n    t = text.substring(ss, node['start'] - 1);\n    t = _expandUnicodeEscapes(t);\n    t = t.replace(RX.multipleSpaces, ' ');\n    // TODO(sorvell): ad hoc; make selector include only after last ;\n    // helps with mixin syntax\n    t = t.substring(t.lastIndexOf(';') + 1);\n    let s = (node['parsedSelector'] = node['selector'] = t.trim());\n    node['atRule'] = s.indexOf(AT_START) === 0;\n    // note, support a subset of rule types...\n    if (node['atRule']) {\n      if (s.indexOf(MEDIA_START) === 0) {\n        node['type'] = types.MEDIA_RULE;\n      } else if (s.match(RX.keyframesRule)) {\n        node['type'] = types.KEYFRAMES_RULE;\n        node['keyframesName'] = node['selector'].split(RX.multipleSpaces).pop();\n      }\n    } else {\n      if (s.indexOf(VAR_START) === 0) {\n        node['type'] = types.MIXIN_RULE;\n      } else {\n        node['type'] = types.STYLE_RULE;\n      }\n    }\n  }\n  let r$ = node['rules'];\n  if (r$) {\n    for (let i = 0, l = r$.length, r; i < l && (r = r$[i]); i++) {\n      parseCss(r, text);\n    }\n  }\n  return node;\n}\n\n/**\n * conversion of sort unicode escapes with spaces like `\\33 ` (and longer) into\n * expanded form that doesn't require trailing space `\\000033`\n * @param {string} s\n * @return {string}\n */\nfunction _expandUnicodeEscapes(s) {\n  return s.replace(/\\\\([0-9a-f]{1,6})\\s/gi, function () {\n    let code = arguments[1],\n      repeat = 6 - code.length;\n    while (repeat--) {\n      code = '0' + code;\n    }\n    return '\\\\' + code;\n  });\n}\n\n/**\n * stringify parsed css.\n * @param {StyleNode} node\n * @param {boolean=} preserveProperties\n * @param {string=} text\n * @return {string}\n */\nexport function stringify(node, preserveProperties, text = '') {\n  // calc rule cssText\n  let cssText = '';\n  if (node['cssText'] || node['rules']) {\n    let r$ = node['rules'];\n    if (r$ && !_hasMixinRules(r$)) {\n      for (let i = 0, l = r$.length, r; i < l && (r = r$[i]); i++) {\n        cssText = stringify(r, preserveProperties, cssText);\n      }\n    } else {\n      cssText = preserveProperties\n        ? node['cssText']\n        : removeCustomProps(node['cssText']);\n      cssText = cssText.trim();\n      if (cssText) {\n        cssText = '  ' + cssText + '\\n';\n      }\n    }\n  }\n  // emit rule if there is cssText\n  if (cssText) {\n    if (node['selector']) {\n      text += node['selector'] + ' ' + OPEN_BRACE + '\\n';\n    }\n    text += cssText;\n    if (node['selector']) {\n      text += CLOSE_BRACE + '\\n\\n';\n    }\n  }\n  return text;\n}\n\n/**\n * @param {Array<StyleNode>} rules\n * @return {boolean}\n */\nfunction _hasMixinRules(rules) {\n  let r = rules[0];\n  return (\n    Boolean(r) &&\n    Boolean(r['selector']) &&\n    r['selector'].indexOf(VAR_START) === 0\n  );\n}\n\n/**\n * @param {string} cssText\n * @return {string}\n */\nfunction removeCustomProps(cssText) {\n  cssText = removeCustomPropAssignment(cssText);\n  return removeCustomPropApply(cssText);\n}\n\n/**\n * @param {string} cssText\n * @return {string}\n */\nexport function removeCustomPropAssignment(cssText) {\n  return cssText.replace(RX.customProp, '').replace(RX.mixinProp, '');\n}\n\n/**\n * @param {string} cssText\n * @return {string}\n */\nfunction removeCustomPropApply(cssText) {\n  return cssText.replace(RX.mixinApply, '').replace(RX.varApply, '');\n}\n\n/** @enum {number} */\nexport const types = {\n  STYLE_RULE: 1,\n  KEYFRAMES_RULE: 7,\n  MEDIA_RULE: 4,\n  MIXIN_RULE: 1000,\n};\n\nconst OPEN_BRACE = '{';\nconst CLOSE_BRACE = '}';\n\n// helper regexp's\nconst RX = {\n  comments: /\\/\\*[^*]*\\*+([^/*][^*]*\\*+)*\\//gim,\n  port: /@import[^;]*;/gim,\n  customProp: /(?:^[^;\\-\\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\\n]|$)/gim,\n  mixinProp: /(?:^[^;\\-\\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\\n]|$)?/gim,\n  mixinApply: /@apply\\s*\\(?[^);]*\\)?\\s*(?:[;\\n]|$)?/gim,\n  varApply: /[^;:]*?:[^;]*?var\\([^;]*\\)(?:[;\\n]|$)?/gim,\n  keyframesRule: /^@[^\\s]*keyframes/,\n  multipleSpaces: /\\s+/g,\n};\n\nconst VAR_START = '--';\nconst MEDIA_START = '@media';\nconst AT_START = '@';\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport documentWait from './document-wait.js';\n\n/**\n * @typedef {HTMLStyleElement | {getStyle: function():HTMLStyleElement}}\n */\nexport let CustomStyleProvider;\n\nconst SEEN_MARKER = '__seenByShadyCSS';\nconst CACHED_STYLE = '__shadyCSSCachedStyle';\n\n/** @type {?function(!HTMLStyleElement)} */\nlet transformFn = null;\n\n/** @type {?function()} */\nlet validateFn = null;\n\n/**\nThis interface is provided to add document-level <style> elements to ShadyCSS for processing.\nThese styles must be processed by ShadyCSS to simulate ShadowRoot upper-bound encapsulation from outside styles\nIn addition, these styles may also need to be processed for @apply rules and CSS Custom Properties\n\nTo add document-level styles to ShadyCSS, one can call `ShadyCSS.addDocumentStyle(styleElement)` or `ShadyCSS.addDocumentStyle({getStyle: () => styleElement})`\n\nIn addition, if the process used to discover document-level styles can be synchronously flushed, one should set `ShadyCSS.documentStyleFlush`.\nThis function will be called when calculating styles.\n\nAn example usage of the document-level styling api can be found in `examples/document-style-lib.js`\n\n@unrestricted\n*/\nexport default class CustomStyleInterface {\n  constructor() {\n    /** @type {!Array<!CustomStyleProvider>} */\n    this['customStyles'] = [];\n    this['enqueued'] = false;\n    // NOTE(dfreedm): use quotes here to prevent closure inlining to `function(){}`;\n    documentWait(() => {\n      if (window['ShadyCSS']['flushCustomStyles']) {\n        window['ShadyCSS']['flushCustomStyles']();\n      }\n    });\n  }\n  /**\n   * Queue a validation for new custom styles to batch style recalculations\n   */\n  enqueueDocumentValidation() {\n    if (this['enqueued'] || !validateFn) {\n      return;\n    }\n    this['enqueued'] = true;\n    documentWait(validateFn);\n  }\n  /**\n   * @param {!HTMLStyleElement} style\n   */\n  addCustomStyle(style) {\n    if (!style[SEEN_MARKER]) {\n      style[SEEN_MARKER] = true;\n      this['customStyles'].push(style);\n      this.enqueueDocumentValidation();\n    }\n  }\n  /**\n   * @param {!CustomStyleProvider} customStyle\n   * @return {HTMLStyleElement}\n   */\n  getStyleForCustomStyle(customStyle) {\n    if (customStyle[CACHED_STYLE]) {\n      return customStyle[CACHED_STYLE];\n    }\n    let style;\n    if (customStyle['getStyle']) {\n      style = customStyle['getStyle']();\n    } else {\n      style = customStyle;\n    }\n    return style;\n  }\n  /**\n   * @return {!Array<!CustomStyleProvider>}\n   */\n  processStyles() {\n    const cs = this['customStyles'];\n    for (let i = 0; i < cs.length; i++) {\n      const customStyle = cs[i];\n      if (customStyle[CACHED_STYLE]) {\n        continue;\n      }\n      const style = this.getStyleForCustomStyle(customStyle);\n      if (style) {\n        // HTMLImports polyfill may have cloned the style into the main document,\n        // which is referenced with __appliedElement.\n        const styleToTransform = /** @type {!HTMLStyleElement} */ (style[\n          '__appliedElement'\n        ] || style);\n        if (transformFn) {\n          transformFn(styleToTransform);\n        }\n        customStyle[CACHED_STYLE] = styleToTransform;\n      }\n    }\n    return cs;\n  }\n}\n\n/* eslint-disable no-self-assign */\nCustomStyleInterface.prototype['addCustomStyle'] =\n  CustomStyleInterface.prototype.addCustomStyle;\nCustomStyleInterface.prototype['getStyleForCustomStyle'] =\n  CustomStyleInterface.prototype.getStyleForCustomStyle;\nCustomStyleInterface.prototype['processStyles'] =\n  CustomStyleInterface.prototype.processStyles;\n/* eslint-enable no-self-assign */\n\nObject.defineProperties(CustomStyleInterface.prototype, {\n  'transformCallback': {\n    /** @return {?function(!HTMLStyleElement)} */\n    get() {\n      return transformFn;\n    },\n    /** @param {?function(!HTMLStyleElement)} fn */\n    set(fn) {\n      transformFn = fn;\n    },\n  },\n  'validateCallback': {\n    /** @return {?function()} */\n    get() {\n      return validateFn;\n    },\n    /**\n     * @param {?function()} fn\n     * @this {CustomStyleInterface}\n     */\n    set(fn) {\n      let needsEnqueue = false;\n      if (!validateFn) {\n        needsEnqueue = true;\n      }\n      validateFn = fn;\n      if (needsEnqueue) {\n        this.enqueueDocumentValidation();\n      }\n    },\n  },\n});\n\n/** @typedef {{\n * customStyles: !Array<!CustomStyleProvider>,\n * addCustomStyle: function(!CustomStyleProvider),\n * getStyleForCustomStyle: function(!CustomStyleProvider): HTMLStyleElement,\n * findStyles: function(),\n * transformCallback: ?function(!HTMLStyleElement),\n * validateCallback: ?function()\n * }}\n */\nexport const CustomStyleInterfaceInterface = {};\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\n/** @type {Promise<void>} */\nlet readyPromise = null;\n\n/** @type {?function(?function())} */\nlet whenReady =\n  (window['HTMLImports'] && window['HTMLImports']['whenReady']) || null;\n\n/** @type {function()} */\nlet resolveFn;\n\n/**\n * @param {?function()} callback\n */\nexport default function documentWait(callback) {\n  requestAnimationFrame(function () {\n    if (whenReady) {\n      whenReady(callback);\n    } else {\n      if (!readyPromise) {\n        readyPromise = new Promise((resolve) => {\n          resolveFn = resolve;\n        });\n        if (document.readyState === 'complete') {\n          resolveFn();\n        } else {\n          document.addEventListener('readystatechange', () => {\n            if (document.readyState === 'complete') {\n              resolveFn();\n            }\n          });\n        }\n      }\n      readyPromise.then(function () {\n        callback && callback();\n      });\n    }\n  });\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {nativeShadow} from './style-settings.js';\nimport StyleTransformer from './style-transformer.js';\nimport {getIsExtends, elementHasBuiltCss, wrap} from './style-util.js';\n\nexport let flush = function () {};\n\n/**\n * @param {!Element} element\n * @return {string}\n */\nfunction getClasses(element) {\n  if (element.classList && element.classList.value) {\n    return element.classList.value;\n  } else {\n    // NOTE: className is patched to remove scoping classes in ShadyDOM\n    // use getAttribute('class') instead, which is unpatched\n    return element.getAttribute('class') || '';\n  }\n}\n\nconst scopeRegExp = new RegExp(`${StyleTransformer.SCOPE_NAME}\\\\s*([^\\\\s]*)`);\n\n/**\n * @param {!Element} element\n * @return {string}\n */\nexport function getCurrentScope(element) {\n  const match = getClasses(element).match(scopeRegExp);\n  if (match) {\n    return match[1];\n  } else {\n    return '';\n  }\n}\n\n/**\n * @param {!Node} node\n */\nexport function getOwnerScope(node) {\n  const ownerRoot = wrap(node).getRootNode();\n  if (ownerRoot === node || ownerRoot === node.ownerDocument) {\n    return '';\n  }\n  const host = /** @type {!ShadowRoot} */ (ownerRoot).host;\n  if (!host) {\n    // this may actually be a document fragment\n    return '';\n  }\n  return getIsExtends(host).is;\n}\n\n/**\n * @param {!Element} element\n */\nexport function ensureCorrectScope(element) {\n  const currentScope = getCurrentScope(element);\n  const ownerRoot = wrap(element).getRootNode();\n  if (ownerRoot === element) {\n    return;\n  }\n  if (currentScope && ownerRoot === element.ownerDocument) {\n    // node was scoped, but now is in document\n    StyleTransformer.domRemoveScope(element, currentScope);\n  } else if (ownerRoot instanceof ShadowRoot) {\n    const ownerScope = getOwnerScope(element);\n    if (ownerScope !== currentScope) {\n      // node was scoped, but not by its current owner\n      StyleTransformer.domReplaceScope(element, currentScope, ownerScope);\n    }\n  }\n}\n\n/**\n * @param {!HTMLElement|!HTMLDocument} element\n */\nexport function ensureCorrectSubtreeScoping(element) {\n  // find unscoped subtree nodes\n  const unscopedNodes = window['ShadyDOM']['nativeMethods'][\n    'querySelectorAll'\n  ].call(element, `:not(.${StyleTransformer.SCOPE_NAME})`);\n\n  for (let j = 0; j < unscopedNodes.length; j++) {\n    // it's possible, during large batch inserts, that nodes that aren't\n    // scoped within the current scope were added.\n    // To make sure that any unscoped nodes that were inserted in the current batch are correctly styled,\n    // query all unscoped nodes and force their style-scope to be applied.\n    // This could happen if a sub-element appended an unscoped node in its shadowroot and this function\n    // runs on a parent element of the host of that unscoped node:\n    // parent-element -> element -> unscoped node\n    // Here unscoped node should have the style-scope element, not parent-element.\n    const unscopedNode = unscopedNodes[j];\n    const scopeForPreviouslyUnscopedNode = getOwnerScope(unscopedNode);\n    if (scopeForPreviouslyUnscopedNode) {\n      StyleTransformer.element(unscopedNode, scopeForPreviouslyUnscopedNode);\n    }\n  }\n}\n\n/**\n * @param {HTMLElement} el\n * @return {boolean}\n */\nfunction isElementWithBuiltCss(el) {\n  if (el.localName === 'style' || el.localName === 'template') {\n    return elementHasBuiltCss(el);\n  }\n  return false;\n}\n\n/**\n * @param {Array<MutationRecord|null>|null} mxns\n */\nfunction handler(mxns) {\n  for (let x = 0; x < mxns.length; x++) {\n    let mxn = mxns[x];\n    if (\n      mxn.target === document.documentElement ||\n      mxn.target === document.head\n    ) {\n      continue;\n    }\n    for (let i = 0; i < mxn.addedNodes.length; i++) {\n      let n = mxn.addedNodes[i];\n      if (n.nodeType !== Node.ELEMENT_NODE) {\n        continue;\n      }\n      n = /** @type {HTMLElement} */ (n); // eslint-disable-line no-self-assign\n      let root = n.getRootNode();\n      let currentScope = getCurrentScope(n);\n      // node was scoped, but now is in document\n      // If this element has built css, we must not remove scoping as this node\n      // will be used as a template or style without re - applying scoping as an optimization\n      if (\n        currentScope &&\n        root === n.ownerDocument &&\n        !isElementWithBuiltCss(n)\n      ) {\n        StyleTransformer.domRemoveScope(n, currentScope);\n      } else if (root instanceof ShadowRoot) {\n        const newScope = getOwnerScope(n);\n        // rescope current node and subtree if necessary\n        if (newScope !== currentScope) {\n          StyleTransformer.domReplaceScope(n, currentScope, newScope);\n        }\n        // make sure all the subtree elements are scoped correctly\n        ensureCorrectSubtreeScoping(n);\n      }\n    }\n  }\n}\n\n// if native Shadow DOM is being used, or ShadyDOM handles dynamic scoiping, do not activate the MutationObserver\nif (\n  !nativeShadow &&\n  !(window['ShadyDOM'] && window['ShadyDOM']['handlesDynamicScoping'])\n) {\n  let observer = new MutationObserver(handler);\n  let start = (node) => {\n    observer.observe(node, {childList: true, subtree: true});\n  };\n  let nativeCustomElements =\n    window['customElements'] &&\n    !window['customElements']['polyfillWrapFlushCallback'];\n  // need to start immediately with native custom elements\n  // TODO(dfreedm): with polyfilled HTMLImports and native custom elements\n  // excessive mutations may be observed; this can be optimized via cooperation\n  // with the HTMLImports polyfill.\n  if (nativeCustomElements) {\n    start(document);\n  } else {\n    let delayedStart = () => {\n      start(document.body);\n    };\n    // use polyfill timing if it's available\n    if (window['HTMLImports']) {\n      window['HTMLImports']['whenReady'](delayedStart);\n      // otherwise push beyond native imports being ready\n      // which requires RAF + readystate interactive.\n    } else {\n      requestAnimationFrame(function () {\n        if (document.readyState === 'loading') {\n          let listener = function () {\n            delayedStart();\n            document.removeEventListener('readystatechange', listener);\n          };\n          document.addEventListener('readystatechange', listener);\n        } else {\n          delayedStart();\n        }\n      });\n    }\n  }\n\n  flush = function () {\n    handler(observer.takeRecords());\n  };\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {parse, StyleNode} from './css-parse.js';\n// prettier-ignore\nimport {nativeShadow, nativeCssVariables, disableRuntime} from './style-settings.js';\nimport StyleTransformer from './style-transformer.js';\nimport * as StyleUtil from './style-util.js';\nimport StyleProperties from './style-properties.js';\n// prettier-ignore\nimport {ensureStylePlaceholder, getStylePlaceholder} from './style-placeholder.js';\nimport StyleInfo from './style-info.js';\nimport StyleCache from './style-cache.js';\n// prettier-ignore\nimport {flush as watcherFlush, getOwnerScope, getCurrentScope} from './document-watcher.js';\nimport templateMap from './template-map.js';\nimport * as ApplyShimUtils from './apply-shim-utils.js';\nimport {updateNativeProperties, detectMixin} from './common-utils.js';\n// prettier-ignore\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport {CustomStyleInterfaceInterface, CustomStyleProvider} from './custom-style-interface.js';\n\n/** @type {!Object<string, string>} */\nconst adoptedCssTextMap = {};\n\n/**\n * @const {StyleCache}\n */\nconst styleCache = new StyleCache();\n\nexport default class ScopingShim {\n  constructor() {\n    this._scopeCounter = {};\n    this._documentOwner = /** @type {!HTMLElement} */ (document.documentElement);\n    let ast = new StyleNode();\n    ast['rules'] = [];\n    this._documentOwnerStyleInfo = StyleInfo.set(\n      this._documentOwner,\n      new StyleInfo(ast)\n    );\n    this._elementsHaveApplied = false;\n    /** @type {?Object} */\n    this._applyShim = null;\n    /** @type {?CustomStyleInterfaceInterface} */\n    this._customStyleInterface = null;\n  }\n  flush() {\n    watcherFlush();\n  }\n  _generateScopeSelector(name) {\n    let id = (this._scopeCounter[name] = (this._scopeCounter[name] || 0) + 1);\n    return `${name}-${id}`;\n  }\n  getStyleAst(style) {\n    return StyleUtil.rulesForStyle(style);\n  }\n  styleAstToString(ast) {\n    return StyleUtil.toCssText(ast);\n  }\n  _gatherStyles(template) {\n    return StyleUtil.gatherStyleText(template.content);\n  }\n  /**\n   * Prepare the styling and template for the given element type\n   *\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   * @param {string=} typeExtension\n   */\n  prepareTemplate(template, elementName, typeExtension) {\n    this.prepareTemplateDom(template, elementName);\n    this.prepareTemplateStyles(template, elementName, typeExtension);\n  }\n  /**\n   * Prepare styling for the given element type\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   * @param {string=} typeExtension\n   */\n  prepareTemplateStyles(template, elementName, typeExtension) {\n    if (template._prepared || disableRuntime) {\n      return;\n    }\n    // style placeholders are only used when ShadyDOM is active\n    if (!nativeShadow) {\n      ensureStylePlaceholder(elementName);\n    }\n    template._prepared = true;\n    template.name = elementName;\n    template.extends = typeExtension;\n    templateMap[elementName] = template;\n    let cssBuild = StyleUtil.getCssBuild(template);\n    const optimalBuild = StyleUtil.isOptimalCssBuild(cssBuild);\n    let info = {\n      is: elementName,\n      extends: typeExtension,\n    };\n    let cssText =\n      this._gatherStyles(template) + (adoptedCssTextMap[elementName] || '');\n    // check if the styling has mixin definitions or uses\n    this._ensure();\n    if (!optimalBuild) {\n      let hasMixins = !cssBuild && detectMixin(cssText);\n      let ast = parse(cssText);\n      // only run the applyshim transforms if there is a mixin involved\n      if (hasMixins && nativeCssVariables && this._applyShim) {\n        this._applyShim['transformRules'](ast, elementName);\n      }\n      template['_styleAst'] = ast;\n    }\n    let ownPropertyNames = [];\n    if (!nativeCssVariables) {\n      ownPropertyNames = StyleProperties.decorateStyles(template['_styleAst']);\n    }\n    if (!ownPropertyNames.length || nativeCssVariables) {\n      let root = nativeShadow ? template.content : null;\n      let placeholder = getStylePlaceholder(elementName);\n      let style = this._generateStaticStyle(\n        info,\n        template['_styleAst'],\n        root,\n        placeholder,\n        cssBuild,\n        optimalBuild ? cssText : ''\n      );\n      template._style = style;\n    }\n    template._ownPropertyNames = ownPropertyNames;\n  }\n\n  /**\n   * @param {!Array<string>} cssTextArray\n   * @param {string} elementName\n   */\n  prepareAdoptedCssText(cssTextArray, elementName) {\n    adoptedCssTextMap[elementName] = cssTextArray.join(' ');\n  }\n  /**\n   * Prepare template for the given element type\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   */\n  prepareTemplateDom(template, elementName) {\n    if (disableRuntime) {\n      return;\n    }\n    const cssBuild = StyleUtil.getCssBuild(template);\n    if (!nativeShadow && cssBuild !== 'shady' && !template._domPrepared) {\n      template._domPrepared = true;\n      StyleTransformer.domAddScope(template.content, elementName);\n    }\n  }\n  /**\n   * @param {!{is: string, extends: (string|undefined)}} info\n   * @param {!StyleNode} rules\n   * @param {DocumentFragment} shadowroot\n   * @param {Node} placeholder\n   * @param {string} cssBuild\n   * @param {string=} cssText\n   * @return {?HTMLStyleElement}\n   */\n  _generateStaticStyle(\n    info,\n    rules,\n    shadowroot,\n    placeholder,\n    cssBuild,\n    cssText\n  ) {\n    cssText = StyleTransformer.elementStyles(\n      info,\n      rules,\n      null,\n      cssBuild,\n      cssText\n    );\n    if (cssText.length) {\n      return StyleUtil.applyCss(cssText, info.is, shadowroot, placeholder);\n    }\n    return null;\n  }\n  _prepareHost(host) {\n    const {is, typeExtension} = StyleUtil.getIsExtends(host);\n    const placeholder = getStylePlaceholder(is);\n    const template = templateMap[is];\n    if (!template) {\n      return;\n    }\n    const ast = template['_styleAst'];\n    const ownStylePropertyNames = template._ownPropertyNames;\n    const cssBuild = StyleUtil.getCssBuild(template);\n    const styleInfo = new StyleInfo(\n      ast,\n      placeholder,\n      ownStylePropertyNames,\n      is,\n      typeExtension,\n      cssBuild\n    );\n    StyleInfo.set(host, styleInfo);\n    return styleInfo;\n  }\n  /**\n   * Returns a boolean that indicates if styles need to be reprocessed because\n   * the apply shim is now available.\n   * @return {boolean}\n   */\n  _ensureApplyShim() {\n    if (!this._applyShim && window.ShadyCSS && window.ShadyCSS.ApplyShim) {\n      this._applyShim = /** @type {!Object} */ (window.ShadyCSS.ApplyShim);\n      this._applyShim['invalidCallback'] = ApplyShimUtils.invalidate;\n      return true;\n    }\n    return false;\n  }\n  _ensureCustomStyleInterface() {\n    if (this._customStyleInterface) {\n      return;\n    } else if (window.ShadyCSS && window.ShadyCSS.CustomStyleInterface) {\n      this._customStyleInterface = /** @type {!CustomStyleInterfaceInterface} */ (window\n        .ShadyCSS.CustomStyleInterface);\n      /** @type {function(!HTMLStyleElement)} */\n      this._customStyleInterface['transformCallback'] = (style) => {\n        this.transformCustomStyleForDocument(style);\n      };\n      this._customStyleInterface['validateCallback'] = () => {\n        requestAnimationFrame(() => {\n          if (\n            this._customStyleInterface['enqueued'] ||\n            this._elementsHaveApplied\n          ) {\n            this.flushCustomStyles();\n          }\n        });\n      };\n    }\n  }\n  /**\n   * Returns a boolean that indicates if styles need to be reprocessed because\n   * the apply shim is now available.\n   * @return {boolean}\n   */\n  _ensure() {\n    const needsApplyShimUpdate = this._ensureApplyShim();\n    this._ensureCustomStyleInterface();\n    return needsApplyShimUpdate;\n  }\n  /**\n   * Flush and apply custom styles to document\n   */\n  flushCustomStyles() {\n    if (disableRuntime) {\n      return;\n    }\n    const needsApplyShimUpdate = this._ensure();\n    if (!this._customStyleInterface) {\n      return;\n    }\n    let customStyles = this._customStyleInterface['processStyles']();\n    // early return if custom-styles don't need validation\n    if (!needsApplyShimUpdate && !this._customStyleInterface['enqueued']) {\n      return;\n    }\n    // bail if custom styles are built optimally\n    if (StyleUtil.isOptimalCssBuild(this._documentOwnerStyleInfo.cssBuild)) {\n      return;\n    }\n    if (!nativeCssVariables) {\n      this._reorderCustomStylesRules(customStyles);\n      this._updateProperties(this._documentOwner, this._documentOwnerStyleInfo);\n      this._applyCustomStyles(customStyles);\n      if (this._elementsHaveApplied) {\n        // if custom elements have upgraded and there are no native css variables, we must recalculate the whole tree\n        this.styleDocument();\n      }\n    } else if (!this._documentOwnerStyleInfo.cssBuild) {\n      this._revalidateCustomStyleApplyShim(customStyles);\n    }\n    this._customStyleInterface['enqueued'] = false;\n  }\n  /**\n   * Reorder of custom styles for Custom Property shim\n   * @param {!Array<!CustomStyleProvider>} customStyles\n   */\n  _reorderCustomStylesRules(customStyles) {\n    const styles = customStyles\n      .map((c) => this._customStyleInterface['getStyleForCustomStyle'](c))\n      .filter((s) => !!s);\n    // sort styles in document order\n    styles.sort((a, b) => {\n      // use `b.compare(a)` to be more straightforward\n      const position = b.compareDocumentPosition(a);\n      if (position & Node.DOCUMENT_POSITION_FOLLOWING) {\n        // A is after B, A should be higher sorted\n        return 1;\n      } else if (position & Node.DOCUMENT_POSITION_PRECEDING) {\n        // A is before B, A should be lower sorted\n        return -1;\n      } else {\n        return 0;\n      }\n    });\n    // sort ast ordering for document\n    this._documentOwnerStyleInfo.styleRules['rules'] = styles.map((s) =>\n      StyleUtil.rulesForStyle(s)\n    );\n  }\n  /**\n   * Apply styles for the given element\n   *\n   * @param {!HTMLElement} host\n   * @param {Object=} overrideProps\n   */\n  styleElement(host, overrideProps) {\n    if (disableRuntime) {\n      if (overrideProps) {\n        if (!StyleInfo.get(host)) {\n          StyleInfo.set(host, new StyleInfo(null));\n        }\n        const styleInfo = /** @type {!StyleInfo} */ (StyleInfo.get(host));\n        this._mixOverrideStyleProps(styleInfo, overrideProps);\n        this.styleElementNativeVariables(host, styleInfo);\n      }\n      return;\n    }\n    const styleInfo = StyleInfo.get(host) || this._prepareHost(host);\n    // if there is no style info at this point, bail\n    if (!styleInfo) {\n      return;\n    }\n    // Only trip the `elementsHaveApplied` flag if a node other that the root document has `applyStyle` called\n    if (!this._isRootOwner(host)) {\n      this._elementsHaveApplied = true;\n    }\n    if (overrideProps) {\n      this._mixOverrideStyleProps(styleInfo, overrideProps);\n    }\n    if (!nativeCssVariables) {\n      this.styleElementShimVariables(host, styleInfo);\n    } else {\n      this.styleElementNativeVariables(host, styleInfo);\n    }\n  }\n  /**\n   * @param {!StyleInfo} styleInfo\n   * @param {Object} overrideProps\n   */\n  _mixOverrideStyleProps(styleInfo, overrideProps) {\n    styleInfo.overrideStyleProperties = styleInfo.overrideStyleProperties || {};\n    Object.assign(styleInfo.overrideStyleProperties, overrideProps);\n  }\n  /**\n   * @param {!HTMLElement} host\n   * @param {!StyleInfo} styleInfo\n   */\n  styleElementShimVariables(host, styleInfo) {\n    this.flush();\n    this._updateProperties(host, styleInfo);\n    if (\n      styleInfo.ownStylePropertyNames &&\n      styleInfo.ownStylePropertyNames.length\n    ) {\n      this._applyStyleProperties(host, styleInfo);\n    }\n  }\n  /**\n   * @param {!HTMLElement} host\n   * @param {!StyleInfo} styleInfo\n   */\n  styleElementNativeVariables(host, styleInfo) {\n    const {is} = StyleUtil.getIsExtends(host);\n    if (styleInfo.overrideStyleProperties) {\n      updateNativeProperties(host, styleInfo.overrideStyleProperties);\n    }\n    const template = templateMap[is];\n    // bail early if there is no shadowroot for this element\n    if (!template && !this._isRootOwner(host)) {\n      return;\n    }\n    // bail early if the template was built with polymer-css-build\n    if (template && StyleUtil.elementHasBuiltCss(template)) {\n      return;\n    }\n    if (\n      template &&\n      template._style &&\n      !ApplyShimUtils.templateIsValid(template)\n    ) {\n      // update template\n      if (!ApplyShimUtils.templateIsValidating(template)) {\n        this._ensure();\n        this._applyShim &&\n          this._applyShim['transformRules'](template['_styleAst'], is);\n        template._style.textContent = StyleTransformer.elementStyles(\n          host,\n          styleInfo.styleRules\n        );\n        ApplyShimUtils.startValidatingTemplate(template);\n      }\n      // update instance if native shadowdom\n      if (nativeShadow) {\n        let root = host.shadowRoot;\n        if (root) {\n          let style = root.querySelector('style');\n          if (style) {\n            style.textContent = StyleTransformer.elementStyles(\n              host,\n              styleInfo.styleRules\n            );\n          }\n        }\n      }\n      styleInfo.styleRules = template['_styleAst'];\n    }\n  }\n  _styleOwnerForNode(node) {\n    let root = StyleUtil.wrap(node).getRootNode();\n    let host = root.host;\n    if (host) {\n      if (StyleInfo.get(host) || this._prepareHost(host)) {\n        return host;\n      } else {\n        return this._styleOwnerForNode(host);\n      }\n    }\n    return this._documentOwner;\n  }\n  _isRootOwner(node) {\n    return node === this._documentOwner;\n  }\n  _applyStyleProperties(host, styleInfo) {\n    let is = StyleUtil.getIsExtends(host).is;\n    let cacheEntry = styleCache.fetch(\n      is,\n      styleInfo.styleProperties,\n      styleInfo.ownStylePropertyNames\n    );\n    let cachedScopeSelector = cacheEntry && cacheEntry.scopeSelector;\n    let cachedStyle = cacheEntry ? cacheEntry.styleElement : null;\n    let oldScopeSelector = styleInfo.scopeSelector;\n    // only generate new scope if cached style is not found\n    styleInfo.scopeSelector =\n      cachedScopeSelector || this._generateScopeSelector(is);\n    let style = StyleProperties.applyElementStyle(\n      host,\n      styleInfo.styleProperties,\n      styleInfo.scopeSelector,\n      cachedStyle\n    );\n    if (!nativeShadow) {\n      StyleProperties.applyElementScopeSelector(\n        host,\n        styleInfo.scopeSelector,\n        oldScopeSelector\n      );\n    }\n    if (!cacheEntry) {\n      styleCache.store(\n        is,\n        styleInfo.styleProperties,\n        style,\n        styleInfo.scopeSelector\n      );\n    }\n    return style;\n  }\n  _updateProperties(host, styleInfo) {\n    let owner = this._styleOwnerForNode(host);\n    let ownerStyleInfo = StyleInfo.get(owner);\n    let ownerProperties = ownerStyleInfo.styleProperties;\n    // style owner has not updated properties yet\n    // go up the chain and force property update,\n    // except if the owner is the document\n    if (owner !== this._documentOwner && !ownerProperties) {\n      this._updateProperties(owner, ownerStyleInfo);\n      ownerProperties = ownerStyleInfo.styleProperties;\n    }\n    let props = Object.create(ownerProperties || null);\n    let hostAndRootProps = StyleProperties.hostAndRootPropertiesForScope(\n      host,\n      styleInfo.styleRules,\n      styleInfo.cssBuild\n    );\n    let propertyData = StyleProperties.propertyDataFromStyles(\n      ownerStyleInfo.styleRules,\n      host\n    );\n    let propertiesMatchingHost = propertyData.properties;\n    Object.assign(\n      props,\n      hostAndRootProps.hostProps,\n      propertiesMatchingHost,\n      hostAndRootProps.rootProps\n    );\n    this._mixinOverrideStyles(props, styleInfo.overrideStyleProperties);\n    StyleProperties.reify(props);\n    styleInfo.styleProperties = props;\n  }\n  _mixinOverrideStyles(props, overrides) {\n    for (let p in overrides) {\n      let v = overrides[p];\n      // skip override props if they are not truthy or 0\n      // in order to fall back to inherited values\n      if (v || v === 0) {\n        props[p] = v;\n      }\n    }\n  }\n  /**\n   * Update styles of the whole document\n   *\n   * @param {Object=} properties\n   */\n  styleDocument(properties) {\n    this.styleSubtree(this._documentOwner, properties);\n  }\n  /**\n   * Update styles of a subtree\n   *\n   * @param {!HTMLElement} host\n   * @param {Object=} properties\n   */\n  styleSubtree(host, properties) {\n    const wrappedHost = StyleUtil.wrap(host);\n    const root = wrappedHost.shadowRoot;\n    const isRootOwner = this._isRootOwner(host);\n    if (root || isRootOwner) {\n      this.styleElement(host, properties);\n    }\n    const descendantRoot = isRootOwner ? wrappedHost : root;\n    if (descendantRoot) {\n      const descendantHosts = Array.from(\n        descendantRoot.querySelectorAll('*')\n      ).filter((x) => StyleUtil.wrap(x).shadowRoot);\n      for (let i = 0; i < descendantHosts.length; i++) {\n        this.styleSubtree(descendantHosts[i]);\n      }\n    }\n  }\n  /* Custom Style operations */\n  _revalidateCustomStyleApplyShim(customStyles) {\n    for (let i = 0; i < customStyles.length; i++) {\n      let c = customStyles[i];\n      let s = this._customStyleInterface['getStyleForCustomStyle'](c);\n      if (s) {\n        this._revalidateApplyShim(s);\n      }\n    }\n  }\n  _applyCustomStyles(customStyles) {\n    for (let i = 0; i < customStyles.length; i++) {\n      let c = customStyles[i];\n      let s = this._customStyleInterface['getStyleForCustomStyle'](c);\n      if (s) {\n        StyleProperties.applyCustomStyle(\n          s,\n          this._documentOwnerStyleInfo.styleProperties\n        );\n      }\n    }\n  }\n  transformCustomStyleForDocument(style) {\n    const cssBuild = StyleUtil.getCssBuild(style);\n    if (cssBuild !== this._documentOwnerStyleInfo.cssBuild) {\n      this._documentOwnerStyleInfo.cssBuild = cssBuild;\n    }\n    if (StyleUtil.isOptimalCssBuild(cssBuild)) {\n      return;\n    }\n    let ast = StyleUtil.rulesForStyle(style);\n    StyleUtil.forEachRule(ast, (rule) => {\n      if (nativeShadow) {\n        StyleTransformer.normalizeRootSelector(rule);\n      } else {\n        StyleTransformer.documentRule(rule);\n      }\n      if (nativeCssVariables && cssBuild === '') {\n        this._ensure();\n        this._applyShim && this._applyShim['transformRule'](rule);\n      }\n    });\n    if (nativeCssVariables) {\n      style.textContent = StyleUtil.toCssText(ast);\n    } else {\n      this._documentOwnerStyleInfo.styleRules['rules'].push(ast);\n    }\n  }\n  _revalidateApplyShim(style) {\n    if (nativeCssVariables && this._applyShim) {\n      let ast = StyleUtil.rulesForStyle(style);\n      this._ensure();\n      this._applyShim['transformRules'](ast);\n      style.textContent = StyleUtil.toCssText(ast);\n    }\n  }\n  getComputedStyleValue(element, property) {\n    let value;\n    if (!nativeCssVariables) {\n      // element is either a style host, or an ancestor of a style host\n      let styleInfo =\n        StyleInfo.get(element) ||\n        StyleInfo.get(this._styleOwnerForNode(element));\n      value = styleInfo.styleProperties[property];\n    }\n    // fall back to the property value from the computed styling\n    value =\n      value || window.getComputedStyle(element).getPropertyValue(property);\n    // trim whitespace that can come after the `:` in css\n    // example: padding: 2px -> \" 2px\"\n    return value ? value.trim() : '';\n  }\n  // given an element and a classString, replaces\n  // the element's class with the provided classString and adds\n  // any necessary ShadyCSS static and property based scoping selectors\n  setElementClass(element, classString) {\n    let root = StyleUtil.wrap(element).getRootNode();\n    let classes;\n    if (classString) {\n      let definitelyString =\n        typeof classString === 'string' ? classString : String(classString);\n      classes = definitelyString.split(/\\s/);\n    } else {\n      classes = [];\n    }\n    let scopeName = root.host && root.host.localName;\n    // If no scope, try to discover scope name from existing class.\n    // This can occur if, for example, a template stamped element that\n    // has been scoped is manipulated when not in a root.\n    if (!scopeName) {\n      var classAttr = element.getAttribute('class');\n      if (classAttr) {\n        let k$ = classAttr.split(/\\s/);\n        for (let i = 0; i < k$.length; i++) {\n          if (k$[i] === StyleTransformer.SCOPE_NAME) {\n            scopeName = k$[i + 1];\n            break;\n          }\n        }\n      }\n    }\n    if (scopeName) {\n      classes.push(StyleTransformer.SCOPE_NAME, scopeName);\n    }\n    if (!nativeCssVariables) {\n      let styleInfo = StyleInfo.get(element);\n      if (styleInfo && styleInfo.scopeSelector) {\n        classes.push(StyleProperties.XSCOPE_NAME, styleInfo.scopeSelector);\n      }\n    }\n    StyleUtil.setElementClassRaw(element, classes.join(' '));\n  }\n  _styleInfoForNode(node) {\n    return StyleInfo.get(node);\n  }\n  /**\n   * @param {!Element} node\n   * @param {string} scope\n   */\n  scopeNode(node, scope) {\n    StyleTransformer.element(node, scope);\n  }\n  /**\n   * @param {!Element} node\n   * @param {string} scope\n   */\n  unscopeNode(node, scope) {\n    StyleTransformer.element(node, scope, true);\n  }\n  /**\n   * @param {!Node} node\n   * @return {string}\n   */\n  scopeForNode(node) {\n    return getOwnerScope(node);\n  }\n  /**\n   * @param {!Element} node\n   * @return {string}\n   */\n  currentScopeForNode(node) {\n    return getCurrentScope(node);\n  }\n}\n\n/* exports */\n/* eslint-disable no-self-assign */\nScopingShim.prototype['flush'] = ScopingShim.prototype.flush;\nScopingShim.prototype['prepareTemplate'] =\n  ScopingShim.prototype.prepareTemplate;\nScopingShim.prototype['styleElement'] = ScopingShim.prototype.styleElement;\nScopingShim.prototype['styleDocument'] = ScopingShim.prototype.styleDocument;\nScopingShim.prototype['styleSubtree'] = ScopingShim.prototype.styleSubtree;\nScopingShim.prototype['getComputedStyleValue'] =\n  ScopingShim.prototype.getComputedStyleValue;\nScopingShim.prototype['setElementClass'] =\n  ScopingShim.prototype.setElementClass;\nScopingShim.prototype['_styleInfoForNode'] =\n  ScopingShim.prototype._styleInfoForNode;\nScopingShim.prototype['transformCustomStyleForDocument'] =\n  ScopingShim.prototype.transformCustomStyleForDocument;\nScopingShim.prototype['getStyleAst'] = ScopingShim.prototype.getStyleAst;\nScopingShim.prototype['styleAstToString'] =\n  ScopingShim.prototype.styleAstToString;\nScopingShim.prototype['flushCustomStyles'] =\n  ScopingShim.prototype.flushCustomStyles;\nScopingShim.prototype['scopeNode'] = ScopingShim.prototype.scopeNode;\nScopingShim.prototype['unscopeNode'] = ScopingShim.prototype.unscopeNode;\nScopingShim.prototype['scopeForNode'] = ScopingShim.prototype.scopeForNode;\nScopingShim.prototype['currentScopeForNode'] =\n  ScopingShim.prototype.currentScopeForNode;\nScopingShim.prototype['prepareAdoptedCssText'] =\n  ScopingShim.prototype.prepareAdoptedCssText;\n/* eslint-enable no-self-assign */\nObject.defineProperties(ScopingShim.prototype, {\n  'nativeShadow': {\n    get() {\n      return nativeShadow;\n    },\n  },\n  'nativeCss': {\n    get() {\n      return nativeCssVariables;\n    },\n  },\n});\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n'use strict';\n\nexport default class StyleCache {\n  constructor(typeMax = 100) {\n    // map element name -> [{properties, styleElement, scopeSelector}]\n    this.cache = {};\n    /** @type {number} */\n    this.typeMax = typeMax;\n  }\n\n  _validate(cacheEntry, properties, ownPropertyNames) {\n    for (let idx = 0; idx < ownPropertyNames.length; idx++) {\n      let pn = ownPropertyNames[idx];\n      if (cacheEntry.properties[pn] !== properties[pn]) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  store(tagname, properties, styleElement, scopeSelector) {\n    let list = this.cache[tagname] || [];\n    list.push({properties, styleElement, scopeSelector});\n    if (list.length > this.typeMax) {\n      list.shift();\n    }\n    this.cache[tagname] = list;\n  }\n\n  fetch(tagname, properties, ownPropertyNames) {\n    let list = this.cache[tagname];\n    if (!list) {\n      return;\n    }\n    // reverse list for most-recent lookups\n    for (let idx = list.length - 1; idx >= 0; idx--) {\n      let entry = list[idx];\n      if (this._validate(entry, properties, ownPropertyNames)) {\n        return entry;\n      }\n    }\n  }\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {StyleNode} from './css-parse.js'; // eslint-disable-line @typescript-eslint/no-unused-vars\n\n/** @const {string} */\nconst infoKey = '__styleInfo';\n\nexport default class StyleInfo {\n  /**\n   * @param {Element} node\n   * @return {StyleInfo}\n   */\n  static get(node) {\n    if (node) {\n      return node[infoKey];\n    } else {\n      return null;\n    }\n  }\n  /**\n   * @param {!Element} node\n   * @param {StyleInfo} styleInfo\n   * @return {StyleInfo}\n   */\n  static set(node, styleInfo) {\n    node[infoKey] = styleInfo;\n    return styleInfo;\n  }\n  /**\n   * @param {StyleNode} ast\n   * @param {Node=} placeholder\n   * @param {Array<string>=} ownStylePropertyNames\n   * @param {string=} elementName\n   * @param {string=} typeExtension\n   * @param {string=} cssBuild\n   */\n  constructor(\n    ast,\n    placeholder,\n    ownStylePropertyNames,\n    elementName,\n    typeExtension,\n    cssBuild\n  ) {\n    /** @type {StyleNode} */\n    this.styleRules = ast || null;\n    /** @type {Node} */\n    this.placeholder = placeholder || null;\n    /** @type {!Array<string>} */\n    this.ownStylePropertyNames = ownStylePropertyNames || [];\n    /** @type {Object} */\n    this.overrideStyleProperties = null;\n    /** @type {string} */\n    this.elementName = elementName || '';\n    /** @type {string} */\n    this.cssBuild = cssBuild || '';\n    /** @type {string} */\n    this.typeExtension = typeExtension || '';\n    /** @type {Object<string, string>} */\n    this.styleProperties = null;\n    /** @type {?string} */\n    this.scopeSelector = null;\n    /** @type {HTMLStyleElement} */\n    this.customStyle = null;\n  }\n  _getStyleRules() {\n    return this.styleRules;\n  }\n}\n\n/* eslint-disable-next-line no-self-assign */\nStyleInfo.prototype['_getStyleRules'] = StyleInfo.prototype._getStyleRules;\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {applyStylePlaceHolder} from './style-util.js';\nimport {nativeShadow, disableRuntime} from './style-settings.js';\n\n/** @type {!Object<string, !Node>} */\nconst placeholderMap = {};\n\n/**\n * @param {string} elementName\n * @return {Node}\n */\nexport function getStylePlaceholder(elementName) {\n  return placeholderMap[elementName] || null;\n}\n\n/**\n * @param {string} elementName\n */\nexport function ensureStylePlaceholder(elementName) {\n  if (!placeholderMap[elementName]) {\n    placeholderMap[elementName] = applyStylePlaceHolder(elementName);\n  }\n}\n\n/**\n * @const {CustomElementRegistry}\n */\nconst ce = window['customElements'];\nif (ce && !nativeShadow && !disableRuntime) {\n  /**\n   * @const {function(this:CustomElementRegistry, string,function(new:HTMLElement),{extends: string}=)}\n   */\n  const origDefine = ce['define'];\n  /**\n   * @param {string} name\n   * @param {function(new:HTMLElement)} clazz\n   * @param {{extends: string}=} options\n   */\n  const wrappedDefine = (name, clazz, options) => {\n    ensureStylePlaceholder(name);\n    origDefine.call(\n      /** @type {!CustomElementRegistry} */ (ce),\n      name,\n      clazz,\n      options\n    );\n  };\n  ce['define'] = wrappedDefine;\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {removeCustomPropAssignment, StyleNode} from './css-parse.js'; // eslint-disable-line @typescript-eslint/no-unused-vars\nimport {nativeShadow} from './style-settings.js';\nimport StyleTransformer from './style-transformer.js';\nimport * as StyleUtil from './style-util.js';\nimport * as RX from './common-regex.js';\nimport StyleInfo from './style-info.js';\n\n// TODO: dedupe with shady\n/**\n * @param {string} selector\n * @return {boolean}\n * @this {Element}\n */\nconst matchesSelector = function (selector) {\n  const method =\n    this.matches ||\n    this.matchesSelector ||\n    this.mozMatchesSelector ||\n    this.msMatchesSelector ||\n    this.oMatchesSelector ||\n    this.webkitMatchesSelector;\n  return method && method.call(this, selector);\n};\n\nconst rootSelector = /:host\\s*>\\s*/;\n\nfunction checkRoot(hostScope, selector) {\n  return (\n    Boolean(selector.match(rootSelector)) ||\n    (hostScope === 'html' && selector.indexOf('html') > -1)\n  );\n}\n\nconst IS_IE = navigator.userAgent.match('Trident');\n\nconst XSCOPE_NAME = 'x-scope';\n\nclass StyleProperties {\n  /** @return {string} */\n  get XSCOPE_NAME() {\n    return XSCOPE_NAME;\n  }\n  /**\n   * decorates styles with rule info and returns an array of used style property names\n   *\n   * @param {StyleNode} rules\n   * @return {!Array<string>}\n   */\n  decorateStyles(rules) {\n    let self = this,\n      props = {},\n      keyframes = [],\n      ruleIndex = 0;\n    StyleUtil.forEachRule(\n      rules,\n      function (rule) {\n        self.decorateRule(rule);\n        // mark in-order position of ast rule in styles block, used for cache key\n        rule.index = ruleIndex++;\n        self.collectPropertiesInCssText(rule.propertyInfo.cssText, props);\n      },\n      function onKeyframesRule(rule) {\n        keyframes.push(rule);\n      }\n    );\n    // Cache all found keyframes rules for later reference:\n    rules._keyframes = keyframes;\n    // return this list of property names *consumes* in these styles.\n    let names = [];\n    for (let i in props) {\n      names.push(i);\n    }\n    return names;\n  }\n\n  // decorate a single rule with property info\n  decorateRule(rule) {\n    if (rule.propertyInfo) {\n      return rule.propertyInfo;\n    }\n    let info = {},\n      properties = {};\n    let hasProperties = this.collectProperties(rule, properties);\n    if (hasProperties) {\n      info.properties = properties;\n      // TODO(sorvell): workaround parser seeing mixins as additional rules\n      rule['rules'] = null;\n    }\n    info.cssText = this.collectCssText(rule);\n    rule.propertyInfo = info;\n    return info;\n  }\n\n  // collects the custom properties from a rule's cssText\n  collectProperties(rule, properties) {\n    let info = rule.propertyInfo;\n    if (info) {\n      if (info.properties) {\n        Object.assign(properties, info.properties);\n        return true;\n      }\n    } else {\n      let m,\n        rx = RX.VAR_ASSIGN;\n      let cssText = rule['parsedCssText'];\n      let value;\n      let any;\n      while ((m = rx.exec(cssText))) {\n        // note: group 2 is var, 3 is mixin\n        value = (m[2] || m[3]).trim();\n        // value of 'inherit' or 'unset' is equivalent to not setting the property here\n        if (value !== 'inherit' || value !== 'unset') {\n          properties[m[1].trim()] = value;\n        }\n        any = true;\n      }\n      return any;\n    }\n  }\n\n  // returns cssText of properties that consume variables/mixins\n  collectCssText(rule) {\n    return this.collectConsumingCssText(rule['parsedCssText']);\n  }\n\n  // NOTE: we support consumption inside mixin assignment\n  // but not production, so strip out {...}\n  collectConsumingCssText(cssText) {\n    return cssText.replace(RX.BRACKETED, '').replace(RX.VAR_ASSIGN, '');\n  }\n\n  collectPropertiesInCssText(cssText, props) {\n    let m;\n    while ((m = RX.VAR_CONSUMED.exec(cssText))) {\n      let name = m[1];\n      // This regex catches all variable names, and following non-whitespace char\n      // If next char is not ':', then variable is a consumer\n      if (m[2] !== ':') {\n        props[name] = true;\n      }\n    }\n  }\n\n  // turns custom properties into realized values.\n  reify(props) {\n    // big perf optimization here: reify only *own* properties\n    // since this object has __proto__ of the element's scope properties\n    let names = Object.getOwnPropertyNames(props);\n    for (let i = 0, n; i < names.length; i++) {\n      n = names[i];\n      props[n] = this.valueForProperty(props[n], props);\n    }\n  }\n\n  // given a property value, returns the reified value\n  // a property value may be:\n  // (1) a literal value like: red or 5px;\n  // (2) a variable value like: var(--a), var(--a, red), or var(--a, --b) or\n  // var(--a, var(--b));\n  // (3) a literal mixin value like { properties }. Each of these properties\n  // can have values that are: (a) literal, (b) variables, (c) @apply mixins.\n  valueForProperty(property, props) {\n    // case (1) default\n    // case (3) defines a mixin and we have to reify the internals\n    if (property) {\n      if (property.indexOf(';') >= 0) {\n        property = this.valueForProperties(property, props);\n      } else {\n        // case (2) variable\n        let self = this;\n        let fn = function (prefix, value, fallback, suffix) {\n          if (!value) {\n            return prefix + suffix;\n          }\n          let propertyValue = self.valueForProperty(props[value], props);\n          // if value is \"initial\", then the variable should be treated as unset\n          if (!propertyValue || propertyValue === 'initial') {\n            // fallback may be --a or var(--a) or literal\n            propertyValue =\n              self.valueForProperty(props[fallback] || fallback, props) ||\n              fallback;\n          } else if (propertyValue === 'apply-shim-inherit') {\n            // CSS build will replace `inherit` with `apply-shim-inherit`\n            // for use with native css variables.\n            // Since we have full control, we can use `inherit` directly.\n            propertyValue = 'inherit';\n          }\n          return prefix + (propertyValue || '') + suffix;\n        };\n        property = StyleUtil.processVariableAndFallback(property, fn);\n      }\n    }\n    return (property && property.trim()) || '';\n  }\n\n  // note: we do not yet support mixin within mixin\n  valueForProperties(property, props) {\n    let parts = property.split(';');\n    for (let i = 0, p, m; i < parts.length; i++) {\n      if ((p = parts[i])) {\n        RX.MIXIN_MATCH.lastIndex = 0;\n        m = RX.MIXIN_MATCH.exec(p);\n        if (m) {\n          p = this.valueForProperty(props[m[1]], props);\n        } else {\n          let colon = p.indexOf(':');\n          if (colon !== -1) {\n            let pp = p.substring(colon);\n            pp = pp.trim();\n            pp = this.valueForProperty(pp, props) || pp;\n            p = p.substring(0, colon) + pp;\n          }\n        }\n        parts[i] =\n          p && p.lastIndexOf(';') === p.length - 1\n            ? p.slice(0, -1) // strip trailing ;\n            : p || '';\n      }\n    }\n    return parts.join(';');\n  }\n\n  applyProperties(rule, props) {\n    let output = '';\n    // dynamically added sheets may not be decorated so ensure they are.\n    if (!rule.propertyInfo) {\n      this.decorateRule(rule);\n    }\n    if (rule.propertyInfo.cssText) {\n      output = this.valueForProperties(rule.propertyInfo.cssText, props);\n    }\n    rule['cssText'] = output;\n  }\n\n  // Apply keyframe transformations to the cssText of a given rule. The\n  // keyframeTransforms object is a map of keyframe names to transformer\n  // functions which take in cssText and spit out transformed cssText.\n  applyKeyframeTransforms(rule, keyframeTransforms) {\n    let input = rule['cssText'];\n    let output = rule['cssText'];\n    if (rule.hasAnimations == null) {\n      // Cache whether or not the rule has any animations to begin with:\n      rule.hasAnimations = RX.ANIMATION_MATCH.test(input);\n    }\n    // If there are no animations referenced, we can skip transforms:\n    if (rule.hasAnimations) {\n      let transform;\n      // If we haven't transformed this rule before, we iterate over all\n      // transforms:\n      if (rule.keyframeNamesToTransform == null) {\n        rule.keyframeNamesToTransform = [];\n        for (let keyframe in keyframeTransforms) {\n          transform = keyframeTransforms[keyframe];\n          output = transform(input);\n          // If the transform actually changed the CSS text, we cache the\n          // transform name for future use:\n          if (input !== output) {\n            input = output;\n            rule.keyframeNamesToTransform.push(keyframe);\n          }\n        }\n      } else {\n        // If we already have a list of keyframe names that apply to this\n        // rule, we apply only those keyframe name transforms:\n        for (let i = 0; i < rule.keyframeNamesToTransform.length; ++i) {\n          transform = keyframeTransforms[rule.keyframeNamesToTransform[i]];\n          input = transform(input);\n        }\n        output = input;\n      }\n    }\n    rule['cssText'] = output;\n  }\n\n  // Test if the rules in these styles matches the given `element` and if so,\n  // collect any custom properties into `props`.\n  /**\n   * @param {StyleNode} rules\n   * @param {Element} element\n   */\n  propertyDataFromStyles(rules, element) {\n    let props = {};\n    // generates a unique key for these matches\n    let o = [];\n    // note: active rules excludes non-matching @media rules\n    StyleUtil.forEachRule(\n      rules,\n      (rule) => {\n        // TODO(sorvell): we could trim the set of rules at declaration\n        // time to only include ones that have properties\n        if (!rule.propertyInfo) {\n          this.decorateRule(rule);\n        }\n        // match element against transformedSelector: selector may contain\n        // unwanted uniquification and parsedSelector does not directly match\n        // for :host selectors.\n        let selectorToMatch =\n          rule.transformedSelector || rule['parsedSelector'];\n        if (element && rule.propertyInfo.properties && selectorToMatch) {\n          if (matchesSelector.call(element, selectorToMatch)) {\n            this.collectProperties(rule, props);\n            // produce numeric key for these matches for lookup\n            addToBitMask(rule.index, o);\n          }\n        }\n      },\n      null,\n      true\n    );\n    return {properties: props, key: o};\n  }\n\n  /**\n   * @param {Element} scope\n   * @param {StyleNode} rule\n   * @param {string} cssBuild\n   * @param {function(Object)} callback\n   */\n  whenHostOrRootRule(scope, rule, cssBuild, callback) {\n    if (!(/** @type {?} */ (rule.propertyInfo))) {\n      this.decorateRule(rule);\n    }\n    if (!(/** @type {?} */ (rule.propertyInfo).properties)) {\n      return;\n    }\n    let {is, typeExtension} = StyleUtil.getIsExtends(scope);\n    let hostScope = is\n      ? StyleTransformer._calcHostScope(is, typeExtension)\n      : 'html';\n    let parsedSelector = rule['parsedSelector'];\n    let isRoot = checkRoot(hostScope, parsedSelector);\n    let isHost = parsedSelector.indexOf(':host') === 0 && !isRoot;\n    // build info is either in scope (when scope is an element) or in the style\n    // when scope is the default scope; note: this allows default scope to have\n    // mixed mode built and unbuilt styles.\n    if (cssBuild === 'shady') {\n      // :root -> x-foo > *.x-foo for elements and html for custom-style\n      isRoot =\n        parsedSelector === hostScope + ' > *.' + hostScope ||\n        parsedSelector.indexOf('html') !== -1;\n      // :host -> x-foo for elements, but sub-rules have .x-foo in them\n      isHost = !isRoot && parsedSelector.indexOf(hostScope) === 0;\n    }\n    if (!isRoot && !isHost) {\n      return;\n    }\n    let selectorToMatch = hostScope;\n    if (isHost) {\n      // need to transform :host because `:host` does not work with `matches`\n      if (!(/** @type {?} */ (rule.transformedSelector))) {\n        // transform :host into a matchable selector\n        rule.transformedSelector = StyleTransformer._transformRuleCss(\n          rule,\n          StyleTransformer._transformComplexSelector,\n          StyleTransformer._calcElementScope(is),\n          hostScope\n        );\n      }\n      selectorToMatch =\n        /** @type {?} */ (rule.transformedSelector) || hostScope;\n    }\n    if (isRoot && hostScope === 'html') {\n      selectorToMatch =\n        /** @type {?} */ (rule.transformedSelector) ||\n        /** @type {?} */ (rule.parsedSelector);\n    }\n    callback({\n      selector: selectorToMatch,\n      isHost: isHost,\n      isRoot: isRoot,\n    });\n  }\n  /**\n   * @param {Element} scope\n   * @param {StyleNode} rules\n   * @param {string} cssBuild\n   * @return {!Object}\n   */\n  hostAndRootPropertiesForScope(scope, rules, cssBuild) {\n    let hostProps = {},\n      rootProps = {};\n    // note: active rules excludes non-matching @media rules\n    StyleUtil.forEachRule(\n      rules,\n      (rule) => {\n        // if scope is StyleDefaults, use _element for matchesSelector\n        this.whenHostOrRootRule(scope, rule, cssBuild, (info) => {\n          let element = scope._element || scope;\n          if (matchesSelector.call(element, info.selector)) {\n            if (info.isHost) {\n              this.collectProperties(rule, hostProps);\n            } else {\n              this.collectProperties(rule, rootProps);\n            }\n          }\n        });\n      },\n      null,\n      true\n    );\n    return {rootProps: rootProps, hostProps: hostProps};\n  }\n\n  /**\n   * @param {Element} element\n   * @param {Object} properties\n   * @param {string} scopeSelector\n   */\n  transformStyles(element, properties, scopeSelector) {\n    let self = this;\n    let {is, typeExtension} = StyleUtil.getIsExtends(element);\n    let hostSelector = StyleTransformer._calcHostScope(is, typeExtension);\n    let rxHostSelector = element.extends\n      ? '\\\\' + hostSelector.slice(0, -1) + '\\\\]'\n      : hostSelector;\n    let hostRx = new RegExp(RX.HOST_PREFIX + rxHostSelector + RX.HOST_SUFFIX);\n    let {styleRules: rules, cssBuild} = StyleInfo.get(element);\n    let keyframeTransforms = this._elementKeyframeTransforms(\n      element,\n      rules,\n      scopeSelector\n    );\n    return StyleTransformer.elementStyles(\n      element,\n      rules,\n      function (rule) {\n        self.applyProperties(rule, properties);\n        if (\n          !nativeShadow &&\n          !StyleUtil.isKeyframesSelector(rule) &&\n          rule['cssText']\n        ) {\n          // NOTE: keyframe transforms only scope munge animation names, so it\n          // is not necessary to apply them in ShadowDOM.\n          self.applyKeyframeTransforms(rule, keyframeTransforms);\n          self._scopeSelector(rule, hostRx, hostSelector, scopeSelector);\n        }\n      },\n      cssBuild\n    );\n  }\n\n  /**\n   * @param {Element} element\n   * @param {StyleNode} rules\n   * @param {string} scopeSelector\n   * @return {!Object}\n   */\n  _elementKeyframeTransforms(element, rules, scopeSelector) {\n    let keyframesRules = rules._keyframes;\n    let keyframeTransforms = {};\n    if (!nativeShadow && keyframesRules) {\n      // For non-ShadowDOM, we transform all known keyframes rules in\n      // advance for the current scope. This allows us to catch keyframes\n      // rules that appear anywhere in the stylesheet:\n      for (\n        let i = 0, keyframesRule = keyframesRules[i];\n        i < keyframesRules.length;\n        keyframesRule = keyframesRules[++i]\n      ) {\n        this._scopeKeyframes(keyframesRule, scopeSelector);\n        keyframeTransforms[\n          keyframesRule['keyframesName']\n        ] = this._keyframesRuleTransformer(keyframesRule);\n      }\n    }\n    return keyframeTransforms;\n  }\n\n  // Generate a factory for transforming a chunk of CSS text to handle a\n  // particular scoped keyframes rule.\n  /**\n   * @param {StyleNode} keyframesRule\n   * @return {function(string):string}\n   */\n  _keyframesRuleTransformer(keyframesRule) {\n    return function (cssText) {\n      return cssText.replace(\n        /** @type {?} */ (keyframesRule.keyframesNameRx),\n        /** @type {?} */ (keyframesRule.transformedKeyframesName)\n      );\n    };\n  }\n\n  /**\n   * Transforms `@keyframes` names to be unique for the current host.\n   * Example: @keyframes foo-anim -> @keyframes foo-anim-x-foo-0\n   *\n   * @param {StyleNode} rule\n   * @param {string} scopeId\n   */\n  _scopeKeyframes(rule, scopeId) {\n    // Animation names are of the form [\\w-], so ensure that the name regex does not partially apply\n    // to similarly named keyframe names by checking for a word boundary at the beginning and\n    // a non-word boundary or `-` at the end.\n    rule.keyframesNameRx = new RegExp(\n      `\\\\b${rule['keyframesName']}(?!\\\\B|-)`,\n      'g'\n    );\n    rule.transformedKeyframesName = rule['keyframesName'] + '-' + scopeId;\n    rule.transformedSelector =\n      /** @type {?} */ (rule.transformedSelector) || rule['selector'];\n    rule['selector'] = /** @type {?} */ (rule.transformedSelector).replace(\n      rule['keyframesName'],\n      rule.transformedKeyframesName\n    );\n  }\n\n  // Strategy: x scope shim a selector e.g. to scope `.x-foo-42` (via classes):\n  // non-host selector: .a.x-foo -> .x-foo-42 .a.x-foo\n  // host selector: x-foo.wide -> .x-foo-42.wide\n  // note: we use only the scope class (.x-foo-42) and not the hostSelector\n  // (x-foo) to scope :host rules; this helps make property host rules\n  // have low specificity. They are overrideable by class selectors but,\n  // unfortunately, not by type selectors (e.g. overriding via\n  // `.special` is ok, but not by `x-foo`).\n  /**\n   * @param {StyleNode} rule\n   * @param {RegExp} hostRx\n   * @param {string} hostSelector\n   * @param {string} scopeId\n   */\n  _scopeSelector(rule, hostRx, hostSelector, scopeId) {\n    rule.transformedSelector =\n      /** @type {?} */ (rule.transformedSelector) || rule['selector'];\n    let selector = rule.transformedSelector;\n    let scope = '.' + scopeId;\n    let parts = StyleUtil.splitSelectorList(selector);\n    for (let i = 0, l = parts.length, p; i < l && (p = parts[i]); i++) {\n      parts[i] = p.match(hostRx)\n        ? p.replace(hostSelector, scope)\n        : scope + ' ' + p;\n    }\n    rule['selector'] = parts.join(',');\n  }\n\n  /**\n   * @param {Element} element\n   * @param {string} selector\n   * @param {string} old\n   */\n  applyElementScopeSelector(element, selector, old) {\n    let c = element.getAttribute('class') || '';\n    let v = c;\n    if (old) {\n      v = c.replace(\n        new RegExp('\\\\s*' + XSCOPE_NAME + '\\\\s*' + old + '\\\\s*', 'g'),\n        ' '\n      );\n    }\n    v += (v ? ' ' : '') + XSCOPE_NAME + ' ' + selector;\n    if (c !== v) {\n      StyleUtil.setElementClassRaw(element, v);\n    }\n  }\n\n  /**\n   * @param {HTMLElement} element\n   * @param {Object} properties\n   * @param {string} selector\n   * @param {HTMLStyleElement} style\n   * @return {HTMLStyleElement}\n   */\n  applyElementStyle(element, properties, selector, style) {\n    // calculate cssText to apply\n    let cssText = style\n      ? style.textContent || ''\n      : this.transformStyles(element, properties, selector);\n    // if shady and we have a cached style that is not style, decrement\n    let styleInfo = StyleInfo.get(element);\n    let s = styleInfo.customStyle;\n    if (s && !nativeShadow && s !== style) {\n      s['_useCount']--;\n      if (s['_useCount'] <= 0 && s.parentNode) {\n        s.parentNode.removeChild(s);\n      }\n    }\n    // apply styling always under native or if we generated style\n    // or the cached style is not in document(!)\n    if (nativeShadow) {\n      // update existing style only under native\n      if (styleInfo.customStyle) {\n        styleInfo.customStyle.textContent = cssText;\n        style = styleInfo.customStyle;\n        // otherwise, if we have css to apply, do so\n      } else if (cssText) {\n        // apply css after the scope style of the element to help with\n        // style precedence rules.\n        style = StyleUtil.applyCss(\n          cssText,\n          selector,\n          element.shadowRoot,\n          styleInfo.placeholder\n        );\n      }\n    } else {\n      // shady and no cache hit\n      if (!style) {\n        // apply css after the scope style of the element to help with\n        // style precedence rules.\n        if (cssText) {\n          style = StyleUtil.applyCss(\n            cssText,\n            selector,\n            null,\n            styleInfo.placeholder\n          );\n        }\n        // shady and cache hit but not in document\n      } else if (!style.parentNode) {\n        if (IS_IE && cssText.indexOf('@media') > -1) {\n          // @media rules may be stale in IE 10 and 11\n          // refresh the text content of the style to revalidate them.\n          style.textContent = cssText;\n        }\n        StyleUtil.applyStyle(style, null, styleInfo.placeholder);\n      }\n    }\n    // ensure this style is our custom style and increment its use count.\n    if (style) {\n      style['_useCount'] = style['_useCount'] || 0;\n      // increment use count if we changed styles\n      if (styleInfo.customStyle != style) {\n        style['_useCount']++;\n      }\n      styleInfo.customStyle = style;\n    }\n    return style;\n  }\n\n  /**\n   * @param {Element} style\n   * @param {Object} properties\n   */\n  applyCustomStyle(style, properties) {\n    let rules = StyleUtil.rulesForStyle(\n      /** @type {HTMLStyleElement} */ (style)\n    );\n    let self = this;\n    style.textContent = StyleUtil.toCssText(rules, function (\n      /** StyleNode */ rule\n    ) {\n      let css = (rule['cssText'] = rule['parsedCssText']);\n      if (\n        /** @type {?} */ (rule.propertyInfo) &&\n        /** @type {?} */ (rule.propertyInfo).cssText\n      ) {\n        // remove property assignments\n        // so next function isn't confused\n        // NOTE: we have 3 categories of css:\n        // (1) normal properties,\n        // (2) custom property assignments (--foo: red;),\n        // (3) custom property usage: border: var(--foo); @apply(--foo);\n        // In elements, 1 and 3 are separated for efficiency; here they\n        // are not and this makes this case unique.\n        css = removeCustomPropAssignment(/** @type {string} */ (css));\n        // replace with reified properties, scenario is same as mixin\n        rule['cssText'] = self.valueForProperties(css, properties);\n      }\n    });\n  }\n}\n\n/**\n * @param {number} n\n * @param {Array<number>} bits\n */\nfunction addToBitMask(n, bits) {\n  let o = parseInt(n / 32, 10);\n  let v = 1 << n % 32;\n  bits[o] = (bits[o] || 0) | v;\n}\n\nexport default new StyleProperties();\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nexport const nativeShadow = !(\n  window['ShadyDOM'] && window['ShadyDOM']['inUse']\n);\n/** @type {boolean} */\nlet nativeCssVariables_;\n\n/**\n * @param {(ShadyCSSOptions | ShadyCSSInterface)=} settings\n */\nfunction calcCssVariables(settings) {\n  if (settings && settings.shimcssproperties) {\n    nativeCssVariables_ = false;\n  } else {\n    // chrome 49 has semi-working css vars, check if box-shadow works\n    // safari 9.1 has a recalc bug: https://bugs.webkit.org/show_bug.cgi?id=155782\n    // However, shim css custom properties are only supported with ShadyDOM enabled,\n    // so fall back on native if we do not detect ShadyDOM\n    // Edge 15: custom properties used in ::before and ::after will also be used in the parent element\n    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/12414257/\n    nativeCssVariables_ =\n      nativeShadow ||\n      Boolean(\n        !navigator.userAgent.match(/AppleWebKit\\/601|Edge\\/15/) &&\n          window.CSS &&\n          CSS.supports &&\n          CSS.supports('box-shadow', '0 0 0 var(--foo)')\n      );\n  }\n}\n\n/** @type {string | undefined} */\nexport let cssBuild;\nif (window.ShadyCSS && window.ShadyCSS.cssBuild !== undefined) {\n  cssBuild = window.ShadyCSS.cssBuild;\n}\n\n/** @type {boolean} */\nexport const disableRuntime = Boolean(\n  window.ShadyCSS && window.ShadyCSS.disableRuntime\n);\n\nif (window.ShadyCSS && window.ShadyCSS.nativeCss !== undefined) {\n  nativeCssVariables_ = window.ShadyCSS.nativeCss;\n} else if (window.ShadyCSS) {\n  calcCssVariables(window.ShadyCSS);\n  // reset window variable to let ShadyCSS API take its place\n  window.ShadyCSS = undefined;\n} else {\n  calcCssVariables(window['WebComponents'] && window['WebComponents']['flags']);\n}\n\n// Hack for type error under new type inference which doesn't like that\n// nativeCssVariables is updated in a function and assigns the type\n// `function(): ?` instead of `boolean`.\nexport const nativeCssVariables = /** @type {boolean} */ (nativeCssVariables_);\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {StyleNode} from './css-parse.js'; // eslint-disable-line @typescript-eslint/no-unused-vars\nimport * as StyleUtil from './style-util.js';\nimport {nativeShadow} from './style-settings.js';\n\n/* Transforms ShadowDOM styling into ShadyDOM styling\n\n* scoping:\n\n  * elements in scope get scoping selector class=\"x-foo-scope\"\n  * selectors re-written as follows:\n\n    div button -> div.x-foo-scope button.x-foo-scope\n\n* :host -> scopeName\n\n* :host(...) -> scopeName...\n\n* ::slotted(...) -> scopeName > ...\n\n* ...:dir(ltr|rtl) -> [dir=\"ltr|rtl\"] ..., ...[dir=\"ltr|rtl\"]\n\n* :host(:dir[rtl]) -> scopeName:dir(rtl) -> [dir=\"rtl\"] scopeName, scopeName[dir=\"rtl\"]\n\n*/\nconst SCOPE_NAME = 'style-scope';\n\nclass StyleTransformer {\n  /** @return {string} */\n  get SCOPE_NAME() {\n    return SCOPE_NAME;\n  }\n  /**\n   * Given a node and scope name, add a scoping class to each node\n   * in the tree. This facilitates transforming css into scoped rules.\n   * @param {!Node} node\n   * @param {string} scope\n   * @param {boolean=} shouldRemoveScope\n   * @deprecated\n   */\n  dom(node, scope, shouldRemoveScope) {\n    const fn = (node) => {\n      this.element(node, scope || '', shouldRemoveScope);\n    };\n    this._transformDom(node, fn);\n  }\n\n  /**\n   * Given a node and scope name, add a scoping class to each node in the tree.\n   * @param {!Node} node\n   * @param {string} scope\n   */\n  domAddScope(node, scope) {\n    const fn = (node) => {\n      this.element(node, scope || '');\n    };\n    this._transformDom(node, fn);\n  }\n\n  /**\n   * @param {!Node} startNode\n   * @param {function(!Node)} transformer\n   */\n  _transformDom(startNode, transformer) {\n    if (startNode.nodeType === Node.ELEMENT_NODE) {\n      transformer(startNode);\n    }\n    let c$;\n    if (startNode.localName === 'template') {\n      const template = /** @type {!HTMLTemplateElement} */ (startNode);\n      // In case the template is in svg context, fall back to the node\n      // since it won't be an HTMLTemplateElement with a .content property\n      c$ = (template.content || template._content || template).childNodes;\n    } else {\n      c$ =\n        /** @type {!ParentNode} */ (startNode).children || startNode.childNodes;\n    }\n    if (c$) {\n      for (let i = 0; i < c$.length; i++) {\n        this._transformDom(c$[i], transformer);\n      }\n    }\n  }\n\n  /**\n   * @param {?} element\n   * @param {?} scope\n   * @param {?=} shouldRemoveScope\n   */\n  element(element, scope, shouldRemoveScope) {\n    // note: if using classes, we add both the general 'style-scope' class\n    // as well as the specific scope. This enables easy filtering of all\n    // `style-scope` elements\n    if (scope) {\n      // note: svg on IE does not have classList so fallback to class\n      if (element.classList) {\n        if (shouldRemoveScope) {\n          element.classList.remove(SCOPE_NAME);\n          element.classList.remove(scope);\n        } else {\n          element.classList.add(SCOPE_NAME);\n          element.classList.add(scope);\n        }\n      } else if (element.getAttribute) {\n        let c = element.getAttribute(CLASS);\n        if (shouldRemoveScope) {\n          if (c) {\n            let newValue = c.replace(SCOPE_NAME, '').replace(scope, '');\n            StyleUtil.setElementClassRaw(element, newValue);\n          }\n        } else {\n          let newValue = (c ? c + ' ' : '') + SCOPE_NAME + ' ' + scope;\n          StyleUtil.setElementClassRaw(element, newValue);\n        }\n      }\n    }\n  }\n\n  /**\n   * Given a node, replace the scoping class to each subnode in the tree.\n   * @param {!Node} node\n   * @param {string} oldScope\n   * @param {string} newScope\n   */\n  domReplaceScope(node, oldScope, newScope) {\n    const fn = (node) => {\n      this.element(node, oldScope, true);\n      this.element(node, newScope);\n    };\n    this._transformDom(node, fn);\n  }\n  /**\n   * Given a node, remove the scoping class to each subnode in the tree.\n   * @param {!Node} node\n   * @param {string} oldScope\n   */\n  domRemoveScope(node, oldScope) {\n    const fn = (node) => {\n      this.element(node, oldScope || '', true);\n    };\n    this._transformDom(node, fn);\n  }\n\n  /**\n   * @param {?} element\n   * @param {?} styleRules\n   * @param {?=} callback\n   * @param {string=} cssBuild\n   * @param {string=} cssText\n   * @return {string}\n   */\n  elementStyles(element, styleRules, callback, cssBuild = '', cssText = '') {\n    // no need to shim selectors if settings.useNativeShadow, also\n    // a shady css build will already have transformed selectors\n    // NOTE: This method may be called as part of static or property shimming.\n    // When there is a targeted build it will not be called for static shimming,\n    // but when the property shim is used it is called and should opt out of\n    // static shimming work when a proper build exists.\n    if (cssText === '') {\n      if (nativeShadow || cssBuild === 'shady') {\n        cssText = StyleUtil.toCssText(styleRules, callback);\n      } else {\n        let {is, typeExtension} = StyleUtil.getIsExtends(element);\n        cssText = this.css(styleRules, is, typeExtension, callback) + '\\n\\n';\n      }\n    }\n    return cssText.trim();\n  }\n\n  // Given a string of cssText and a scoping string (scope), returns\n  // a string of scoped css where each selector is transformed to include\n  // a class created from the scope. ShadowDOM selectors are also transformed\n  // (e.g. :host) to use the scoping selector.\n  css(rules, scope, ext, callback) {\n    let hostScope = this._calcHostScope(scope, ext);\n    scope = this._calcElementScope(scope);\n    let self = this;\n    return StyleUtil.toCssText(rules, function (/** StyleNode */ rule) {\n      if (!(/** @type {?} */ (rule.isScoped))) {\n        self.rule(rule, scope, hostScope);\n        rule.isScoped = true;\n      }\n      if (callback) {\n        callback(rule, scope, hostScope);\n      }\n    });\n  }\n\n  _calcElementScope(scope) {\n    if (scope) {\n      return CSS_CLASS_PREFIX + scope;\n    } else {\n      return '';\n    }\n  }\n\n  _calcHostScope(scope, ext) {\n    return ext ? `[is=${scope}]` : scope;\n  }\n\n  rule(rule, scope, hostScope) {\n    this._transformRule(rule, this._transformComplexSelector, scope, hostScope);\n  }\n\n  /**\n   * transforms a css rule to a scoped rule.\n   *\n   * @param {StyleNode} rule\n   * @param {Function} transformer\n   * @param {string=} scope\n   * @param {string=} hostScope\n   */\n  _transformRule(rule, transformer, scope, hostScope) {\n    // NOTE: save transformedSelector for subsequent matching of elements\n    // against selectors (e.g. when calculating style properties)\n    rule[\n      'selector'\n    ] = /** @type {?} */ (rule).transformedSelector = this._transformRuleCss(\n      rule,\n      transformer,\n      scope,\n      hostScope\n    );\n  }\n\n  /**\n   * @param {StyleNode} rule\n   * @param {Function} transformer\n   * @param {string=} scope\n   * @param {string=} hostScope\n   */\n  _transformRuleCss(rule, transformer, scope, hostScope) {\n    let p$ = StyleUtil.splitSelectorList(rule['selector']);\n    // we want to skip transformation of rules that appear in keyframes,\n    // because they are keyframe selectors, not element selectors.\n    if (!StyleUtil.isKeyframesSelector(rule)) {\n      for (let i = 0, l = p$.length, p; i < l && (p = p$[i]); i++) {\n        p$[i] = transformer.call(this, p, scope, hostScope);\n      }\n    }\n    return p$.filter((part) => Boolean(part)).join(COMPLEX_SELECTOR_SEP);\n  }\n\n  /**\n   * @param {string} selector\n   * @return {string}\n   */\n  _twiddleNthPlus(selector) {\n    return selector.replace(NTH, (m, type, inside) => {\n      if (inside.indexOf('+') > -1) {\n        inside = inside.replace(/\\+/g, '___');\n      } else if (inside.indexOf('___') > -1) {\n        inside = inside.replace(/___/g, '+');\n      }\n      return `:${type}(${inside})`;\n    });\n  }\n\n  /**\n   * Preserve `:matches()` selectors by replacing them with MATCHES_REPLACMENT\n   * and returning an array of `:matches()` selectors.\n   * Use `_replacesMatchesPseudo` to replace the `:matches()` parts\n   *\n   * @param {string} selector\n   * @return {{selector: string, matches: !Array<string>}}\n   */\n  _preserveMatchesPseudo(selector) {\n    /** @type {!Array<string>} */\n    const matches = [];\n    let match;\n    while ((match = selector.match(MATCHES))) {\n      const start = match.index;\n      const end = StyleUtil.findMatchingParen(selector, start);\n      if (end === -1) {\n        throw new Error(`${match.input} selector missing ')'`);\n      }\n      const part = selector.slice(start, end + 1);\n      selector = selector.replace(part, MATCHES_REPLACEMENT);\n      matches.push(part);\n    }\n    return {selector, matches};\n  }\n\n  /**\n   * Replace MATCHES_REPLACMENT character with the given set of `:matches()`\n   * selectors.\n   *\n   * @param {string} selector\n   * @param {!Array<string>} matches\n   * @return {string}\n   */\n  _replaceMatchesPseudo(selector, matches) {\n    const parts = selector.split(MATCHES_REPLACEMENT);\n    return matches.reduce(\n      (acc, cur, idx) => acc + cur + parts[idx + 1],\n      parts[0]\n    );\n  }\n\n  /**\n   * @param {string} selector\n   * @param {string} scope\n   * @param {string=} hostScope\n   */\n  _transformComplexSelector(selector, scope, hostScope) {\n    let stop = false;\n    selector = selector.trim();\n    // Remove spaces inside of selectors like `:nth-of-type` because it confuses SIMPLE_SELECTOR_SEP\n    let isNth = NTH.test(selector);\n    if (isNth) {\n      selector = selector.replace(\n        NTH,\n        (m, type, inner) => `:${type}(${inner.replace(/\\s/g, '')})`\n      );\n      selector = this._twiddleNthPlus(selector);\n    }\n    // Preserve selectors like `:-webkit-any` so that SIMPLE_SELECTOR_SEP does\n    // not get confused by spaces inside the pseudo selector\n    const isMatches = MATCHES.test(selector);\n    /** @type {!Array<string>} */\n    let matches;\n    if (isMatches) {\n      ({selector, matches} = this._preserveMatchesPseudo(selector));\n    }\n    selector = selector.replace(SLOTTED_START, `${HOST} $1`);\n    selector = selector.replace(SIMPLE_SELECTOR_SEP, (m, c, s) => {\n      if (!stop) {\n        let info = this._transformCompoundSelector(s, c, scope, hostScope);\n        stop = stop || info.stop;\n        c = info.combinator;\n        s = info.value;\n      }\n      return c + s;\n    });\n    // replace `:matches()` selectors\n    if (isMatches) {\n      selector = this._replaceMatchesPseudo(selector, matches);\n    }\n    if (isNth) {\n      selector = this._twiddleNthPlus(selector);\n    }\n    selector = selector.replace(\n      DIR_PAREN,\n      (m, before, dir, after) =>\n        `[dir=\"${dir}\"] ${before}${after}, ${before}[dir=\"${dir}\"]${after}`\n    );\n    return selector;\n  }\n\n  _transformCompoundSelector(selector, combinator, scope, hostScope) {\n    // replace :host with host scoping class\n    let slottedIndex = selector.indexOf(SLOTTED);\n    if (selector.indexOf(HOST) >= 0) {\n      selector = this._transformHostSelector(selector, hostScope);\n      // replace other selectors with scoping class\n    } else if (slottedIndex !== 0) {\n      selector = scope\n        ? this._transformSimpleSelector(selector, scope)\n        : selector;\n    }\n    // mark ::slotted() scope jump to replace with descendant selector + arg\n    // also ignore left-side combinator\n    let slotted = false;\n    if (slottedIndex >= 0) {\n      combinator = '';\n      slotted = true;\n    }\n    // process scope jumping selectors up to the scope jump and then stop\n    let stop;\n    if (slotted) {\n      stop = true;\n      if (slotted) {\n        // .zonk ::slotted(.foo) -> .zonk.scope > .foo\n        selector = selector.replace(SLOTTED_PAREN, (m, paren) => ` > ${paren}`);\n      }\n    }\n    return {value: selector, combinator, stop};\n  }\n\n  _transformSimpleSelector(selector, scope) {\n    const attributes = selector.split(/(\\[.+?\\])/);\n\n    const output = [];\n    for (let i = 0; i < attributes.length; i++) {\n      // Do not attempt to transform any attribute selector content\n      if (i % 2 === 1) {\n        output.push(attributes[i]);\n      } else {\n        const part = attributes[i];\n\n        if (!(part === '' && i === attributes.length - 1)) {\n          let p$ = part.split(PSEUDO_PREFIX);\n          p$[0] += scope;\n          output.push(p$.join(PSEUDO_PREFIX));\n        }\n      }\n    }\n\n    return output.join('');\n  }\n\n  // :host(...) -> scopeName...\n  _transformHostSelector(selector, hostScope) {\n    let m = selector.match(HOST_PAREN);\n    let paren = (m && m[2].trim()) || '';\n    if (paren) {\n      if (!paren[0].match(SIMPLE_SELECTOR_PREFIX)) {\n        // paren starts with a type selector\n        let typeSelector = paren.split(SIMPLE_SELECTOR_PREFIX)[0];\n        // if the type selector is our hostScope then avoid pre-pending it\n        if (typeSelector === hostScope) {\n          return paren;\n        }\n        // otherwise, this selector should not match in this scope so\n        // output a bogus selector.\n        else {\n          return SELECTOR_NO_MATCH;\n        }\n      } else {\n        // make sure to do a replace here to catch selectors like:\n        // `:host(.foo)::before`\n        return selector.replace(HOST_PAREN, function (m, host, paren) {\n          return hostScope + paren;\n        });\n      }\n    }\n    // if no paren, do a straight :host replacement.\n    // TODO(sorvell): this should not strictly be necessary but\n    // it's needed to maintain support for `:host[foo]` type selectors\n    // which have been improperly used under Shady DOM. This should be\n    // deprecated.\n    else {\n      return selector.replace(HOST, hostScope);\n    }\n  }\n\n  /**\n   * @param {StyleNode} rule\n   */\n  documentRule(rule) {\n    // reset selector in case this is redone.\n    rule['selector'] = rule['parsedSelector'];\n    this.normalizeRootSelector(rule);\n    this._transformRule(rule, this._transformDocumentSelector);\n  }\n\n  /**\n   * @param {StyleNode} rule\n   */\n  normalizeRootSelector(rule) {\n    if (rule['selector'] === ROOT) {\n      rule['selector'] = 'html';\n    }\n  }\n\n  /**\n   * @param {string} selector\n   */\n  _transformDocumentSelector(selector) {\n    if (selector.match(HOST)) {\n      // remove ':host' type selectors in document rules\n      return '';\n    } else if (selector.match(SLOTTED)) {\n      return this._transformComplexSelector(selector, SCOPE_DOC_SELECTOR);\n    } else {\n      return this._transformSimpleSelector(selector.trim(), SCOPE_DOC_SELECTOR);\n    }\n  }\n}\n\nconst NTH = /:(nth[-\\w]+)\\(([^)]+)\\)/;\nconst SCOPE_DOC_SELECTOR = `:not(.${SCOPE_NAME})`;\nconst COMPLEX_SELECTOR_SEP = ',';\nconst SIMPLE_SELECTOR_SEP = /(^|[\\s>+~]+)((?:\\[.+?\\]|[^\\s>+~=[])+)/g;\nconst SIMPLE_SELECTOR_PREFIX = /[[.:#*]/;\nconst HOST = ':host';\nconst ROOT = ':root';\nconst SLOTTED = '::slotted';\nconst SLOTTED_START = new RegExp(`^(${SLOTTED})`);\n// NOTE: this supports 1 nested () pair for things like\n// :host(:not([selected]), more general support requires\n// parsing which seems like overkill\nconst HOST_PAREN = /(:host)(?:\\(((?:\\([^)(]*\\)|[^)(]*)+?)\\))/;\n// similar to HOST_PAREN\nconst SLOTTED_PAREN = /(?:::slotted)(?:\\(((?:\\([^)(]*\\)|[^)(]*)+?)\\))/;\nconst DIR_PAREN = /(.*):dir\\((?:(ltr|rtl))\\)(.*)/;\nconst CSS_CLASS_PREFIX = '.';\nconst PSEUDO_PREFIX = ':';\nconst CLASS = 'class';\nconst SELECTOR_NO_MATCH = 'should_not_match';\nconst MATCHES = /:(?:matches|any|-(?:webkit|moz)-any)/;\nconst MATCHES_REPLACEMENT = '\\u{e000}';\n\nexport default new StyleTransformer();\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {nativeShadow, nativeCssVariables, cssBuild} from './style-settings.js';\nimport {parse, stringify, types, StyleNode} from './css-parse.js'; // eslint-disable-line @typescript-eslint/no-unused-vars\nimport {MEDIA_MATCH} from './common-regex.js';\n// prettier-ignore\nimport {processUnscopedStyle, isUnscopedStyle} from './unscoped-style-handler.js';\n\n/**\n * @param {string|StyleNode} rules\n * @param {function(StyleNode)=} callback\n * @return {string}\n */\nexport function toCssText(rules, callback) {\n  if (!rules) {\n    return '';\n  }\n  if (typeof rules === 'string') {\n    rules = parse(rules);\n  }\n  if (callback) {\n    forEachRule(rules, callback);\n  }\n  return stringify(rules, nativeCssVariables);\n}\n\n/**\n * @param {HTMLStyleElement} style\n * @return {StyleNode}\n */\nexport function rulesForStyle(style) {\n  if (!style['__cssRules'] && style.textContent) {\n    style['__cssRules'] = parse(style.textContent);\n  }\n  return style['__cssRules'] || null;\n}\n\n// Tests if a rule is a keyframes selector, which looks almost exactly\n// like a normal selector but is not (it has nothing to do with scoping\n// for example).\n/**\n * @param {StyleNode} rule\n * @return {boolean}\n */\nexport function isKeyframesSelector(rule) {\n  return (\n    Boolean(rule['parent']) && rule['parent']['type'] === types.KEYFRAMES_RULE\n  );\n}\n\n/**\n * @param {StyleNode} node\n * @param {Function=} styleRuleCallback\n * @param {Function=} keyframesRuleCallback\n * @param {boolean=} onlyActiveRules\n */\nexport function forEachRule(\n  node,\n  styleRuleCallback,\n  keyframesRuleCallback,\n  onlyActiveRules\n) {\n  if (!node) {\n    return;\n  }\n  let skipRules = false;\n  let type = node['type'];\n  if (onlyActiveRules) {\n    if (type === types.MEDIA_RULE) {\n      let matchMedia = node['selector'].match(MEDIA_MATCH);\n      if (matchMedia) {\n        // if rule is a non matching @media rule, skip subrules\n        if (!window.matchMedia(matchMedia[1]).matches) {\n          skipRules = true;\n        }\n      }\n    }\n  }\n  if (type === types.STYLE_RULE) {\n    styleRuleCallback(node);\n  } else if (keyframesRuleCallback && type === types.KEYFRAMES_RULE) {\n    keyframesRuleCallback(node);\n  } else if (type === types.MIXIN_RULE) {\n    skipRules = true;\n  }\n  let r$ = node['rules'];\n  if (r$ && !skipRules) {\n    for (let i = 0, l = r$.length, r; i < l && (r = r$[i]); i++) {\n      forEachRule(r, styleRuleCallback, keyframesRuleCallback, onlyActiveRules);\n    }\n  }\n}\n\n// add a string of cssText to the document.\n/**\n * @param {string} cssText\n * @param {string} moniker\n * @param {Node} target\n * @param {Node} contextNode\n * @return {HTMLStyleElement}\n */\nexport function applyCss(cssText, moniker, target, contextNode) {\n  let style = createScopeStyle(cssText, moniker);\n  applyStyle(style, target, contextNode);\n  return style;\n}\n\n/**\n * @param {string} cssText\n * @param {string} moniker\n * @return {!HTMLStyleElement}\n */\nexport function createScopeStyle(cssText, moniker) {\n  let style = /** @type {HTMLStyleElement} */ (document.createElement('style'));\n  if (moniker) {\n    style.setAttribute('scope', moniker);\n  }\n  style.textContent = cssText;\n  return style;\n}\n\n/**\n * Track the position of the last added style for placing placeholders\n * @type {Node}\n */\nlet lastHeadApplyNode = null;\n\n// insert a comment node as a styling position placeholder.\n/**\n * @param {string} moniker\n * @return {!Comment}\n */\nexport function applyStylePlaceHolder(moniker) {\n  let placeHolder = document.createComment(\n    ' Shady DOM styles for ' + moniker + ' '\n  );\n  let after = lastHeadApplyNode ? lastHeadApplyNode['nextSibling'] : null;\n  let scope = document.head;\n  scope.insertBefore(placeHolder, after || scope.firstChild);\n  lastHeadApplyNode = placeHolder;\n  return placeHolder;\n}\n\n/**\n * @param {HTMLStyleElement} style\n * @param {?Node} target\n * @param {?Node} contextNode\n */\nexport function applyStyle(style, target, contextNode) {\n  target = target || document.head;\n  let after = (contextNode && contextNode.nextSibling) || target.firstChild;\n  target.insertBefore(style, after);\n  if (!lastHeadApplyNode) {\n    lastHeadApplyNode = style;\n  } else {\n    // only update lastHeadApplyNode if the new style is inserted after the old lastHeadApplyNode\n    let position = style.compareDocumentPosition(lastHeadApplyNode);\n    if (position === Node.DOCUMENT_POSITION_PRECEDING) {\n      lastHeadApplyNode = style;\n    }\n  }\n}\n\n/**\n * @param {string} buildType\n * @return {boolean}\n */\nexport function isTargetedBuild(buildType) {\n  return nativeShadow ? buildType === 'shadow' : buildType === 'shady';\n}\n\n/**\n * Walk from text[start] matching parens and\n * returns position of the outer end paren\n * @param {string} text\n * @param {number} start\n * @return {number}\n */\nexport function findMatchingParen(text, start) {\n  let level = 0;\n  for (let i = start, l = text.length; i < l; i++) {\n    if (text[i] === '(') {\n      level++;\n    } else if (text[i] === ')') {\n      if (--level === 0) {\n        return i;\n      }\n    }\n  }\n  return -1;\n}\n\n/**\n * @param {string} str\n * @param {function(string, string, string, string)} callback\n */\nexport function processVariableAndFallback(str, callback) {\n  // find 'var('\n  let start = str.indexOf('var(');\n  if (start === -1) {\n    // no var?, everything is prefix\n    return callback(str, '', '', '');\n  }\n  //${prefix}var(${inner})${suffix}\n  let end = findMatchingParen(str, start + 3);\n  let inner = str.substring(start + 4, end);\n  let prefix = str.substring(0, start);\n  // suffix may have other variables\n  let suffix = processVariableAndFallback(str.substring(end + 1), callback);\n  let comma = inner.indexOf(',');\n  // value and fallback args should be trimmed to match in property lookup\n  if (comma === -1) {\n    // variable, no fallback\n    return callback(prefix, inner.trim(), '', suffix);\n  }\n  // var(${value},${fallback})\n  let value = inner.substring(0, comma).trim();\n  let fallback = inner.substring(comma + 1).trim();\n  return callback(prefix, value, fallback, suffix);\n}\n\n/**\n * @param {Element} element\n * @param {string} value\n */\nexport function setElementClassRaw(element, value) {\n  // use native setAttribute provided by ShadyDOM when setAttribute is patched\n  if (nativeShadow) {\n    element.setAttribute('class', value);\n  } else {\n    window['ShadyDOM']['nativeMethods']['setAttribute'].call(\n      element,\n      'class',\n      value\n    );\n  }\n}\n\n/**\n * @type {function(*):*}\n */\nexport const wrap =\n  (window['ShadyDOM'] && window['ShadyDOM']['wrap']) || ((node) => node);\n\n/**\n * @param {Element | {is: string, extends: string}} element\n * @return {{is: string, typeExtension: string}}\n */\nexport function getIsExtends(element) {\n  let localName = element['localName'];\n  let is = '',\n    typeExtension = '';\n  /*\n  NOTE: technically, this can be wrong for certain svg elements\n  with `-` in the name like `<font-face>`\n  */\n  if (localName) {\n    if (localName.indexOf('-') > -1) {\n      is = localName;\n    } else {\n      typeExtension = localName;\n      is = (element.getAttribute && element.getAttribute('is')) || '';\n    }\n  } else {\n    is = /** @type {?} */ (element).is;\n    typeExtension = /** @type {?} */ (element).extends;\n  }\n  return {is, typeExtension};\n}\n\n/**\n * @param {Element|DocumentFragment} element\n * @return {string}\n */\nexport function gatherStyleText(element) {\n  /** @type {!Array<string>} */\n  const styleTextParts = [];\n  const styles = /** @type {!NodeList<!HTMLStyleElement>} */ (element.querySelectorAll(\n    'style'\n  ));\n  for (let i = 0; i < styles.length; i++) {\n    const style = styles[i];\n    if (isUnscopedStyle(style)) {\n      if (!nativeShadow) {\n        processUnscopedStyle(style);\n        style.parentNode.removeChild(style);\n      }\n    } else {\n      styleTextParts.push(style.textContent);\n      style.parentNode.removeChild(style);\n    }\n  }\n  return styleTextParts.join('').trim();\n}\n\n/**\n * Split a selector separated by commas into an array in a smart way\n * @param {string} selector\n * @return {!Array<string>}\n */\nexport function splitSelectorList(selector) {\n  const parts = [];\n  let part = '';\n  for (let i = 0; i >= 0 && i < selector.length; i++) {\n    // A selector with parentheses will be one complete part\n    if (selector[i] === '(') {\n      // find the matching paren\n      const end = findMatchingParen(selector, i);\n      // push the paren block into the part\n      part += selector.slice(i, end + 1);\n      // move the index to after the paren block\n      i = end;\n    } else if (selector[i] === ',') {\n      parts.push(part);\n      part = '';\n    } else {\n      part += selector[i];\n    }\n  }\n  // catch any pieces after the last comma\n  if (part) {\n    parts.push(part);\n  }\n  return parts;\n}\n\nconst CSS_BUILD_ATTR = 'css-build';\n\n/**\n * Return the polymer-css-build \"build type\" applied to this element\n *\n * @param {!HTMLElement} element\n * @return {string} Can be \"\", \"shady\", or \"shadow\"\n */\nexport function getCssBuild(element) {\n  if (cssBuild !== undefined) {\n    return /** @type {string} */ (cssBuild);\n  }\n  if (element.__cssBuild === undefined) {\n    // try attribute first, as it is the common case\n    const attrValue = element.getAttribute(CSS_BUILD_ATTR);\n    if (attrValue) {\n      element.__cssBuild = attrValue;\n    } else {\n      const buildComment = getBuildComment(element);\n      if (buildComment !== '') {\n        // remove build comment so it is not needlessly copied into every element instance\n        removeBuildComment(element);\n      }\n      element.__cssBuild = buildComment;\n    }\n  }\n  return element.__cssBuild || '';\n}\n\n/**\n * Check if the given element, either a <template> or <style>, has been processed\n * by polymer-css-build.\n *\n * If so, then we can make a number of optimizations:\n * - polymer-css-build will decompose mixins into individual CSS Custom Properties,\n * so the ApplyShim can be skipped entirely.\n * - Under native ShadowDOM, the style text can just be copied into each instance\n * without modification\n * - If the build is \"shady\" and ShadyDOM is in use, the styling does not need\n * scoping beyond the shimming of CSS Custom Properties\n *\n * @param {!HTMLElement} element\n * @return {boolean}\n */\nexport function elementHasBuiltCss(element) {\n  return getCssBuild(element) !== '';\n}\n\n/**\n * For templates made with tagged template literals, polymer-css-build will\n * insert a comment of the form `<!--css-build:shadow-->`\n *\n * @param {!HTMLElement} element\n * @return {string}\n */\nexport function getBuildComment(element) {\n  const buildComment =\n    element.localName === 'template'\n      ? /** @type {!HTMLTemplateElement} */ (element).content.firstChild\n      : element.firstChild;\n  if (buildComment instanceof Comment) {\n    const commentParts = buildComment.textContent.trim().split(':');\n    if (commentParts[0] === CSS_BUILD_ATTR) {\n      return commentParts[1];\n    }\n  }\n  return '';\n}\n\n/**\n * Check if the css build status is optimal, and do no unneeded work.\n *\n * @param {string=} cssBuild CSS build status\n * @return {boolean} css build is optimal or not\n */\nexport function isOptimalCssBuild(cssBuild = '') {\n  // CSS custom property shim always requires work\n  if (cssBuild === '' || !nativeCssVariables) {\n    return false;\n  }\n  return nativeShadow ? cssBuild === 'shadow' : cssBuild === 'shady';\n}\n\n/**\n * @param {!HTMLElement} element\n */\nfunction removeBuildComment(element) {\n  const buildComment =\n    element.localName === 'template'\n      ? /** @type {!HTMLTemplateElement} */ (element).content.firstChild\n      : element.firstChild;\n  buildComment.parentNode.removeChild(buildComment);\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\n/**\n * @const {!Object<string, !HTMLTemplateElement>}\n */\nconst templateMap = {};\nexport default templateMap;\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\n/** @type {!Set<string>} */\nconst styleTextSet = new Set();\n\nexport const scopingAttribute = 'shady-unscoped';\n\n/**\n * Add a specifically-marked style to the document directly, and only one copy of that style.\n *\n * @param {!HTMLStyleElement} style\n * @return {undefined}\n */\nexport function processUnscopedStyle(style) {\n  const text = style.textContent;\n  if (!styleTextSet.has(text)) {\n    styleTextSet.add(text);\n    const newStyle = document.createElement('style');\n    newStyle.setAttribute('shady-unscoped', '');\n    newStyle.textContent = text;\n    document.head.appendChild(newStyle);\n  }\n}\n\n/**\n * Check if a style is supposed to be unscoped\n * @param {!HTMLStyleElement} style\n * @return {boolean} true if the style has the unscoping attribute\n */\nexport function isUnscopedStyle(style) {\n  return style.hasAttribute(scopingAttribute);\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nexport class ShadyData {\n  /** @override */\n  toJSON() {\n    return {};\n  }\n}\n\nexport function ensureShadyDataForNode(node) {\n  if (!node.__shady) {\n    node.__shady = new ShadyData();\n  }\n  return node.__shady;\n}\n\nexport function shadyDataForNode(node) {\n  return node && node.__shady;\n}\n",null,null,null,null,null,"/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\nimport {shadyDataForNode} from './shady-data.js';\n\n/** @type {!Object} */\nexport const settings = window['ShadyDOM'] || {};\n\nsettings.hasNativeShadowDOM = Boolean(\n  Element.prototype.attachShadow && Node.prototype.getRootNode\n);\n\n// The user might need to pass the custom elements polyfill a flag by setting an\n// object to `customElements`, so check for `customElements.define` also.\nexport const hasCustomElements = () =>\n  Boolean(window.customElements && window.customElements.define);\n// The custom elements polyfill is typically loaded after Shady DOM, so this\n// check isn't reliable during initial evaluation. However, because the\n// polyfills are loaded immediately after one another, it works at runtime.\nexport const hasPolyfilledCustomElements = () =>\n  Boolean(\n    window.customElements && window.customElements['polyfillWrapFlushCallback']\n  );\n\nconst desc = Object.getOwnPropertyDescriptor(Node.prototype, 'firstChild');\n\nsettings.hasDescriptors = Boolean(desc && desc.configurable && desc.get);\nsettings.inUse = settings['force'] || !settings.hasNativeShadowDOM;\nsettings.noPatch = /** @type {string|boolean} */ (settings['noPatch'] || false);\n// eslint-disable-next-line no-self-assign\nsettings.preferPerformance = settings['preferPerformance'];\nsettings.patchOnDemand = settings.noPatch === 'on-demand';\nsettings.querySelectorImplementation = (() => {\n  const acceptedValues = ['native', 'selectorEngine'];\n  const userValue = settings['querySelectorImplementation'];\n  if (acceptedValues.indexOf(userValue) > -1) {\n    return userValue;\n  }\n  return undefined;\n})();\n\nconst IS_IE = navigator.userAgent.match('Trident');\nsettings.IS_IE = IS_IE;\n\n// Helper for prefixed properties.\nexport const getPropertyName = (obj, name) => {\n  const prefixed = `ms${name[0].toUpperCase() + name.slice(1)}`;\n  return obj[prefixed] ? prefixed : name;\n};\n\nexport const canUpgrade = () => !settings.IS_IE;\n\nexport const isTrackingLogicalChildNodes = (node) => {\n  const nodeData = shadyDataForNode(node);\n  return nodeData && nodeData.firstChild !== undefined;\n};\n\nexport const isShadyRoot = (obj) => obj instanceof ShadowRoot;\n\nexport const hasShadowRootWithSlot = (node) => {\n  const nodeData = shadyDataForNode(node);\n  let root = nodeData && nodeData.root;\n  return root && root._hasInsertionPoint();\n};\n\nlet p = Element.prototype;\nlet matches =\n  p.matches ||\n  p.matchesSelector ||\n  p.mozMatchesSelector ||\n  p.msMatchesSelector ||\n  p.oMatchesSelector ||\n  p.webkitMatchesSelector;\n\nexport const matchesSelector = (element, selector) => {\n  return matches.call(element, selector);\n};\n\nexport const mixin = (target, source) => {\n  for (var i in source) {\n    target[i] = source[i];\n  }\n  return target;\n};\n\n// NOTE, prefer MutationObserver over Promise for microtask timing\n// for consistency x-platform.\nlet twiddle = document.createTextNode('');\nlet content = 0;\nlet queue = [];\nnew MutationObserver(() => {\n  while (queue.length) {\n    // catch errors in user code...\n    try {\n      queue.shift()();\n    } catch (e) {\n      // enqueue another record and throw\n      twiddle.textContent = content++;\n      throw e;\n    }\n  }\n}).observe(twiddle, {characterData: true});\n\n// use MutationObserver to get microtask async timing.\nexport const microtask = (callback) => {\n  queue.push(callback);\n  twiddle.textContent = content++;\n};\n\n/** @type {function(!Document, !Node): boolean} */\nexport const documentContains = (() => {\n  if (document.contains) {\n    return (doc, node) => doc[NATIVE_PREFIX + 'contains'](node);\n  } else {\n    return (doc, node) =>\n      doc === node ||\n      (doc.documentElement &&\n        doc.documentElement[NATIVE_PREFIX + 'contains'](node));\n  }\n})();\n\nexport const contains = (container, node) => {\n  while (node) {\n    if (node == container) {\n      return true;\n    }\n    node = node[SHADY_PREFIX + 'parentNode'];\n  }\n  return false;\n};\n\nconst getNodeHTMLCollectionName = (node) =>\n  node.getAttribute('id') || node.getAttribute('name');\n\nconst isValidHTMLCollectionName = (name) => name !== 'length' && isNaN(name);\n\nexport const createPolyfilledHTMLCollection = (nodes) => {\n  // Note: loop in reverse so that the first named item matches the named property\n  for (let l = nodes.length - 1; l >= 0; l--) {\n    const node = nodes[l];\n    const name = getNodeHTMLCollectionName(node);\n\n    if (name && isValidHTMLCollectionName(name)) {\n      nodes[name] = node;\n    }\n  }\n  nodes.item = function (index) {\n    return nodes[index];\n  };\n  nodes.namedItem = function (name) {\n    if (isValidHTMLCollectionName(name) && nodes[name]) {\n      return nodes[name];\n    }\n\n    for (const node of nodes) {\n      const nodeName = getNodeHTMLCollectionName(node);\n\n      if (nodeName == name) {\n        return node;\n      }\n    }\n\n    return null;\n  };\n  return nodes;\n};\n\nexport const NATIVE_PREFIX = '__shady_native_';\nexport const SHADY_PREFIX = '__shady_';\n\nexport const nativeChildNodesArray = (parent) => {\n  const result = [];\n  for (\n    let n = parent[NATIVE_PREFIX + 'firstChild'];\n    n;\n    n = n[NATIVE_PREFIX + 'nextSibling']\n  ) {\n    result.push(n);\n  }\n  return result;\n};\n\nexport const childNodesArray = (parent) => {\n  const result = [];\n  for (\n    let n = parent[SHADY_PREFIX + 'firstChild'];\n    n;\n    n = n[SHADY_PREFIX + 'nextSibling']\n  ) {\n    result.push(n);\n  }\n  return result;\n};\n\nconst patchProperty = (proto, name, descriptor) => {\n  descriptor.configurable = true;\n  // NOTE: we prefer writing directly because some browsers\n  // have descriptors that are writable but not configurable (e.g.\n  // `appendChild` on older browsers)\n  if (descriptor.value) {\n    proto[name] = descriptor.value;\n  } else {\n    try {\n      Object.defineProperty(proto, name, descriptor);\n    } catch (e) {\n      // this error is harmless so we just trap it.\n    }\n  }\n};\n\n/**\n * Patch a group of accessors on an object. By default this overrides\n * @param {!Object} proto\n * @param {!Object} descriptors\n * @param {string=} prefix\n * @param {Array=} disallowedPatches\n */\nexport const patchProperties = (\n  proto,\n  descriptors,\n  prefix = '',\n  disallowedPatches\n) => {\n  for (let name in descriptors) {\n    if (disallowedPatches && disallowedPatches.indexOf(name) >= 0) {\n      continue;\n    }\n    patchProperty(proto, prefix + name, descriptors[name]);\n  }\n};\n\nexport const patchExistingProperties = (proto, descriptors) => {\n  for (let name in descriptors) {\n    if (name in proto) {\n      patchProperty(proto, name, descriptors[name]);\n    }\n  }\n};\n\n// note, this is not a perfect polyfill since it doesn't include symbols\n/** @return {!Object<!ObjectPropertyDescriptor>} */\nexport const getOwnPropertyDescriptors = (obj) => {\n  const descriptors = {};\n  Object.getOwnPropertyNames(obj).forEach((name) => {\n    descriptors[name] = Object.getOwnPropertyDescriptor(obj, name);\n  });\n  return descriptors;\n};\n\nexport const assign = (target, source) => {\n  const names = Object.getOwnPropertyNames(source);\n  for (let i = 0, p; i < names.length; i++) {\n    p = names[i];\n    target[p] = source[p];\n  }\n};\n\nexport const arrayFrom = (object) => {\n  return [].slice.call(/** @type {IArrayLike} */ (object));\n};\n\n/**\n * Converts a single value to a node for `convertNodesIntoANode`.\n *\n * @param {*} arg\n * @return {!Node}\n */\nconst convertIntoANode = (arg) => {\n  // `\"\" + arg` is used to implicitly coerce the value to a string (coercing a\n  // symbol *should* fail here) before passing to `createTextNode`, which has\n  // argument type `(number|string)`.\n  return !(arg instanceof Node) ? document.createTextNode('' + arg) : arg;\n};\n\n/**\n * Implements 'convert nodes into a node'. The spec text indicates that strings\n * become text nodes, but doesn't describe what should happen if a non-Node,\n * non-string value is found in the arguments list. In practice, browsers coerce\n * these values to strings and convert those to text nodes.\n * https://dom.spec.whatwg.org/#converting-nodes-into-a-node\n *\n * @param {...*} args\n * @return {!Node}\n */\nexport const convertNodesIntoANode = (...args) => {\n  if (args.length === 1) {\n    return convertIntoANode(args[0]);\n  }\n\n  const fragment = document.createDocumentFragment();\n  for (const arg of args) {\n    fragment.appendChild(convertIntoANode(arg));\n  }\n  return fragment;\n};\n\n/**\n * Equivalent to `Array.prototype.flat`. Closure does not compile out this\n * function, so we need an implementation for browsers that don't natively\n * support it.\n *\n * @template T\n * @param {!Array<!T | !Array<!T>>} array\n * @param {number} depth\n * @return {!Array<!T>}\n */\nexport const flat = (array, depth = 1) => {\n  for (; depth > 0; depth--) {\n    array = array.reduce((acc, item) => {\n      if (Array.isArray(item)) {\n        acc.push(...item);\n      } else {\n        acc.push(item);\n      }\n      return acc;\n    }, []);\n  }\n\n  return array;\n};\n\n/**\n * Deduplicates items in an array.\n *\n * This function could normally be implemented as merely `Array.from(new\n * Set(...))`. However, in IE 11, `Set` does not support being constructed with\n * an iterable. Further, some polyfills for `Array.from` effectively default to\n * `Array.prototype.slice.call(...)` when they are unable to find\n * `[Symbol.iterator]`; this is incompatible with `Set` which has no `length` or\n * indexable properties.\n *\n * @template T\n * @param {!Array<!T>} array\n * @return {!Array<!T>}\n */\nexport const deduplicate = (array) => {\n  const results = [];\n  const set = new Set();\n  for (const item of array) {\n    if (!set.has(item)) {\n      results.push(item);\n      set.add(item);\n    }\n  }\n  return results;\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\nimport * as utils from './utils.js';\nimport {patchProperties} from './utils.js';\nimport {getInnerHTML} from './innerHTML.js';\n\nconst hasDescriptors = utils.settings.hasDescriptors;\nexport const NATIVE_PREFIX = utils.NATIVE_PREFIX;\n\n// Object on which raw native methods are stored.\n// e.g. `nativeMethods.querySelector.call(node, selector)`\n// same as `node.querySelector(selector)`\nexport const nativeMethods = {\n  /** @this {Element} */\n  querySelector(selector) {\n    return this[NATIVE_PREFIX + 'querySelector'](selector);\n  },\n  /** @this {Element} */\n  querySelectorAll(selector) {\n    return this[NATIVE_PREFIX + 'querySelectorAll'](selector);\n  },\n};\n// Object on which raw native accessors are available via `accessorName(node)`.\n// e.g. `nativeTree.firstChild(node)`\n// same as `node.firstChild`\nexport const nativeTree = {};\n\nconst installNativeAccessor = (name) => {\n  nativeTree[name] = (node) => node[NATIVE_PREFIX + name];\n};\n\nconst installNativeMethod = (name, fn) => {\n  if (!nativeMethods[name]) {\n    nativeMethods[name] = fn;\n  }\n};\n\nconst defineNativeAccessors = (proto, descriptors) => {\n  patchProperties(proto, descriptors, NATIVE_PREFIX);\n  // make native accessors available to users\n  for (let prop in descriptors) {\n    installNativeAccessor(prop);\n  }\n};\n\nconst copyProperties = (proto, list = []) => {\n  for (let i = 0; i < list.length; i++) {\n    const name = list[i];\n    const descriptor = Object.getOwnPropertyDescriptor(proto, name);\n    if (descriptor) {\n      Object.defineProperty(proto, NATIVE_PREFIX + name, descriptor);\n      // make native methods/accessors available to users\n      if (descriptor.value) {\n        installNativeMethod(name, descriptor.value);\n      } else {\n        installNativeAccessor(name);\n      }\n    }\n  }\n};\n\n/** @type {!TreeWalker} */\nconst nodeWalker = document.createTreeWalker(\n  document,\n  NodeFilter.SHOW_ALL,\n  null,\n  false\n);\n\n/** @type {!TreeWalker} */\nconst elementWalker = document.createTreeWalker(\n  document,\n  NodeFilter.SHOW_ELEMENT,\n  null,\n  false\n);\n\n/** @type {!Document} */\nconst inertDoc = document.implementation.createHTMLDocument('inert');\n\nconst clearNode = (node) => {\n  let firstChild;\n  while ((firstChild = node[NATIVE_PREFIX + 'firstChild'])) {\n    node[NATIVE_PREFIX + 'removeChild'](firstChild);\n  }\n};\n\nconst ParentNodeAccessors = [\n  'firstElementChild',\n  'lastElementChild',\n  'children',\n  'childElementCount',\n];\n\nconst ParentNodeMethods = [\n  'querySelector',\n  'querySelectorAll',\n  'append',\n  'prepend',\n  'replaceChildren',\n];\n\nexport const addNativePrefixedProperties = () => {\n  // EventTarget\n  const eventProps = [\n    'dispatchEvent',\n    'addEventListener',\n    'removeEventListener',\n  ];\n  if (window.EventTarget) {\n    copyProperties(window.EventTarget.prototype, eventProps);\n\n    // In Firefox 31, `EventTarget` exists, but `EventTarget.prototype` is not\n    // in the prototype chain of `window` and, strangely,\n    // `window instanceof EventTarget` still returns true.\n    if (window[NATIVE_PREFIX + 'addEventListener'] === undefined) {\n      copyProperties(Window.prototype, eventProps);\n    }\n  } else {\n    copyProperties(Node.prototype, eventProps);\n    copyProperties(Window.prototype, eventProps);\n    copyProperties(XMLHttpRequest.prototype, eventProps);\n  }\n\n  // Node\n  if (hasDescriptors) {\n    copyProperties(Node.prototype, [\n      'parentNode',\n      'firstChild',\n      'lastChild',\n      'previousSibling',\n      'nextSibling',\n      'childNodes',\n      'parentElement',\n      'textContent',\n    ]);\n  } else {\n    defineNativeAccessors(Node.prototype, {\n      parentNode: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.parentNode();\n        },\n      },\n      firstChild: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.firstChild();\n        },\n      },\n      lastChild: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.lastChild();\n        },\n      },\n      previousSibling: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.previousSibling();\n        },\n      },\n      nextSibling: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.nextSibling();\n        },\n      },\n      // TODO(sorvell): make this a NodeList or whatever\n      childNodes: {\n        /** @this {Node} */\n        get() {\n          const nodes = [];\n          nodeWalker.currentNode = this;\n          let n = nodeWalker.firstChild();\n          while (n) {\n            nodes.push(n);\n            n = nodeWalker.nextSibling();\n          }\n          return nodes;\n        },\n      },\n      parentElement: {\n        /** @this {Node} */\n        get() {\n          elementWalker.currentNode = this;\n          return elementWalker.parentNode();\n        },\n      },\n      textContent: {\n        /** @this {Node} */\n        get() {\n          switch (this.nodeType) {\n            case Node.ELEMENT_NODE:\n            case Node.DOCUMENT_FRAGMENT_NODE:\n              // TODO(sorvell): This cannot be a single TreeWalker that's reused\n              // at least for Safari 9, but it's unclear why.\n              // eslint-disable-next-line no-case-declarations\n              const textWalker = document.createTreeWalker(\n                this,\n                NodeFilter.SHOW_TEXT,\n                null,\n                false\n              );\n              // eslint-disable-next-line no-case-declarations\n              let content = '',\n                n;\n              while ((n = textWalker.nextNode())) {\n                // TODO(sorvell): can't use textContent since we patch it on Node.prototype!\n                // However, should probably patch it only on element.\n                content += n.nodeValue;\n              }\n              return content;\n            default:\n              return this.nodeValue;\n          }\n        },\n        // Needed on browsers that do not proper accessors (e.g. old versions of Chrome)\n        /** @this {Node} */\n        set(value) {\n          if (typeof value === 'undefined' || value === null) {\n            value = '';\n          }\n          switch (this.nodeType) {\n            case Node.ELEMENT_NODE:\n            case Node.DOCUMENT_FRAGMENT_NODE:\n              clearNode(this);\n              // Document fragments must have no childnodes if setting a blank string\n              if (value.length > 0 || this.nodeType === Node.ELEMENT_NODE) {\n                // Note: old Chrome versions require 2nd argument here\n                this[NATIVE_PREFIX + 'insertBefore'](\n                  document.createTextNode(value),\n                  undefined\n                );\n              }\n              break;\n            default:\n              // TODO(sorvell): can't do this if patch nodeValue.\n              this.nodeValue = value;\n              break;\n          }\n        },\n      },\n    });\n  }\n\n  copyProperties(Node.prototype, [\n    'appendChild',\n    'insertBefore',\n    'removeChild',\n    'replaceChild',\n    'cloneNode',\n    'contains',\n  ]);\n\n  // NOTE, on some browsers IE 11 / Edge 15 some properties are incorrectly on HTMLElement\n  copyProperties(HTMLElement.prototype, ['parentElement', 'contains']);\n\n  const ParentNodeWalkerDescriptors = {\n    firstElementChild: {\n      /** @this {ParentNode} */\n      get() {\n        elementWalker.currentNode = this;\n        return elementWalker.firstChild();\n      },\n    },\n    lastElementChild: {\n      /** @this {ParentNode} */\n      get() {\n        elementWalker.currentNode = this;\n        return elementWalker.lastChild();\n      },\n    },\n    children: {\n      /** @this {ParentNode} */\n      get() {\n        let nodes = [];\n        elementWalker.currentNode = this;\n        let n = elementWalker.firstChild();\n        while (n) {\n          nodes.push(n);\n          n = elementWalker.nextSibling();\n        }\n        return utils.createPolyfilledHTMLCollection(nodes);\n      },\n    },\n    childElementCount: {\n      /** @this {ParentNode} */\n      get() {\n        if (this.children) {\n          return this.children.length;\n        }\n        return 0;\n      },\n    },\n  };\n\n  // Element\n  if (hasDescriptors) {\n    copyProperties(Element.prototype, ParentNodeAccessors);\n\n    copyProperties(Element.prototype, [\n      'previousElementSibling',\n      'nextElementSibling',\n      'innerHTML',\n      'className',\n    ]);\n\n    // NOTE, on some browsers IE 11 / Edge 15 some properties are incorrectly on HTMLElement\n    copyProperties(HTMLElement.prototype, [\n      'children',\n      'innerHTML',\n      'className',\n    ]);\n  } else {\n    defineNativeAccessors(Element.prototype, ParentNodeWalkerDescriptors);\n    defineNativeAccessors(Element.prototype, {\n      previousElementSibling: {\n        /** @this {Element} */\n        get() {\n          elementWalker.currentNode = this;\n          return elementWalker.previousSibling();\n        },\n      },\n      nextElementSibling: {\n        /** @this {Element} */\n        get() {\n          elementWalker.currentNode = this;\n          return elementWalker.nextSibling();\n        },\n      },\n      innerHTML: {\n        /** @this {Element} */\n        get() {\n          return getInnerHTML(this, utils.nativeChildNodesArray);\n        },\n        // Needed on browsers that do not proper accessors (e.g. old versions of Chrome)\n        /** @this {Element} */\n        set(value) {\n          const content =\n            this.localName === 'template'\n              ? /** @type {HTMLTemplateElement} */ (this).content\n              : this;\n          clearNode(content);\n          const containerName = this.localName || 'div';\n          let htmlContainer;\n          if (\n            !this.namespaceURI ||\n            this.namespaceURI === inertDoc.namespaceURI\n          ) {\n            htmlContainer = inertDoc.createElement(containerName);\n          } else {\n            htmlContainer = inertDoc.createElementNS(\n              this.namespaceURI,\n              containerName\n            );\n          }\n          htmlContainer.innerHTML = value;\n          const newContent =\n            this.localName === 'template'\n              ? /** @type {HTMLTemplateElement} */ (htmlContainer).content\n              : htmlContainer;\n          let firstChild;\n          while ((firstChild = newContent[NATIVE_PREFIX + 'firstChild'])) {\n            // Note: old Chrome versions require 2nd argument here\n            content[NATIVE_PREFIX + 'insertBefore'](firstChild, undefined);\n          }\n        },\n      },\n      className: {\n        /** @this {Element} */\n        get() {\n          return this.getAttribute('class') || '';\n        },\n        /** @this {Element} */\n        set(value) {\n          this.setAttribute('class', value);\n        },\n      },\n    });\n  }\n\n  copyProperties(Element.prototype, [\n    'setAttribute',\n    'getAttribute',\n    'hasAttribute',\n    'removeAttribute',\n    'toggleAttribute',\n    // on older Safari, these are on Element.\n    'focus',\n    'blur',\n  ]);\n  copyProperties(Element.prototype, ParentNodeMethods);\n\n  // HTMLElement\n  copyProperties(HTMLElement.prototype, ['focus', 'blur']);\n\n  // HTMLTemplateElement\n  if (window.HTMLTemplateElement) {\n    copyProperties(window.HTMLTemplateElement.prototype, ['innerHTML']);\n  }\n\n  // DocumentFragment\n  if (hasDescriptors) {\n    // NOTE, IE 11 does not have on DocumentFragment\n    // firstElementChild\n    // lastElementChild\n    copyProperties(DocumentFragment.prototype, ParentNodeAccessors);\n  } else {\n    defineNativeAccessors(\n      DocumentFragment.prototype,\n      ParentNodeWalkerDescriptors\n    );\n  }\n\n  copyProperties(DocumentFragment.prototype, ParentNodeMethods);\n\n  // Document\n  if (hasDescriptors) {\n    copyProperties(Document.prototype, ParentNodeAccessors);\n    copyProperties(Document.prototype, ['activeElement']);\n  } else {\n    defineNativeAccessors(Document.prototype, ParentNodeWalkerDescriptors);\n  }\n\n  copyProperties(Document.prototype, [\n    'importNode',\n    'getElementById',\n    'elementFromPoint',\n    utils.getPropertyName(Document.prototype, 'elementsFromPoint'),\n  ]);\n  copyProperties(Document.prototype, ParentNodeMethods);\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\n\n// render enqueuer/flusher\nlet flushList = [];\nlet scheduled;\nexport function enqueue(callback) {\n  if (!scheduled) {\n    scheduled = true;\n    utils.microtask(flush);\n  }\n  flushList.push(callback);\n}\n\nexport function flush() {\n  scheduled = false;\n  let didFlush = Boolean(flushList.length);\n  while (flushList.length) {\n    flushList.shift()();\n  }\n  return didFlush;\n}\n\nflush['list'] = flushList;\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {ensureShadyDataForNode} from './shady-data.js';\n\nclass AsyncObserver {\n  constructor() {\n    this._scheduled = false;\n    this.addedNodes = [];\n    this.removedNodes = [];\n    this.callbacks = new Set();\n  }\n\n  schedule() {\n    if (!this._scheduled) {\n      this._scheduled = true;\n      utils.microtask(() => {\n        this.flush();\n      });\n    }\n  }\n\n  flush() {\n    if (this._scheduled) {\n      this._scheduled = false;\n      let mutations = this.takeRecords();\n      if (mutations.length) {\n        this.callbacks.forEach(function (cb) {\n          cb(mutations);\n        });\n      }\n    }\n  }\n\n  takeRecords() {\n    if (this.addedNodes.length || this.removedNodes.length) {\n      let mutations = [\n        {\n          addedNodes: this.addedNodes,\n          removedNodes: this.removedNodes,\n        },\n      ];\n      this.addedNodes = [];\n      this.removedNodes = [];\n      return mutations;\n    }\n    return [];\n  }\n}\n\n// TODO(sorvell): consider instead polyfilling MutationObserver\n// directly so that users do not have to fork their code.\n// Supporting the entire api may be challenging: e.g. filtering out\n// removed nodes in the wrong scope and seeing non-distributing\n// subtree child mutations.\nexport let observeChildren = function (node, callback) {\n  const sd = ensureShadyDataForNode(node);\n  if (!sd.observer) {\n    sd.observer = new AsyncObserver();\n  }\n  sd.observer.callbacks.add(callback);\n  let observer = sd.observer;\n  return {\n    _callback: callback,\n    _observer: observer,\n    _node: node,\n    takeRecords() {\n      return observer.takeRecords();\n    },\n  };\n};\n\nexport let unobserveChildren = function (handle) {\n  let observer = handle && handle._observer;\n  if (observer) {\n    observer.callbacks.delete(handle._callback);\n    if (!observer.callbacks.size) {\n      ensureShadyDataForNode(handle._node).observer = null;\n    }\n  }\n};\n\nexport function filterMutations(mutations, target) {\n  /** @const {Node} */\n  const targetRootNode = target.getRootNode();\n  return mutations\n    .map(function (mutation) {\n      /** @const {boolean} */\n      const mutationInScope = targetRootNode === mutation.target.getRootNode();\n      if (mutationInScope && mutation.addedNodes) {\n        let nodes = utils.arrayFrom(mutation.addedNodes).filter(function (n) {\n          return targetRootNode === n.getRootNode();\n        });\n        if (nodes.length) {\n          mutation = Object.create(mutation);\n          Object.defineProperty(mutation, 'addedNodes', {\n            value: nodes,\n            configurable: true,\n          });\n          return mutation;\n        }\n      } else if (mutationInScope) {\n        return mutation;\n      }\n    })\n    .filter(function (m) {\n      return m;\n    });\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n// Cribbed from ShadowDOM polyfill\n// https://github.com/webcomponents/webcomponentsjs/blob/master/src/ShadowDOM/wrappers/HTMLElement.js#L28\n/////////////////////////////////////////////////////////////////////////////\n// innerHTML and outerHTML\n\n// http://www.whatwg.org/specs/web-apps/current-work/multipage/the-end.html#escapingString\nlet escapeAttrRegExp = /[&\\u00A0\"]/g;\nlet escapeDataRegExp = /[&\\u00A0<>]/g;\n\nfunction escapeReplace(c) {\n  switch (c) {\n    case '&':\n      return '&amp;';\n    case '<':\n      return '&lt;';\n    case '>':\n      return '&gt;';\n    case '\"':\n      return '&quot;';\n    case '\\u00A0':\n      return '&nbsp;';\n  }\n}\n\nfunction escapeAttr(s) {\n  return s.replace(escapeAttrRegExp, escapeReplace);\n}\n\nfunction escapeData(s) {\n  return s.replace(escapeDataRegExp, escapeReplace);\n}\n\nfunction makeSet(arr) {\n  let set = {};\n  for (let i = 0; i < arr.length; i++) {\n    set[arr[i]] = true;\n  }\n  return set;\n}\n\n// http://www.whatwg.org/specs/web-apps/current-work/#void-elements\nlet voidElements = makeSet([\n  'area',\n  'base',\n  'br',\n  'col',\n  'command',\n  'embed',\n  'hr',\n  'img',\n  'input',\n  'keygen',\n  'link',\n  'meta',\n  'param',\n  'source',\n  'track',\n  'wbr',\n]);\n\nlet plaintextParents = makeSet([\n  'style',\n  'script',\n  'xmp',\n  'iframe',\n  'noembed',\n  'noframes',\n  'plaintext',\n  'noscript',\n]);\n\n/**\n * @param {Node} node\n * @param {Node} parentNode\n * @param {Function=} callback\n */\nexport function getOuterHTML(node, parentNode, callback) {\n  switch (node.nodeType) {\n    case Node.ELEMENT_NODE: {\n      let tagName = node.localName;\n      let s = '<' + tagName;\n      let attrs = node.attributes;\n      for (let i = 0, attr; (attr = attrs[i]); i++) {\n        s += ' ' + attr.name + '=\"' + escapeAttr(attr.value) + '\"';\n      }\n      s += '>';\n      if (voidElements[tagName]) {\n        return s;\n      }\n      return s + getInnerHTML(node, callback) + '</' + tagName + '>';\n    }\n    case Node.TEXT_NODE: {\n      let data = /** @type {Text} */ (node).data;\n      if (parentNode && plaintextParents[parentNode.localName]) {\n        return data;\n      }\n      return escapeData(data);\n    }\n    case Node.COMMENT_NODE: {\n      return '<!--' + /** @type {Comment} */ (node).data + '-->';\n    }\n    default: {\n      window.console.error(node);\n      throw new Error('not implemented');\n    }\n  }\n}\n\n/**\n * @param {Node} node\n * @param {Function=} callback\n */\nexport function getInnerHTML(node, callback) {\n  if (node.localName === 'template') {\n    node = /** @type {HTMLTemplateElement} */ (node).content;\n  }\n  let s = '';\n  let c$ = callback ? callback(node) : node.childNodes;\n  for (let i = 0, l = c$.length, child; i < l && (child = c$[i]); i++) {\n    s += getOuterHTML(child, node, callback);\n  }\n  return s;\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {ensureShadyDataForNode} from './shady-data.js';\n\nexport const InsideDescriptors = utils.getOwnPropertyDescriptors({\n  /** @this {Node} */\n  get childNodes() {\n    return this[utils.SHADY_PREFIX + 'childNodes'];\n  },\n\n  /** @this {Node} */\n  get firstChild() {\n    return this[utils.SHADY_PREFIX + 'firstChild'];\n  },\n\n  /** @this {Node} */\n  get lastChild() {\n    return this[utils.SHADY_PREFIX + 'lastChild'];\n  },\n\n  /** @this {Node} */\n  get childElementCount() {\n    return this[utils.SHADY_PREFIX + 'childElementCount'];\n  },\n\n  /** @this {Node} */\n  get children() {\n    return this[utils.SHADY_PREFIX + 'children'];\n  },\n\n  /** @this {Node} */\n  get firstElementChild() {\n    return this[utils.SHADY_PREFIX + 'firstElementChild'];\n  },\n\n  /** @this {Node} */\n  get lastElementChild() {\n    return this[utils.SHADY_PREFIX + 'lastElementChild'];\n  },\n\n  /** @this {Node} */\n  get shadowRoot() {\n    return this[utils.SHADY_PREFIX + 'shadowRoot'];\n  },\n});\n\nexport const TextContentInnerHTMLDescriptors = utils.getOwnPropertyDescriptors({\n  /** @this {Node} */\n  get textContent() {\n    return this[utils.SHADY_PREFIX + 'textContent'];\n  },\n\n  /** @this {Node} */\n  set textContent(value) {\n    this[utils.SHADY_PREFIX + 'textContent'] = value;\n  },\n\n  /** @this {Node} */\n  get innerHTML() {\n    return this[utils.SHADY_PREFIX + 'innerHTML'];\n  },\n\n  /** @this {Node} */\n  set innerHTML(value) {\n    this[utils.SHADY_PREFIX + 'innerHTML'] = value;\n  },\n});\n\nexport const OutsideDescriptors = utils.getOwnPropertyDescriptors({\n  /** @this {Node} */\n  get parentElement() {\n    return this[utils.SHADY_PREFIX + 'parentElement'];\n  },\n\n  /** @this {Node} */\n  get parentNode() {\n    return this[utils.SHADY_PREFIX + 'parentNode'];\n  },\n\n  /** @this {Node} */\n  get nextSibling() {\n    return this[utils.SHADY_PREFIX + 'nextSibling'];\n  },\n\n  /** @this {Node} */\n  get previousSibling() {\n    return this[utils.SHADY_PREFIX + 'previousSibling'];\n  },\n\n  /** @this {Node} */\n  get nextElementSibling() {\n    return this[utils.SHADY_PREFIX + 'nextElementSibling'];\n  },\n\n  /** @this {Node} */\n  get previousElementSibling() {\n    return this[utils.SHADY_PREFIX + 'previousElementSibling'];\n  },\n\n  /** @this {Node} */\n  get className() {\n    return this[utils.SHADY_PREFIX + 'className'];\n  },\n\n  /** @this {Node} */\n  set className(value) {\n    this[utils.SHADY_PREFIX + 'className'] = value;\n  },\n});\n\nconst makeNonEnumerable = (descriptors) => {\n  for (let prop in descriptors) {\n    const descriptor = descriptors[prop];\n    // NOTE, the only known reason the descriptor wouldn't exist here is\n    // if someone has patched `Object.getOwnPropertyNames`, but we've seen this\n    // so this is just to be extra safe.\n    if (descriptor) {\n      descriptor.enumerable = false;\n    }\n  }\n};\n\nmakeNonEnumerable(InsideDescriptors);\nmakeNonEnumerable(TextContentInnerHTMLDescriptors);\nmakeNonEnumerable(OutsideDescriptors);\n\nconst noInstancePatching =\n  utils.settings.hasDescriptors || utils.settings.noPatch === true;\n\n// ensure an element has patched \"outside\" accessors; no-op when not needed\nexport let patchOutsideElementAccessors = noInstancePatching\n  ? function () {}\n  : function (element) {\n      const sd = ensureShadyDataForNode(element);\n      if (!sd.__outsideAccessors) {\n        sd.__outsideAccessors = true;\n        utils.patchExistingProperties(element, OutsideDescriptors);\n      }\n    };\n\n// ensure an element has patched \"inside\" accessors; no-op when not needed\nexport let patchInsideElementAccessors = noInstancePatching\n  ? function () {}\n  : function (element) {\n      const sd = ensureShadyDataForNode(element);\n      if (!sd.__insideAccessors) {\n        sd.__insideAccessors = true;\n        utils.patchExistingProperties(element, InsideDescriptors);\n        // NOTE: There are compatibility issues with patches for `textContent`\n        // and `innerHTML` between CE and SD. Since SD patches are applied\n        // via `ShadyDOM.patch` and CE patches are applied as the tree is walked,\n        // SD patches overwrite CE patches.\n        // * When SD is in patching mode, SD calls through to native\n        // methods not patched by CE (since SD is at the bottom) and CE does not\n        // upgrade, connect, or disconnect elements. Therefore do *not patch*\n        // these accessors in this case.\n        // * When SD is in `noPatch` mode, the SD patches call through to\n        // \"native\" methods that are patched by CE (since CE is at the bottom).\n        // Therefore continue to patch in this case.\n        // If the custom elements polyfill is not loaded, then these accessors\n        // should be patched so they work correctly.\n        if (!utils.hasPolyfilledCustomElements() || utils.settings.noPatch) {\n          utils.patchExistingProperties(\n            element,\n            TextContentInnerHTMLDescriptors\n          );\n        }\n      }\n    };\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {flush} from './flush.js';\nimport {shadyDataForNode, ensureShadyDataForNode} from './shady-data.js';\n\n/*\nMake this name unique so it is unlikely to conflict with properties on objects passed to `addEventListener`\nhttps://github.com/webcomponents/shadydom/issues/173\n*/\nconst /** string */ eventWrappersName = `__eventWrappers${Date.now()}`;\n\n/** @type {?function(!Event): boolean} */\nconst composedGetter = (() => {\n  const composedProp = Object.getOwnPropertyDescriptor(\n    Event.prototype,\n    'composed'\n  );\n  return composedProp ? (ev) => composedProp.get.call(ev) : null;\n})();\n\nconst supportsEventOptions = (() => {\n  let supported = false;\n  let eventOptions = {\n    get capture() {\n      supported = true;\n      return false;\n    },\n  };\n  const listener = () => {};\n  // NOTE: These will be unpatched at this point.\n  window.addEventListener('test', listener, eventOptions);\n  window.removeEventListener('test', listener, eventOptions);\n  return supported;\n})();\n\nconst parseEventOptions = (optionsOrCapture) => {\n  let capture, once, shadyTarget;\n  if (\n    optionsOrCapture !== null &&\n    (typeof optionsOrCapture === 'object' ||\n      typeof optionsOrCapture === 'function')\n  ) {\n    capture = Boolean(optionsOrCapture.capture);\n    once = Boolean(optionsOrCapture.once);\n    shadyTarget = optionsOrCapture.__shadyTarget;\n  } else {\n    capture = Boolean(optionsOrCapture);\n    once = false;\n  }\n  return {\n    shadyTarget,\n    capture,\n    once,\n    nativeEventOptions: supportsEventOptions ? optionsOrCapture : capture,\n  };\n};\n\n// https://github.com/w3c/webcomponents/issues/513#issuecomment-224183937\nconst alwaysComposed = {\n  'blur': true,\n  'focus': true,\n  'focusin': true,\n  'focusout': true,\n  'click': true,\n  'dblclick': true,\n  'mousedown': true,\n  'mouseenter': true,\n  'mouseleave': true,\n  'mousemove': true,\n  'mouseout': true,\n  'mouseover': true,\n  'mouseup': true,\n  'wheel': true,\n  'beforeinput': true,\n  'input': true,\n  'keydown': true,\n  'keyup': true,\n  'compositionstart': true,\n  'compositionupdate': true,\n  'compositionend': true,\n  'touchstart': true,\n  'touchend': true,\n  'touchmove': true,\n  'touchcancel': true,\n  'pointerover': true,\n  'pointerenter': true,\n  'pointerdown': true,\n  'pointermove': true,\n  'pointerup': true,\n  'pointercancel': true,\n  'pointerout': true,\n  'pointerleave': true,\n  'gotpointercapture': true,\n  'lostpointercapture': true,\n  'dragstart': true,\n  'drag': true,\n  'dragenter': true,\n  'dragleave': true,\n  'dragover': true,\n  'drop': true,\n  'dragend': true,\n  'DOMActivate': true,\n  'DOMFocusIn': true,\n  'DOMFocusOut': true,\n  'keypress': true,\n};\n\nconst unpatchedEvents = {\n  'DOMAttrModified': true,\n  'DOMAttributeNameChanged': true,\n  'DOMCharacterDataModified': true,\n  'DOMElementNameChanged': true,\n  'DOMNodeInserted': true,\n  'DOMNodeInsertedIntoDocument': true,\n  'DOMNodeRemoved': true,\n  'DOMNodeRemovedFromDocument': true,\n  'DOMSubtreeModified': true,\n};\n\n/**\n * Some EventTarget subclasses are not Node subclasses, and you cannot call\n * `getRootNode()` on them.\n *\n * @param {!(Node|EventTarget)} eventTarget\n * @return {!(Node|EventTarget)}\n */\nfunction getRootNodeWithFallback(eventTarget) {\n  if (eventTarget instanceof Node) {\n    return eventTarget[utils.SHADY_PREFIX + 'getRootNode']();\n  } else {\n    return eventTarget;\n  }\n}\n\nfunction pathComposer(startNode, composed) {\n  let composedPath = [];\n  let current = startNode;\n  let startRoot = getRootNodeWithFallback(startNode);\n  while (current) {\n    composedPath.push(current);\n    if (current[utils.SHADY_PREFIX + 'assignedSlot']) {\n      current = current[utils.SHADY_PREFIX + 'assignedSlot'];\n    } else if (\n      current.nodeType === Node.DOCUMENT_FRAGMENT_NODE &&\n      current.host &&\n      (composed || current !== startRoot)\n    ) {\n      current = current.host;\n    } else {\n      current = current[utils.SHADY_PREFIX + 'parentNode'];\n    }\n  }\n  // event composedPath includes window when startNode's ownerRoot is document\n  if (composedPath[composedPath.length - 1] === document) {\n    composedPath.push(window);\n  }\n  return composedPath;\n}\n\nexport const composedPath = (event) => {\n  if (!event.__composedPath) {\n    event.__composedPath = pathComposer(event.target, true);\n  }\n  return event.__composedPath;\n};\n\nfunction retarget(refNode, path) {\n  if (!utils.isShadyRoot) {\n    return refNode;\n  }\n  // If ANCESTOR's root is not a shadow root or ANCESTOR's root is BASE's\n  // shadow-including inclusive ancestor, return ANCESTOR.\n  let refNodePath = pathComposer(refNode, true);\n  let p$ = path;\n  for (let i = 0, ancestor, lastRoot, root, rootIdx; i < p$.length; i++) {\n    ancestor = p$[i];\n    root = getRootNodeWithFallback(ancestor);\n    if (root !== lastRoot) {\n      rootIdx = refNodePath.indexOf(root);\n      lastRoot = root;\n    }\n    if (!utils.isShadyRoot(root) || rootIdx > -1) {\n      return ancestor;\n    }\n  }\n}\n\nlet EventPatches = {\n  /**\n   * @this {Event}\n   */\n  get composed() {\n    if (this.__composed === undefined) {\n      // if there's an original `composed` getter on the Event prototype, use that\n      if (composedGetter) {\n        // TODO(web-padawan): see https://github.com/webcomponents/shadydom/issues/275\n        this.__composed =\n          this.type === 'focusin' ||\n          this.type === 'focusout' ||\n          composedGetter(this);\n        // If the event is trusted, or `isTrusted` is not supported, check the list of always composed events\n      } else if (this.isTrusted !== false) {\n        this.__composed = alwaysComposed[this.type];\n      }\n    }\n    return /** @type {!Event} */ (this).__composed || false;\n  },\n\n  /**\n   * @this {Event}\n   */\n  composedPath() {\n    if (!this.__composedPath) {\n      this.__composedPath = pathComposer(this['__target'], this.composed);\n    }\n    return /** @type {!Event} */ (this).__composedPath;\n  },\n\n  /**\n   * @this {Event}\n   */\n  get target() {\n    return retarget(\n      this.currentTarget || this['__previousCurrentTarget'],\n      this.composedPath()\n    );\n  },\n\n  // http://w3c.github.io/webcomponents/spec/shadow/#event-relatedtarget-retargeting\n  /**\n   * @this {Event}\n   */\n  get relatedTarget() {\n    if (!this.__relatedTarget) {\n      return null;\n    }\n    if (!this.__relatedTargetComposedPath) {\n      this.__relatedTargetComposedPath = pathComposer(\n        this.__relatedTarget,\n        true\n      );\n    }\n    // find the deepest node in relatedTarget composed path that is in the same root with the currentTarget\n    return retarget(\n      this.currentTarget || this['__previousCurrentTarget'],\n      /** @type {!Event} */ (this).__relatedTargetComposedPath\n    );\n  },\n  /**\n   * @this {Event}\n   */\n  stopPropagation() {\n    Event.prototype.stopPropagation.call(this);\n    this.__propagationStopped = true;\n  },\n  /**\n   * @this {Event}\n   */\n  stopImmediatePropagation() {\n    Event.prototype.stopImmediatePropagation.call(this);\n    this.__immediatePropagationStopped = true;\n    this.__propagationStopped = true;\n  },\n};\n\n// Some browsers have missing or broken descriptors. If this is the case\n// eventPhase can't be polyfilled. For example, Chrome 41 does not\n// have prototypical descriptors on DOM objects and Safari 9 has broken ones\n// that cannot be used.\nconst eventPhaseDescriptor =\n  utils.settings.hasDescriptors &&\n  Object.getOwnPropertyDescriptor(Event.prototype, 'eventPhase');\nif (eventPhaseDescriptor) {\n  Object.defineProperty(\n    EventPatches,\n    'eventPhase',\n    /** @type {!ObjectPropertyDescriptor<!Event>} */ ({\n      /**\n       * @this {Event}\n       */\n      get() {\n        return this.currentTarget === this.target\n          ? Event.AT_TARGET\n          : this[utils.NATIVE_PREFIX + 'eventPhase'];\n      },\n      enumerable: true,\n      configurable: true,\n    })\n  );\n\n  Object.defineProperty(\n    EventPatches,\n    utils.NATIVE_PREFIX + 'eventPhase',\n    eventPhaseDescriptor\n  );\n}\n\nfunction mixinComposedFlag(Base) {\n  // NOTE: avoiding use of `class` here so that transpiled output does not\n  // try to do `Base.call` with a dom construtor.\n  let klazz = function (type, options) {\n    let event = new Base(type, options);\n    event.__composed = options && Boolean(options['composed']);\n    return event;\n  };\n  // put constructor properties on subclass\n  klazz.__proto__ = Base;\n  klazz.prototype = Base.prototype;\n  return klazz;\n}\n\nlet nonBubblingEventsToRetarget = {\n  'focus': true,\n  'blur': true,\n};\n\n/**\n * Check if the event has been retargeted by comparing original `target`, and calculated `target`\n * @param {Event} event\n * @return {boolean} True if the original target and calculated target are the same\n */\nfunction hasRetargeted(event) {\n  return (\n    event['__target'] !== event.target ||\n    event.__relatedTarget !== event.relatedTarget\n  );\n}\n\n/**\n *\n * @param {Event} event\n * @param {Node} node\n * @param {string} phase\n */\nfunction fireHandlers(event, node, phase) {\n  let hs =\n    node.__handlers &&\n    node.__handlers[event.type] &&\n    node.__handlers[event.type][phase];\n  if (hs) {\n    for (let i = 0, fn; (fn = hs[i]); i++) {\n      if (hasRetargeted(event) && event.target === event.relatedTarget) {\n        return;\n      }\n      fn.call(node, event);\n      if (event.__immediatePropagationStopped) {\n        return;\n      }\n    }\n  }\n}\n\n// In Chrome 41, `currentTarget` is an own property of every `Event` and its\n// descriptor is a _data_ descriptor and not an accessor descriptor (so there is\n// no getter that could be saved and wrapped) but the browser effectively treats\n// this property as if it had a getter and returns different values on getting\n// as necessary. Further, setting a new descriptor for `currentTarget`, as\n// `shadyDispatchEvent` does below, permanently breaks this special descriptor\n// behavior. In this case, `shadyDispatchEvent` creates a new object with the\n// original event as its prototype (via `Object.create`) and modifies that\n// object's `currentTarget` instead, to avoid breaking the descriptor on the\n// original event.\n//\n// In Chrome 104 and Safari 9, some getters on events do not allow `this` to be\n// anything other than exactly the original event object. This means that the\n// above process of using a proxy-like (not a `Proxy`) object for the event\n// fails because any user that attempts to use properties of the original event\n// will be using the proxy as `this`.\n//\n// Fortunately, these two issues seem to be mutually exclusive amongst the\n// browsers that we test on, so we can specifically check if `currentTarget`\n// exists on a new `Event` and switch based off of that.\n// `utils.settings.hasDescriptors` is not sufficient for deciding this behavior\n// because, in Safari 9, `currentTarget` is not an own property of events, but\n// `.hasDescriptors` is still false.\nconst shadyDispatchEventNeedsProxyEvent = new Event('e').hasOwnProperty(\n  'currentTarget'\n);\n\nfunction shadyDispatchEvent(originalEvent) {\n  const e = shadyDispatchEventNeedsProxyEvent\n    ? Object.create(originalEvent)\n    : originalEvent;\n  const path = e.composedPath();\n  const retargetedPath = path.map((node) => retarget(node, path));\n  const bubbles = e.bubbles;\n\n  let currentTarget;\n  // override `currentTarget` to let patched `target` calculate correctly\n  const prevCurrentTargetDesc = Object.getOwnPropertyDescriptor(\n    e,\n    'currentTarget'\n  );\n  Object.defineProperty(e, 'currentTarget', {\n    configurable: true,\n    enumerable: true,\n    get: function () {\n      return currentTarget;\n    },\n  });\n\n  let eventPhase = Event.CAPTURING_PHASE;\n  const prevEventPhaseDesc = Object.getOwnPropertyDescriptor(e, 'eventPhase');\n  Object.defineProperty(e, 'eventPhase', {\n    configurable: true,\n    enumerable: true,\n    get: function () {\n      return eventPhase;\n    },\n  });\n\n  try {\n    for (let i = path.length - 1; i >= 0; i--) {\n      currentTarget = path[i];\n      eventPhase =\n        currentTarget === retargetedPath[i]\n          ? Event.AT_TARGET\n          : Event.CAPTURING_PHASE;\n      // capture phase fires all capture handlers\n      fireHandlers(e, currentTarget, 'capture');\n      if (e.__propagationStopped) {\n        return;\n      }\n    }\n\n    for (let i = 0; i < path.length; i++) {\n      currentTarget = path[i];\n      const atTarget = currentTarget === retargetedPath[i];\n      if (atTarget || bubbles) {\n        eventPhase = atTarget ? Event.AT_TARGET : Event.BUBBLING_PHASE;\n        fireHandlers(e, currentTarget, 'bubble');\n        if (e.__propagationStopped) {\n          return;\n        }\n      }\n    }\n  } finally {\n    if (!shadyDispatchEventNeedsProxyEvent) {\n      // Restore previous currentTarget & eventPhase descriptors when\n      // dispatching is complete\n      if (prevCurrentTargetDesc) {\n        Object.defineProperty(e, 'currentTarget', prevCurrentTargetDesc);\n      } else {\n        delete e['currentTarget'];\n      }\n      if (prevEventPhaseDesc) {\n        Object.defineProperty(e, 'eventPhase', prevEventPhaseDesc);\n      } else {\n        delete e['eventPhase'];\n      }\n    }\n  }\n}\n\nfunction listenerSettingsEqual(savedListener, node, type, capture) {\n  let {node: savedNode, type: savedType, capture: savedCapture} = savedListener;\n  return node === savedNode && type === savedType && capture === savedCapture;\n}\n\nexport function findListener(wrappers, node, type, capture) {\n  for (let i = 0; i < wrappers.length; i++) {\n    if (listenerSettingsEqual(wrappers[i], node, type, capture)) {\n      return i;\n    }\n  }\n  return -1;\n}\n\n/**\n * Firefox can throw on accessing eventWrappers inside of `removeEventListener` during a selenium run\n * Try/Catch accessing eventWrappers to work around\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1353074\n */\nfunction getEventWrappers(eventLike) {\n  let wrappers = null;\n  try {\n    wrappers = eventLike[eventWrappersName];\n  } catch (e) {} // eslint-disable-line no-empty\n  return wrappers;\n}\n\nfunction targetNeedsPathCheck(node) {\n  return utils.isShadyRoot(node) || node.localName === 'slot';\n}\n\n/** @this {Node} */\nexport function dispatchEvent(event) {\n  flush();\n  // If the target is disconnected from the real document, it might still be\n  // connected in the user-facing tree. To allow its path to potentially\n  // include both connected and disconnected parts, dispatch it manually.\n  if (\n    !utils.settings.preferPerformance &&\n    this instanceof Node &&\n    !utils.documentContains(document, this)\n  ) {\n    if (!event['__target']) {\n      patchEvent(event, this);\n    }\n    return shadyDispatchEvent(event);\n  } else {\n    return this[utils.NATIVE_PREFIX + 'dispatchEvent'](event);\n  }\n}\n\n/**\n * @this {EventTarget}\n */\nexport function addEventListener(type, fnOrObj, optionsOrCapture) {\n  const {capture, once, shadyTarget, nativeEventOptions} = parseEventOptions(\n    optionsOrCapture\n  );\n  if (!fnOrObj) {\n    return;\n  }\n\n  const handlerType = typeof fnOrObj;\n\n  // bail if `fnOrObj` is not a function, not an object\n  if (handlerType !== 'function' && handlerType !== 'object') {\n    return;\n  }\n\n  // bail if `fnOrObj` is an object without a `handleEvent` method\n  if (\n    handlerType === 'object' &&\n    (!fnOrObj.handleEvent || typeof fnOrObj.handleEvent !== 'function')\n  ) {\n    return;\n  }\n\n  if (unpatchedEvents[type]) {\n    return this[utils.NATIVE_PREFIX + 'addEventListener'](\n      type,\n      fnOrObj,\n      nativeEventOptions\n    );\n  }\n\n  // hack to let ShadyRoots have event listeners\n  // event listener will be on host, but `currentTarget`\n  // will be set to shadyroot for event listener\n  let target = shadyTarget || this;\n\n  let wrappers = fnOrObj[eventWrappersName];\n  if (wrappers) {\n    // The callback `fn` might be used for multiple nodes/events. Since we generate\n    // a wrapper function, we need to keep track of it when we remove the listener.\n    // It's more efficient to store the node/type/options information as Array in\n    // `fn` itself rather than the node (we assume that the same callback is used\n    // for few nodes at most, whereas a node will likely have many event listeners).\n    // NOTE(valdrin) invoking external functions is costly, inline has better perf.\n    // Stop if the wrapper function has already been created.\n    if (findListener(wrappers, target, type, capture) > -1) {\n      return;\n    }\n  } else {\n    fnOrObj[eventWrappersName] = [];\n  }\n\n  /**\n   * @this {EventTarget}\n   * @param {Event} e\n   */\n  const wrapperFn = (e) => {\n    // Support `once` option.\n    if (once) {\n      this[utils.SHADY_PREFIX + 'removeEventListener'](\n        type,\n        fnOrObj,\n        optionsOrCapture\n      );\n    }\n    if (!e['__target']) {\n      patchEvent(e);\n    }\n    let lastCurrentTargetDesc;\n    let lastEventPhaseDesc;\n    if (target !== this) {\n      // replace `currentTarget` to make `target` and `relatedTarget` correct for inside the shadowroot\n      lastCurrentTargetDesc = Object.getOwnPropertyDescriptor(\n        e,\n        'currentTarget'\n      );\n      Object.defineProperty(e, 'currentTarget', {\n        get() {\n          return target;\n        },\n        configurable: true,\n      });\n      lastEventPhaseDesc = Object.getOwnPropertyDescriptor(e, 'eventPhase');\n      Object.defineProperty(e, 'eventPhase', {\n        configurable: true,\n        enumerable: true,\n        get() {\n          // Shady DOM doesn't support dispatching to a shadow root as the\n          // target, so we don't need to handle Event.AT_TARGET.\n          return capture ? Event.CAPTURING_PHASE : Event.BUBBLING_PHASE;\n        },\n      });\n    }\n    e['__previousCurrentTarget'] = e['currentTarget'];\n    // Always check if a shadowRoot or slot is in the current event path.\n    // If it is not, the event was generated on either the host of the shadowRoot\n    // or a children of the host.\n    if (\n      targetNeedsPathCheck(target) &&\n      e.composedPath().indexOf(target) == -1\n    ) {\n      return;\n    }\n    // There are two critera that should stop events from firing on this node\n    // 1. the event is not composed and the current node is not in the same root as the target\n    // 2. when bubbling, if after retargeting, relatedTarget and target point to the same node\n    if (e.composed || e.composedPath().indexOf(target) > -1) {\n      if (hasRetargeted(e) && e.target === e.relatedTarget) {\n        if (e.eventPhase === Event.BUBBLING_PHASE) {\n          e.stopImmediatePropagation();\n        }\n        return;\n      }\n      // prevent non-bubbling events from triggering bubbling handlers on shadowroot, but only if not in capture phase\n      if (\n        e.eventPhase !== Event.CAPTURING_PHASE &&\n        !e.bubbles &&\n        e.target !== target &&\n        !(target instanceof Window)\n      ) {\n        return;\n      }\n      let ret =\n        handlerType === 'function'\n          ? fnOrObj.call(target, e)\n          : fnOrObj.handleEvent && fnOrObj.handleEvent(e);\n      if (target !== this) {\n        // Replace the original descriptors for `currentTarget` and `eventPhase`.\n        if (lastCurrentTargetDesc) {\n          Object.defineProperty(e, 'currentTarget', lastCurrentTargetDesc);\n          lastCurrentTargetDesc = null;\n        } else {\n          delete e['currentTarget'];\n        }\n        if (lastEventPhaseDesc) {\n          Object.defineProperty(e, 'eventPhase', lastEventPhaseDesc);\n          lastEventPhaseDesc = null;\n        } else {\n          delete e['eventPhase'];\n        }\n      }\n      return ret;\n    }\n  };\n\n  // Store the wrapper information.\n  fnOrObj[eventWrappersName].push({\n    // note: use target here which is either a shadowRoot\n    // (when the host element is proxy'ing the event) or this element\n    node: target,\n    type,\n    capture,\n    wrapperFn,\n  });\n\n  this.__handlers = this.__handlers || {};\n  this.__handlers[type] = this.__handlers[type] || {\n    'capture': [],\n    'bubble': [],\n  };\n  this.__handlers[type][capture ? 'capture' : 'bubble'].push(wrapperFn);\n\n  if (!nonBubblingEventsToRetarget[type]) {\n    this[utils.NATIVE_PREFIX + 'addEventListener'](\n      type,\n      wrapperFn,\n      nativeEventOptions\n    );\n  }\n}\n\n/**\n * @this {EventTarget}\n */\nexport function removeEventListener(type, fnOrObj, optionsOrCapture) {\n  if (!fnOrObj) {\n    return;\n  }\n  const {capture, shadyTarget, nativeEventOptions} = parseEventOptions(\n    optionsOrCapture\n  );\n  if (unpatchedEvents[type]) {\n    return this[utils.NATIVE_PREFIX + 'removeEventListener'](\n      type,\n      fnOrObj,\n      nativeEventOptions\n    );\n  }\n  let target = shadyTarget || this;\n  // Search the wrapped function.\n  let wrapperFn = undefined;\n  let wrappers = getEventWrappers(fnOrObj);\n  if (wrappers) {\n    let idx = findListener(wrappers, target, type, capture);\n    if (idx > -1) {\n      wrapperFn = wrappers.splice(idx, 1)[0].wrapperFn;\n      // Cleanup.\n      if (!wrappers.length) {\n        fnOrObj[eventWrappersName] = undefined;\n      }\n    }\n  }\n  this[utils.NATIVE_PREFIX + 'removeEventListener'](\n    type,\n    wrapperFn || fnOrObj,\n    nativeEventOptions\n  );\n  if (wrapperFn && this.__handlers && this.__handlers[type]) {\n    const arr = this.__handlers[type][capture ? 'capture' : 'bubble'];\n    const idx = arr.indexOf(wrapperFn);\n    if (idx > -1) {\n      arr.splice(idx, 1);\n    }\n  }\n}\n\nfunction activateFocusEventOverrides() {\n  for (let ev in nonBubblingEventsToRetarget) {\n    window[utils.NATIVE_PREFIX + 'addEventListener'](\n      ev,\n      function (e) {\n        if (!e['__target']) {\n          patchEvent(e);\n          shadyDispatchEvent(e);\n        }\n      },\n      true\n    );\n  }\n}\n\nconst EventPatchesDescriptors = utils.getOwnPropertyDescriptors(EventPatches);\n\nconst SHADY_PROTO = '__shady_patchedProto';\nconst SHADY_SOURCE_PROTO = '__shady_sourceProto';\n\nfunction patchEvent(event, target = event.target) {\n  event['__target'] = target;\n  event.__relatedTarget = event.relatedTarget;\n  // attempt to patch prototype (via cache)\n  if (utils.settings.hasDescriptors) {\n    const proto = Object.getPrototypeOf(event);\n    // eslint-disable-next-line no-prototype-builtins\n    if (!proto.hasOwnProperty(SHADY_PROTO)) {\n      const patchedProto = Object.create(proto);\n      patchedProto[SHADY_SOURCE_PROTO] = proto;\n      utils.patchProperties(patchedProto, EventPatchesDescriptors);\n      proto[SHADY_PROTO] = patchedProto;\n    }\n    event.__proto__ = proto[SHADY_PROTO];\n    // and fallback to patching instance\n  } else {\n    utils.patchProperties(event, EventPatchesDescriptors);\n  }\n}\n\nlet PatchedEvent = mixinComposedFlag(Event);\nlet PatchedCustomEvent = mixinComposedFlag(CustomEvent);\nlet PatchedMouseEvent = mixinComposedFlag(MouseEvent);\n\nexport function patchEvents() {\n  activateFocusEventOverrides();\n  window.Event = PatchedEvent;\n  window.CustomEvent = PatchedCustomEvent;\n  window.MouseEvent = PatchedMouseEvent;\n}\n\nexport function patchClick() {\n  // Fix up `Element.prototype.click()` if `isTrusted` is supported, but `composed` isn't\n  if (\n    !composedGetter &&\n    Object.getOwnPropertyDescriptor(Event.prototype, 'isTrusted')\n  ) {\n    /** @this {Element} */\n    const composedClickFn = function () {\n      const ev = new MouseEvent('click', {\n        bubbles: true,\n        cancelable: true,\n        composed: true,\n      });\n      this[utils.SHADY_PREFIX + 'dispatchEvent'](ev);\n    };\n    if (Element.prototype.click) {\n      Element.prototype.click = composedClickFn;\n    } else if (HTMLElement.prototype.click) {\n      HTMLElement.prototype.click = composedClickFn;\n    }\n  }\n}\n\nexport const eventPropertyNamesForElement = Object.getOwnPropertyNames(\n  Element.prototype\n).filter((name) => name.substring(0, 2) === 'on');\n\nexport const eventPropertyNamesForHTMLElement = Object.getOwnPropertyNames(\n  HTMLElement.prototype\n).filter((name) => name.substring(0, 2) === 'on');\n\n/**\n * @param {string} property\n * @return {!ObjectPropertyDescriptor<Element>}\n */\nexport const wrappedDescriptorForEventProperty = (property) => {\n  return {\n    /** @this {Element} */\n    set: function (fn) {\n      const shadyData = ensureShadyDataForNode(this);\n      const eventName = property.substring(2);\n      if (!shadyData.__onCallbackListeners) {\n        shadyData.__onCallbackListeners = {};\n      }\n      shadyData.__onCallbackListeners[property] &&\n        this.removeEventListener(\n          eventName,\n          shadyData.__onCallbackListeners[property]\n        );\n      this[utils.SHADY_PREFIX + 'addEventListener'](eventName, fn);\n      shadyData.__onCallbackListeners[property] = fn;\n    },\n    /** @this {Element} */\n    get() {\n      const shadyData = shadyDataForNode(this);\n      return (\n        shadyData &&\n        shadyData.__onCallbackListeners &&\n        shadyData.__onCallbackListeners[property]\n      );\n    },\n    configurable: true,\n  };\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nfunction newSplice(index, removed, addedCount) {\n  return {\n    index: index,\n    removed: removed,\n    addedCount: addedCount,\n  };\n}\n\nconst EDIT_LEAVE = 0;\nconst EDIT_UPDATE = 1;\nconst EDIT_ADD = 2;\nconst EDIT_DELETE = 3;\n\n// Note: This function is *based* on the computation of the Levenshtein\n// \"edit\" distance. The one change is that \"updates\" are treated as two\n// edits - not one. With Array splices, an update is really a delete\n// followed by an add. By retaining this, we optimize for \"keeping\" the\n// maximum array items in the original array. For example:\n//\n//   'xxxx123' -> '123yyyy'\n//\n// With 1-edit updates, the shortest path would be just to update all seven\n// characters. With 2-edit updates, we delete 4, leave 3, and add 4. This\n// leaves the substring '123' intact.\nfunction calcEditDistances(\n  current,\n  currentStart,\n  currentEnd,\n  old,\n  oldStart,\n  oldEnd\n) {\n  // \"Deletion\" columns\n  let rowCount = oldEnd - oldStart + 1;\n  let columnCount = currentEnd - currentStart + 1;\n  let distances = new Array(rowCount);\n\n  // \"Addition\" rows. Initialize null column.\n  for (let i = 0; i < rowCount; i++) {\n    distances[i] = new Array(columnCount);\n    distances[i][0] = i;\n  }\n\n  // Initialize null row\n  for (let j = 0; j < columnCount; j++) {\n    distances[0][j] = j;\n  }\n\n  for (let i = 1; i < rowCount; i++) {\n    for (let j = 1; j < columnCount; j++) {\n      if (equals(current[currentStart + j - 1], old[oldStart + i - 1])) {\n        distances[i][j] = distances[i - 1][j - 1];\n      } else {\n        let north = distances[i - 1][j] + 1;\n        let west = distances[i][j - 1] + 1;\n        distances[i][j] = north < west ? north : west;\n      }\n    }\n  }\n\n  return distances;\n}\n\n// This starts at the final weight, and walks \"backward\" by finding\n// the minimum previous weight recursively until the origin of the weight\n// matrix.\nfunction spliceOperationsFromEditDistances(distances) {\n  let i = distances.length - 1;\n  let j = distances[0].length - 1;\n  let current = distances[i][j];\n  let edits = [];\n  while (i > 0 || j > 0) {\n    if (i == 0) {\n      edits.push(EDIT_ADD);\n      j--;\n      continue;\n    }\n    if (j == 0) {\n      edits.push(EDIT_DELETE);\n      i--;\n      continue;\n    }\n    let northWest = distances[i - 1][j - 1];\n    let west = distances[i - 1][j];\n    let north = distances[i][j - 1];\n\n    let min;\n    if (west < north) {\n      min = west < northWest ? west : northWest;\n    } else {\n      min = north < northWest ? north : northWest;\n    }\n\n    if (min == northWest) {\n      if (northWest == current) {\n        edits.push(EDIT_LEAVE);\n      } else {\n        edits.push(EDIT_UPDATE);\n        current = northWest;\n      }\n      i--;\n      j--;\n    } else if (min == west) {\n      edits.push(EDIT_DELETE);\n      i--;\n      current = west;\n    } else {\n      edits.push(EDIT_ADD);\n      j--;\n      current = north;\n    }\n  }\n\n  edits.reverse();\n  return edits;\n}\n\n/**\n * Splice Projection functions:\n *\n * A splice map is a representation of how a previous array of items\n * was transformed into a new array of items. Conceptually it is a list of\n * tuples of\n *\n *   <index, removed, addedCount>\n *\n * which are kept in ascending index order of. The tuple represents that at\n * the |index|, |removed| sequence of items were removed, and counting forward\n * from |index|, |addedCount| items were added.\n */\n\n/**\n * Lacking individual splice mutation information, the minimal set of\n * splices can be synthesized given the previous state and final state of an\n * array. The basic approach is to calculate the edit distance matrix and\n * choose the shortest path through it.\n *\n * Complexity: O(l * p)\n *   l: The length of the current array\n *   p: The length of the old array\n */\nfunction calcSplices(current, currentStart, currentEnd, old, oldStart, oldEnd) {\n  let prefixCount = 0;\n  let suffixCount = 0;\n  let splice;\n\n  let minLength = Math.min(currentEnd - currentStart, oldEnd - oldStart);\n  if (currentStart == 0 && oldStart == 0) {\n    prefixCount = sharedPrefix(current, old, minLength);\n  }\n\n  if (currentEnd == current.length && oldEnd == old.length) {\n    suffixCount = sharedSuffix(current, old, minLength - prefixCount);\n  }\n\n  currentStart += prefixCount;\n  oldStart += prefixCount;\n  currentEnd -= suffixCount;\n  oldEnd -= suffixCount;\n\n  if (currentEnd - currentStart == 0 && oldEnd - oldStart == 0) {\n    return [];\n  }\n\n  if (currentStart == currentEnd) {\n    splice = newSplice(currentStart, [], 0);\n    while (oldStart < oldEnd) {\n      splice.removed.push(old[oldStart++]);\n    }\n\n    return [splice];\n  } else if (oldStart == oldEnd) {\n    return [newSplice(currentStart, [], currentEnd - currentStart)];\n  }\n\n  let ops = spliceOperationsFromEditDistances(\n    calcEditDistances(current, currentStart, currentEnd, old, oldStart, oldEnd)\n  );\n\n  splice = undefined;\n  let splices = [];\n  let index = currentStart;\n  let oldIndex = oldStart;\n  for (let i = 0; i < ops.length; i++) {\n    switch (ops[i]) {\n      case EDIT_LEAVE:\n        if (splice) {\n          splices.push(splice);\n          splice = undefined;\n        }\n\n        index++;\n        oldIndex++;\n        break;\n      case EDIT_UPDATE:\n        if (!splice) {\n          splice = newSplice(index, [], 0);\n        }\n\n        splice.addedCount++;\n        index++;\n\n        splice.removed.push(old[oldIndex]);\n        oldIndex++;\n        break;\n      case EDIT_ADD:\n        if (!splice) {\n          splice = newSplice(index, [], 0);\n        }\n\n        splice.addedCount++;\n        index++;\n        break;\n      case EDIT_DELETE:\n        if (!splice) {\n          splice = newSplice(index, [], 0);\n        }\n\n        splice.removed.push(old[oldIndex]);\n        oldIndex++;\n        break;\n    }\n  }\n\n  if (splice) {\n    splices.push(splice);\n  }\n  return splices;\n}\n\nfunction sharedPrefix(current, old, searchLength) {\n  for (let i = 0; i < searchLength; i++) {\n    if (!equals(current[i], old[i])) {\n      return i;\n    }\n  }\n  return searchLength;\n}\n\nfunction sharedSuffix(current, old, searchLength) {\n  let index1 = current.length;\n  let index2 = old.length;\n  let count = 0;\n  while (count < searchLength && equals(current[--index1], old[--index2])) {\n    count++;\n  }\n\n  return count;\n}\n\nfunction equals(currentValue, previousValue) {\n  return currentValue === previousValue;\n}\n\nexport function calculateSplices(current, previous) {\n  return calcSplices(current, 0, current.length, previous, 0, previous.length);\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n// prettier-ignore\nimport {addEventListener, removeEventListener, dispatchEvent} from '../patch-events.js';\n\nexport const EventTargetPatches = utils.getOwnPropertyDescriptors({\n  dispatchEvent,\n\n  addEventListener,\n\n  removeEventListener,\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\n\nlet scopingShim = null;\n\nexport function getScopingShim() {\n  if (!scopingShim) {\n    scopingShim = window['ShadyCSS'] && window['ShadyCSS']['ScopingShim'];\n  }\n  return scopingShim || null;\n}\n\n/**\n * @param {!Node} node\n * @param {string} attr\n * @param {string} value\n */\nexport function scopeClassAttribute(node, attr, value) {\n  const scopingShim = getScopingShim();\n  if (scopingShim && attr === 'class') {\n    scopingShim['setElementClass'](node, value);\n    return true;\n  }\n  return false;\n}\n\n/**\n * @param {!Node} node\n * @param {string} newScopeName\n */\nexport function addShadyScoping(node, newScopeName) {\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return;\n  }\n  scopingShim['scopeNode'](node, newScopeName);\n}\n\n/**\n * @param {!Node} node\n * @param {string} currentScopeName\n */\nexport function removeShadyScoping(node, currentScopeName) {\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return;\n  }\n  scopingShim['unscopeNode'](node, currentScopeName);\n}\n\n/**\n * @param {!Node} node\n * @param {string} newScopeName\n * @param {string} oldScopeName\n */\nexport function replaceShadyScoping(node, newScopeName, oldScopeName) {\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return;\n  }\n  if (oldScopeName) {\n    removeShadyScoping(node, oldScopeName);\n  }\n  addShadyScoping(node, newScopeName);\n}\n\n/**\n * @param {!Node} node\n * @param {string} newScopeName\n * @return {boolean}\n */\nexport function currentScopeIsCorrect(node, newScopeName) {\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return true;\n  }\n  if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n    // NOTE: as an optimization, only check that all the top-level children\n    // have the correct scope.\n    let correctScope = true;\n    for (\n      let n = node[utils.SHADY_PREFIX + 'firstChild'];\n      n;\n      n = n[utils.SHADY_PREFIX + 'nextSibling']\n    ) {\n      correctScope = correctScope && currentScopeIsCorrect(n, newScopeName);\n    }\n    return correctScope;\n  }\n  if (node.nodeType !== Node.ELEMENT_NODE) {\n    return true;\n  }\n  const currentScope = scopingShim['currentScopeForNode'](node);\n  return currentScope === newScopeName;\n}\n\n/**\n * @param {!Node} node\n * @return {string}\n */\nexport function currentScopeForNode(node) {\n  if (node.nodeType !== Node.ELEMENT_NODE) {\n    return '';\n  }\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return '';\n  }\n  return scopingShim['currentScopeForNode'](node);\n}\n\n/**\n * Walk over a node's tree and apply visitorFn to each element node\n *\n * @param {Node} node\n * @param {function(!Node):void} visitorFn\n */\nexport function treeVisitor(node, visitorFn) {\n  if (!node) {\n    return;\n  }\n  // this check is necessary if `node` is a Document Fragment\n  if (node.nodeType === Node.ELEMENT_NODE) {\n    visitorFn(node);\n  }\n  for (\n    let n = node[utils.SHADY_PREFIX + 'firstChild'];\n    n;\n    n = n[utils.SHADY_PREFIX + 'nextSibling']\n  ) {\n    if (n.nodeType === Node.ELEMENT_NODE) {\n      treeVisitor(n, visitorFn);\n    }\n  }\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n// prettier-ignore\nimport {getScopingShim, removeShadyScoping, replaceShadyScoping, treeVisitor, currentScopeForNode, currentScopeIsCorrect} from '../style-scoping.js';\nimport {shadyDataForNode, ensureShadyDataForNode} from '../shady-data.js';\nimport {recordInsertBefore, recordRemoveChild} from '../link-nodes.js';\nimport {ownerShadyRootForNode} from '../attach-shadow.js';\n\nconst doc = window.document;\n\nconst preferPerformance = utils.settings.preferPerformance;\n\nconst nativeIsConnectedAccessors = /** @type {ObjectPropertyDescriptor} */ (Object.getOwnPropertyDescriptor(\n  Node.prototype,\n  'isConnected'\n));\n\nconst nativeIsConnected =\n  nativeIsConnectedAccessors && nativeIsConnectedAccessors.get;\n\nexport function clearNode(node) {\n  let firstChild;\n  while ((firstChild = node[utils.SHADY_PREFIX + 'firstChild'])) {\n    node[utils.SHADY_PREFIX + 'removeChild'](firstChild);\n  }\n}\n\nfunction removeOwnerShadyRoot(node) {\n  // optimization: only reset the tree if node is actually in a root\n  if (hasCachedOwnerRoot(node)) {\n    for (\n      let n = node[utils.SHADY_PREFIX + 'firstChild'];\n      n;\n      n = n[utils.SHADY_PREFIX + 'nextSibling']\n    ) {\n      removeOwnerShadyRoot(n);\n    }\n  }\n  const nodeData = shadyDataForNode(node);\n  if (nodeData) {\n    nodeData.ownerShadyRoot = undefined;\n  }\n}\n\nfunction hasCachedOwnerRoot(node) {\n  const nodeData = shadyDataForNode(node);\n  return Boolean(nodeData && nodeData.ownerShadyRoot !== undefined);\n}\n\n/**\n * Finds the first flattened node that is composed in the node's parent.\n * If the given node is a slot, then the first flattened node is returned\n * if it exists, otherwise advance to the node's nextSibling.\n * @param {Node} node within which to find first composed node\n * @returns {Node} first composed node\n */\nfunction firstComposedNode(node) {\n  let composed = node;\n  if (node && node.localName === 'slot') {\n    const nodeData = shadyDataForNode(node);\n    const flattened = nodeData && nodeData.flattenedNodes;\n    // Note, if `flattened` is falsey, it means that the containing shadowRoot\n    // has not rendered and therefore the `<slot>` is still in the composed\n    // DOM. If that's the case the `<slot>` is the first composed node.\n    if (flattened) {\n      composed = flattened.length\n        ? flattened[0]\n        : firstComposedNode(node[utils.SHADY_PREFIX + 'nextSibling']);\n    }\n  }\n  return composed;\n}\n\n/**\n * @param {Node} node\n * @param {Node=} addedNode\n * @param {Node=} removedNode\n */\nfunction scheduleObserver(node, addedNode, removedNode) {\n  const nodeData = shadyDataForNode(node);\n  const observer = nodeData && nodeData.observer;\n  if (observer) {\n    if (addedNode) {\n      if (addedNode.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n        for (let i = 0, l = addedNode.childNodes.length; i < l; i++) {\n          observer.addedNodes.push(addedNode.childNodes[i]);\n        }\n      } else {\n        observer.addedNodes.push(addedNode);\n      }\n    }\n    if (removedNode) {\n      observer.removedNodes.push(removedNode);\n    }\n    observer.schedule();\n  }\n}\n\nexport const NodePatches = utils.getOwnPropertyDescriptors({\n  /** @this {Node} */\n  get parentNode() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.parentNode;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'parentNode'];\n  },\n\n  /** @this {Node} */\n  get firstChild() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.firstChild;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'firstChild'];\n  },\n\n  /** @this {Node} */\n  get lastChild() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.lastChild;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'lastChild'];\n  },\n\n  /** @this {Node} */\n  get nextSibling() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.nextSibling;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'nextSibling'];\n  },\n\n  /** @this {Node} */\n  get previousSibling() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.previousSibling;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'previousSibling'];\n  },\n\n  /** @this {Node} */\n  get childNodes() {\n    let childNodes;\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      const nodeData = shadyDataForNode(this);\n      if (!nodeData.childNodes) {\n        nodeData.childNodes = [];\n        for (\n          let n = this[utils.SHADY_PREFIX + 'firstChild'];\n          n;\n          n = n[utils.SHADY_PREFIX + 'nextSibling']\n        ) {\n          nodeData.childNodes.push(n);\n        }\n      }\n      childNodes = nodeData.childNodes;\n    } else {\n      childNodes = this[utils.NATIVE_PREFIX + 'childNodes'];\n    }\n    childNodes.item = function (index) {\n      return childNodes[index];\n    };\n    return childNodes;\n  },\n\n  /** @this {Node} */\n  get parentElement() {\n    const nodeData = shadyDataForNode(this);\n    let l = nodeData && nodeData.parentNode;\n    if (l && l.nodeType !== Node.ELEMENT_NODE) {\n      l = null;\n    }\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'parentElement'];\n  },\n\n  /** @this {Node} */\n  get isConnected() {\n    if (nativeIsConnected && nativeIsConnected.call(this)) {\n      return true;\n    }\n    if (this.nodeType == Node.DOCUMENT_FRAGMENT_NODE) {\n      return false;\n    }\n    // Fast path for distributed nodes.\n    const ownerDocument = this.ownerDocument;\n    if (ownerDocument === null || utils.documentContains(ownerDocument, this)) {\n      return true;\n    }\n    // Slow path for non-distributed nodes.\n    let node = this;\n    while (node && !(node instanceof Document)) {\n      node =\n        node[utils.SHADY_PREFIX + 'parentNode'] ||\n        (utils.isShadyRoot(node)\n          ? /** @type {ShadowRoot} */ (node).host\n          : undefined);\n    }\n    return !!(node && node instanceof Document);\n  },\n\n  /** @this {Node} */\n  get textContent() {\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      let tc = [];\n      for (\n        let n = this[utils.SHADY_PREFIX + 'firstChild'];\n        n;\n        n = n[utils.SHADY_PREFIX + 'nextSibling']\n      ) {\n        if (n.nodeType !== Node.COMMENT_NODE) {\n          tc.push(n[utils.SHADY_PREFIX + 'textContent']);\n        }\n      }\n      return tc.join('');\n    } else {\n      return this[utils.NATIVE_PREFIX + 'textContent'];\n    }\n  },\n\n  /**\n   * @this {Node}\n   * @param {string} value\n   */\n  set textContent(value) {\n    if (typeof value === 'undefined' || value === null) {\n      value = '';\n    }\n    switch (this.nodeType) {\n      case Node.ELEMENT_NODE:\n      case Node.DOCUMENT_FRAGMENT_NODE:\n        if (\n          !utils.isTrackingLogicalChildNodes(this) &&\n          utils.settings.hasDescriptors\n        ) {\n          // may be removing a nested slot but fast path if we know we are not.\n          const firstChild = this[utils.SHADY_PREFIX + 'firstChild'];\n          if (\n            firstChild != this[utils.SHADY_PREFIX + 'lastChild'] ||\n            (firstChild && firstChild.nodeType != Node.TEXT_NODE)\n          ) {\n            clearNode(this);\n          }\n          this[utils.NATIVE_PREFIX + 'textContent'] = value;\n        } else {\n          clearNode(this);\n          // Document fragments must have no childNodes if setting a blank string\n          if (value.length > 0 || this.nodeType === Node.ELEMENT_NODE) {\n            this[utils.SHADY_PREFIX + 'insertBefore'](\n              document.createTextNode(value)\n            );\n          }\n        }\n        break;\n      default:\n        // Note, be wary of patching `nodeValue`.\n        this.nodeValue = value;\n        break;\n    }\n  },\n\n  // Patched `insertBefore`. Note that all mutations that add nodes are routed\n  // here. When a <slot> is added or a node is added to a host with a shadowRoot\n  // with a slot, a standard dom `insert` call is aborted and `_asyncRender`\n  // is called on the relevant shadowRoot. In all other cases, a standard dom\n  // `insert` can be made, but the location and ref_node may need to be changed.\n  /**\n   * @this {Node}\n   * @param {Node} node\n   * @param {Node=} ref_node\n   */\n  insertBefore(node, ref_node) {\n    // optimization: assume native insertBefore is ok if the nodes are not in the document.\n    if (this.ownerDocument !== doc && node.ownerDocument !== doc) {\n      this[utils.NATIVE_PREFIX + 'insertBefore'](node, ref_node);\n      return node;\n    }\n    if (node === this) {\n      throw Error(\n        `Failed to execute 'appendChild' on 'Node': The new child element contains the parent.`\n      );\n    }\n    if (ref_node) {\n      const refData = shadyDataForNode(ref_node);\n      const p = refData && refData.parentNode;\n      if (\n        (p !== undefined && p !== this) ||\n        (p === undefined &&\n          ref_node[utils.NATIVE_PREFIX + 'parentNode'] !== this)\n      ) {\n        throw Error(\n          `Failed to execute 'insertBefore' on 'Node': The node ` +\n            `before which the new node is to be inserted is not a child of this node.`\n        );\n      }\n    }\n    if (ref_node === node) {\n      return node;\n    }\n    scheduleObserver(this, node);\n    /** @type {!Array<!HTMLSlotElement>} */\n    const slotsAdded = [];\n    const ownerRoot = ownerShadyRootForNode(this);\n    /** @type {string} */\n    const newScopeName = ownerRoot\n      ? ownerRoot.host.localName\n      : currentScopeForNode(this);\n    /** @type {string} */\n    let oldScopeName;\n    // remove from existing location\n    const parentNode = node[utils.SHADY_PREFIX + 'parentNode'];\n    if (parentNode) {\n      oldScopeName = currentScopeForNode(node);\n      const skipUnscoping =\n        // Don't remove scoping if we're inserting into another shadowRoot;\n        // this would be unnecessary since it will be re-scoped below\n        Boolean(ownerRoot) ||\n        // Don't remove scoping if we're being moved between non-shadowRoot\n        // locations (the likely case is when moving pre-scoped nodes in a template)\n        !ownerShadyRootForNode(node) ||\n        // Under preferPerformance, don't remove scoping when moving back into\n        // a document fragment that was previously scoped; the assumption is\n        // that the user should only move correctly-scoped DOM back into it\n        (preferPerformance && this['__noInsertionPoint'] !== undefined);\n      parentNode[utils.SHADY_PREFIX + 'removeChild'](node, skipUnscoping);\n    }\n    // add to new parent\n    let allowNativeInsert = true;\n    const needsScoping =\n      (!preferPerformance ||\n        // Under preferPerformance, only re-scope if we're not coming from a\n        // pre-scoped doc fragment or back into a pre-scoped doc fragment\n        (node['__noInsertionPoint'] === undefined &&\n          this['__noInsertionPoint'] === undefined)) &&\n      !currentScopeIsCorrect(node, newScopeName);\n    const needsSlotFinding =\n      ownerRoot &&\n      !node['__noInsertionPoint'] &&\n      (!preferPerformance || node.nodeType === Node.DOCUMENT_FRAGMENT_NODE);\n    if (needsSlotFinding || needsScoping) {\n      // NOTE: avoid node.removeChild as this *can* trigger another patched\n      // method (e.g. custom elements) and we want only the shady method to run.\n      // The following table describes what style scoping actions should happen as a result of this insertion.\n      // document -> shadowRoot: replace\n      // shadowRoot -> shadowRoot: replace\n      // shadowRoot -> shadowRoot of same type: do nothing\n      // shadowRoot -> document: allow unscoping\n      // document -> document: do nothing\n      // The \"same type of shadowRoot\" and \"document to document cases rely on `currentScopeIsCorrect` returning true\n      if (needsScoping) {\n        // in a document or disconnected tree, replace scoping if necessary\n        oldScopeName = oldScopeName || currentScopeForNode(node);\n      }\n      treeVisitor(node, (node) => {\n        if (needsSlotFinding && node.localName === 'slot') {\n          slotsAdded.push(/** @type {!HTMLSlotElement} */ (node));\n        }\n        if (needsScoping) {\n          replaceShadyScoping(node, newScopeName, oldScopeName);\n        }\n      });\n    }\n    // if a slot is added, must render containing root.\n    if (slotsAdded.length) {\n      ownerRoot._addSlots(slotsAdded);\n      ownerRoot._asyncRender();\n    }\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      recordInsertBefore(node, this, ref_node);\n      const parentData = shadyDataForNode(this);\n      // if the node being inserted into has a shadowRoot, do not perform\n      // a native insertion\n      if (parentData.root) {\n        allowNativeInsert = false;\n        // when inserting into a host with a shadowRoot with slot, use\n        // `shadowRoot._asyncRender()` via `attach-shadow` module\n        // when inserting into a host with shadowRoot with NO slot, do nothing\n        // as the node should not be added to composed DOM anywhere.\n        if (utils.hasShadowRootWithSlot(this)) {\n          parentData.root._asyncRender();\n        }\n      }\n      // when inserting into a slot inside a shadowRoot, render the\n      // containing shadowRoot to update fallback content.\n      else if (ownerRoot && this.localName === 'slot') {\n        allowNativeInsert = false;\n        ownerRoot._asyncRender();\n      }\n    }\n    if (allowNativeInsert) {\n      // if adding to a shadyRoot, add to host instead\n      let container = utils.isShadyRoot(this)\n        ? /** @type {ShadowRoot} */ (this).host\n        : this;\n      // if ref_node, get the ref_node that's actually in composed dom.\n      if (ref_node) {\n        ref_node = firstComposedNode(ref_node);\n        container[utils.NATIVE_PREFIX + 'insertBefore'](node, ref_node);\n      } else {\n        container[utils.NATIVE_PREFIX + 'appendChild'](node);\n      }\n    }\n    // Since ownerDocument is not patched, it can be incorrect after this call\n    // if the node is physically appended via distribution. This can result\n    // in the custom elements polyfill not upgrading the node if it's in an inert doc.\n    // We correct this by calling `adoptNode`.\n    else if (node.ownerDocument !== this.ownerDocument) {\n      this.ownerDocument.adoptNode(node);\n    }\n    return node;\n  },\n\n  /**\n   * @this {Node}\n   * @param {Node} node\n   */\n  appendChild(node) {\n    // if this is a shadowRoot and the shadowRoot is passed as `node`\n    // then an optimized append has already been performed, so do nothing.\n    if (!(this == node && utils.isShadyRoot(node))) {\n      return this[utils.SHADY_PREFIX + 'insertBefore'](node);\n    }\n  },\n\n  /**\n   * Patched `removeChild`. Note that all dom \"removals\" are routed here.\n   * Removes the given `node` from the element's `children`.\n   * This method also performs dom composition.\n   * @this {Node}\n   * @param {Node} node\n   * @param {boolean=} skipUnscoping\n   */\n  removeChild(node, skipUnscoping = false) {\n    if (this.ownerDocument !== doc) {\n      return this[utils.NATIVE_PREFIX + 'removeChild'](node);\n    }\n    if (node[utils.SHADY_PREFIX + 'parentNode'] !== this) {\n      throw Error(\n        'The node to be removed is not a child of this node: ' + node\n      );\n    }\n    scheduleObserver(this, null, node);\n    let preventNativeRemove;\n    let ownerRoot = ownerShadyRootForNode(node);\n    const removingInsertionPoint =\n      ownerRoot && ownerRoot._removeContainedSlots(node);\n    const parentData = shadyDataForNode(this);\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      recordRemoveChild(node, this);\n      if (utils.hasShadowRootWithSlot(this)) {\n        parentData.root._asyncRender();\n        preventNativeRemove = true;\n      }\n    }\n    // unscope a node leaving a ShadowRoot if ShadyCSS is present, and this node\n    // is not going to be rescoped in `insertBefore`\n    if (\n      getScopingShim() &&\n      !skipUnscoping &&\n      ownerRoot &&\n      node.nodeType !== Node.TEXT_NODE\n    ) {\n      const oldScopeName = currentScopeForNode(node);\n      treeVisitor(node, (node) => {\n        removeShadyScoping(node, oldScopeName);\n      });\n    }\n    removeOwnerShadyRoot(node);\n    // if removing slot, must render containing root\n    if (ownerRoot) {\n      let changeSlotContent = this.localName === 'slot';\n      if (changeSlotContent) {\n        preventNativeRemove = true;\n      }\n      if (removingInsertionPoint || changeSlotContent) {\n        ownerRoot._asyncRender();\n      }\n    }\n    if (!preventNativeRemove) {\n      // if removing from a shadyRoot, remove from host instead\n      let container = utils.isShadyRoot(this)\n        ? /** @type {ShadowRoot} */ (this).host\n        : this;\n      // not guaranteed to physically be in container; e.g.\n      // (1) if parent has a shadyRoot, element may or may not at distributed\n      // location (could be undistributed)\n      // (2) if parent is a slot, element may not ben in composed dom\n      if (\n        !(parentData.root || node.localName === 'slot') ||\n        container === node[utils.NATIVE_PREFIX + 'parentNode']\n      ) {\n        container[utils.NATIVE_PREFIX + 'removeChild'](node);\n      }\n    }\n    return node;\n  },\n\n  /**\n   * @this {Node}\n   * @param {Node} node\n   * @param {Node=} ref_node\n   */\n  replaceChild(node, ref_node) {\n    this[utils.SHADY_PREFIX + 'insertBefore'](node, ref_node);\n    this[utils.SHADY_PREFIX + 'removeChild'](ref_node);\n    return node;\n  },\n\n  /**\n   * @this {Node}\n   * @param {boolean=} deep\n   */\n  cloneNode(deep) {\n    if (this.localName == 'template') {\n      return this[utils.NATIVE_PREFIX + 'cloneNode'](deep);\n    } else {\n      const n = this[utils.NATIVE_PREFIX + 'cloneNode'](false);\n      // Attribute nodes historically had childNodes, but they have later\n      // been removed from the spec.\n      // Make sure we do not do a deep clone on them for old browsers (IE11)\n      if (deep && n.nodeType !== Node.ATTRIBUTE_NODE) {\n        for (\n          let c = this[utils.SHADY_PREFIX + 'firstChild'], nc;\n          c;\n          c = c[utils.SHADY_PREFIX + 'nextSibling']\n        ) {\n          nc = c[utils.SHADY_PREFIX + 'cloneNode'](true);\n          n[utils.SHADY_PREFIX + 'appendChild'](nc);\n        }\n      }\n      return n;\n    }\n  },\n\n  /**\n   * @this {Node}\n   * @param {Object=} options\n   */\n  // TODO(sorvell): implement `options` e.g. `{ composed: boolean }`\n  getRootNode(options) {\n    if (!this || !this.nodeType) {\n      return;\n    }\n    const nodeData = ensureShadyDataForNode(this);\n    let root = nodeData.ownerShadyRoot;\n    if (root === undefined) {\n      if (utils.isShadyRoot(this)) {\n        root = this;\n        nodeData.ownerShadyRoot = root;\n      } else {\n        let parent = this[utils.SHADY_PREFIX + 'parentNode'];\n        root = parent\n          ? parent[utils.SHADY_PREFIX + 'getRootNode'](options)\n          : this;\n        // memo-ize result for performance but only memo-ize\n        // result if node is in the document. This avoids a problem where a root\n        // can be cached while an element is inside a fragment.\n        // If this happens and we cache the result, the value can become stale\n        // because for perf we avoid processing the subtree of added fragments.\n        if (document.documentElement[utils.NATIVE_PREFIX + 'contains'](this)) {\n          nodeData.ownerShadyRoot = root;\n        }\n      }\n    }\n    return root;\n  },\n\n  /** @this {Node} */\n  contains(node) {\n    return utils.contains(this, node);\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport {calculateSplices} from './array-splice.js';\nimport * as utils from './utils.js';\nimport {enqueue} from './flush.js';\nimport {ensureShadyDataForNode, shadyDataForNode} from './shady-data.js';\nimport {recordChildNodes} from './link-nodes.js';\nimport {patchShadyRoot} from './patch-shadyRoot.js';\n\n// Do not export this object. It must be passed as the first argument to the\n// ShadyRoot constructor in `attachShadow` to prevent the constructor from\n// throwing. This prevents the user from being able to manually construct a\n// ShadyRoot (i.e. `new ShadowRoot()`).\nconst ShadyRootConstructionToken = {};\n\nconst CATCHALL_NAME = '__catchall';\n\nconst MODE_CLOSED = 'closed';\n\nlet isRendering =\n  utils.settings['deferConnectionCallbacks'] &&\n  document.readyState === 'loading';\nlet rootRendered;\n\nfunction ancestorList(node) {\n  let ancestors = [];\n  do {\n    ancestors.unshift(node);\n  } while ((node = node[utils.SHADY_PREFIX + 'parentNode']));\n  return ancestors;\n}\n\n/**\n * @extends {ShadowRoot}\n */\nclass ShadyRoot {\n  constructor(token, host, options) {\n    if (token !== ShadyRootConstructionToken) {\n      throw new TypeError('Illegal constructor');\n    }\n    /** @type {boolean} */\n    this._renderPending;\n    /** @type {boolean} */\n    this._hasRendered;\n    /** @type {?Array<HTMLSlotElement>} */\n    this._slotList = null;\n    /** @type {?Object<string, Array<HTMLSlotElement>>} */\n    this._slotMap;\n    /** @type {?Array<HTMLSlotElement>} */\n    this._pendingSlots;\n    this._init(host, options);\n  }\n\n  _init(host, options) {\n    // root <=> host\n    this.host = host;\n    /** @type {!string|undefined} */\n    this.mode = options && options.mode;\n    recordChildNodes(this.host);\n    const hostData = ensureShadyDataForNode(this.host);\n    /** @type {!ShadyRoot} */\n    hostData.root = this;\n    hostData.publicRoot = this.mode !== MODE_CLOSED ? this : null;\n    // setup root\n    const rootData = ensureShadyDataForNode(this);\n    rootData.firstChild = rootData.lastChild = rootData.parentNode = rootData.nextSibling = rootData.previousSibling = null;\n    // NOTE: optimization flag, only require an asynchronous render\n    // to record parsed children if flag is not set.\n    if (utils.settings['preferPerformance']) {\n      let n;\n      while ((n = this.host[utils.NATIVE_PREFIX + 'firstChild'])) {\n        this.host[utils.NATIVE_PREFIX + 'removeChild'](n);\n      }\n    } else {\n      this._asyncRender();\n    }\n  }\n\n  _asyncRender() {\n    if (!this._renderPending) {\n      this._renderPending = true;\n      enqueue(() => this._render());\n    }\n  }\n\n  // returns the oldest renderPending ancestor root.\n  _getPendingDistributionRoot() {\n    let renderRoot;\n    let root = this;\n    while (root) {\n      if (root._renderPending) {\n        renderRoot = root;\n      }\n      root = root._getDistributionParent();\n    }\n    return renderRoot;\n  }\n\n  // Returns the shadyRoot `this.host` if `this.host`\n  // has children that require distribution.\n  _getDistributionParent() {\n    let root = this.host[utils.SHADY_PREFIX + 'getRootNode']();\n    if (!utils.isShadyRoot(root)) {\n      return;\n    }\n    const nodeData = shadyDataForNode(this.host);\n    if (nodeData && nodeData.__childSlotCount > 0) {\n      return root;\n    }\n  }\n\n  // Renders the top most render pending shadowRoot in the distribution tree.\n  // This is safe because when a distribution parent renders, all children render.\n  _render() {\n    // If this root is not pending, it needs no rendering work. Any pending\n    // parent that needs to render wll cause this root to render.\n    const root = this._renderPending && this._getPendingDistributionRoot();\n    if (root) {\n      root._renderSelf();\n    }\n  }\n\n  _flushInitial() {\n    if (!this._hasRendered && this._renderPending) {\n      this._render();\n    }\n  }\n\n  /** @override */\n  _renderSelf() {\n    // track rendering state.\n    const wasRendering = isRendering;\n    isRendering = true;\n    this._renderPending = false;\n    if (this._slotList) {\n      this._distribute();\n      this._compose();\n    }\n    // NOTE: optimization flag, only process parsed children\n    // if optimization flag is not set.\n    // on initial render remove any undistributed children.\n    if (!utils.settings['preferPerformance'] && !this._hasRendered) {\n      for (\n        let n = this.host[utils.SHADY_PREFIX + 'firstChild'];\n        n;\n        n = n[utils.SHADY_PREFIX + 'nextSibling']\n      ) {\n        const data = shadyDataForNode(n);\n        if (\n          n[utils.NATIVE_PREFIX + 'parentNode'] === this.host &&\n          (n.localName === 'slot' || !data.assignedSlot)\n        ) {\n          this.host[utils.NATIVE_PREFIX + 'removeChild'](n);\n        }\n      }\n    }\n    this._hasRendered = true;\n    isRendering = wasRendering;\n    if (rootRendered) {\n      rootRendered();\n    }\n  }\n\n  _distribute() {\n    this._validateSlots();\n    // capture # of previously assigned nodes to help determine if dirty.\n    for (let i = 0, slot; i < this._slotList.length; i++) {\n      slot = this._slotList[i];\n      this._clearSlotAssignedNodes(slot);\n    }\n    // distribute host children.\n    for (\n      let n = this.host[utils.SHADY_PREFIX + 'firstChild'];\n      n;\n      n = n[utils.SHADY_PREFIX + 'nextSibling']\n    ) {\n      this._distributeNodeToSlot(n);\n    }\n    // fallback content, slotchange, and dirty roots\n    for (let i = 0; i < this._slotList.length; i++) {\n      const slot = this._slotList[i];\n      const slotData = shadyDataForNode(slot);\n      // distribute fallback content\n      if (!slotData.assignedNodes.length) {\n        for (\n          let n = slot[utils.SHADY_PREFIX + 'firstChild'];\n          n;\n          n = n[utils.SHADY_PREFIX + 'nextSibling']\n        ) {\n          this._distributeNodeToSlot(n, slot);\n        }\n      }\n      const slotParentData = shadyDataForNode(\n        slot[utils.SHADY_PREFIX + 'parentNode']\n      );\n      const slotParentRoot = slotParentData && slotParentData.root;\n      if (\n        slotParentRoot &&\n        (slotParentRoot._hasInsertionPoint() || slotParentRoot._renderPending)\n      ) {\n        slotParentRoot._renderSelf();\n      }\n      this._addAssignedToFlattenedNodes(\n        slotData.flattenedNodes,\n        slotData.assignedNodes\n      );\n      let prevAssignedNodes = slotData._previouslyAssignedNodes;\n      if (prevAssignedNodes) {\n        for (let i = 0; i < prevAssignedNodes.length; i++) {\n          shadyDataForNode(prevAssignedNodes[i])._prevAssignedSlot = null;\n        }\n        slotData._previouslyAssignedNodes = null;\n        // dirty if previously less assigned nodes than previously assigned.\n        if (prevAssignedNodes.length > slotData.assignedNodes.length) {\n          slotData.dirty = true;\n        }\n      }\n      /* Note: A slot is marked dirty whenever a node is newly assigned to it\n      or a node is assigned to a different slot (done in `_distributeNodeToSlot`)\n      or if the number of nodes assigned to the slot has decreased (done above);\n      */\n      if (slotData.dirty) {\n        slotData.dirty = false;\n        this._fireSlotChange(slot);\n      }\n    }\n  }\n\n  /**\n   * Distributes given `node` to the appropriate slot based on its `slot`\n   * attribute. If `forcedSlot` is given, then the node is distributed to the\n   * `forcedSlot`.\n   * Note: slot to which the node is assigned will be marked dirty for firing\n   * `slotchange`.\n   * @param {Node} node\n   * @param {Node=} forcedSlot\n   *\n   */\n  _distributeNodeToSlot(node, forcedSlot) {\n    const nodeData = ensureShadyDataForNode(node);\n    let oldSlot = nodeData._prevAssignedSlot;\n    nodeData._prevAssignedSlot = null;\n    let slot = forcedSlot;\n    if (!slot) {\n      let name = node[utils.SHADY_PREFIX + 'slot'] || CATCHALL_NAME;\n      const list = this._slotMap[name];\n      slot = list && list[0];\n    }\n    if (slot) {\n      const slotData = ensureShadyDataForNode(slot);\n      slotData.assignedNodes.push(node);\n      nodeData.assignedSlot = slot;\n    } else {\n      nodeData.assignedSlot = undefined;\n    }\n    if (oldSlot !== nodeData.assignedSlot) {\n      if (nodeData.assignedSlot) {\n        ensureShadyDataForNode(nodeData.assignedSlot).dirty = true;\n      }\n    }\n  }\n\n  /**\n   * Clears the assignedNodes tracking data for a given `slot`. Note, the current\n   * assigned node data is tracked (via _previouslyAssignedNodes and\n   * _prevAssignedSlot) to see if `slotchange` should fire. This data may be out\n   *  of date at this time because the assigned nodes may have already been\n   * distributed to another root. This is ok since this data is only used to\n   * track changes.\n   * @param {HTMLSlotElement} slot\n   */\n  _clearSlotAssignedNodes(slot) {\n    const slotData = shadyDataForNode(slot);\n    let n$ = slotData.assignedNodes;\n    slotData.assignedNodes = [];\n    slotData.flattenedNodes = [];\n    slotData._previouslyAssignedNodes = n$;\n    if (n$) {\n      for (let i = 0; i < n$.length; i++) {\n        let n = shadyDataForNode(n$[i]);\n        n._prevAssignedSlot = n.assignedSlot;\n        // only clear if it was previously set to this slot;\n        // this helps ensure that if the node has otherwise been distributed\n        // ignore it.\n        if (n.assignedSlot === slot) {\n          n.assignedSlot = null;\n        }\n      }\n    }\n  }\n\n  _addAssignedToFlattenedNodes(flattened, assigned) {\n    for (let i = 0, n; i < assigned.length && (n = assigned[i]); i++) {\n      if (n.localName == 'slot') {\n        const nestedAssigned = shadyDataForNode(n).assignedNodes;\n        if (nestedAssigned && nestedAssigned.length) {\n          this._addAssignedToFlattenedNodes(flattened, nestedAssigned);\n        }\n      } else {\n        flattened.push(assigned[i]);\n      }\n    }\n  }\n\n  _fireSlotChange(slot) {\n    // NOTE: cannot bubble correctly here so not setting bubbles: true\n    // Safari tech preview does not bubble but chrome does\n    // Spec says it bubbles (https://dom.spec.whatwg.org/#mutation-observers)\n    slot[utils.NATIVE_PREFIX + 'dispatchEvent'](new Event('slotchange'));\n    const slotData = shadyDataForNode(slot);\n    if (slotData.assignedSlot) {\n      this._fireSlotChange(slotData.assignedSlot);\n    }\n  }\n\n  // Reify dom such that it is at its correct rendering position\n  // based on logical distribution.\n  // NOTE: here we only compose parents of <slot> elements and not the\n  // shadowRoot into the host. The latter is performend via a fast path\n  // in the `logical-mutation`.insertBefore.\n  _compose() {\n    const slots = this._slotList;\n    let composeList = [];\n    for (let i = 0; i < slots.length; i++) {\n      const parent = slots[i][utils.SHADY_PREFIX + 'parentNode'];\n      /* compose node only if:\n        (1) parent does not have a shadowRoot since shadowRoot has already\n        composed into the host\n        (2) we're not already composing it\n        [consider (n^2) but rare better than Set]\n      */\n      const parentData = shadyDataForNode(parent);\n      if (!(parentData && parentData.root) && composeList.indexOf(parent) < 0) {\n        composeList.push(parent);\n      }\n    }\n    for (let i = 0; i < composeList.length; i++) {\n      const node = composeList[i];\n      const targetNode = node === this ? this.host : node;\n      this._updateChildNodes(targetNode, this._composeNode(node));\n    }\n  }\n\n  // Returns the list of nodes which should be rendered inside `node`.\n  _composeNode(node) {\n    let children = [];\n    for (\n      let n = node[utils.SHADY_PREFIX + 'firstChild'];\n      n;\n      n = n[utils.SHADY_PREFIX + 'nextSibling']\n    ) {\n      // Note: if we see a slot here, the nodes are guaranteed to need to be\n      // composed here. This is because if there is redistribution, it has\n      // already been handled by this point.\n      if (this._isInsertionPoint(n)) {\n        let flattenedNodes = shadyDataForNode(n).flattenedNodes;\n        for (let j = 0; j < flattenedNodes.length; j++) {\n          let distributedNode = flattenedNodes[j];\n          children.push(distributedNode);\n        }\n      } else {\n        children.push(n);\n      }\n    }\n    return children;\n  }\n\n  _isInsertionPoint(node) {\n    return node.localName == 'slot';\n  }\n\n  // Ensures that the rendered node list inside `container` is `children`.\n  _updateChildNodes(container, children) {\n    let composed = utils.nativeChildNodesArray(container);\n    let splices = calculateSplices(children, composed);\n    // process removals\n    for (let i = 0, d = 0, s; i < splices.length && (s = splices[i]); i++) {\n      for (let j = 0, n; j < s.removed.length && (n = s.removed[j]); j++) {\n        // check if the node is still where we expect it is before trying\n        // to remove it; this can happen if we move a node and\n        // then schedule its previous host for distribution resulting in\n        // the node being removed here.\n        if (n[utils.NATIVE_PREFIX + 'parentNode'] === container) {\n          container[utils.NATIVE_PREFIX + 'removeChild'](n);\n        }\n        // TODO(sorvell): avoid the need for splicing here.\n        composed.splice(s.index + d, 1);\n      }\n      d -= s.addedCount;\n    }\n    // process adds\n    for (let i = 0, s, next; i < splices.length && (s = splices[i]); i++) {\n      // eslint-disable-line no-redeclare\n      next = composed[s.index];\n      for (let j = s.index, n; j < s.index + s.addedCount; j++) {\n        n = children[j];\n        container[utils.NATIVE_PREFIX + 'insertBefore'](n, next);\n        composed.splice(j, 0, n);\n      }\n    }\n  }\n\n  _ensureSlotData() {\n    this._pendingSlots = this._pendingSlots || [];\n    this._slotList = this._slotList || [];\n    this._slotMap = this._slotMap || {};\n  }\n\n  _addSlots(slots) {\n    this._ensureSlotData();\n    this._pendingSlots.push(...slots);\n  }\n\n  _validateSlots() {\n    if (this._pendingSlots && this._pendingSlots.length) {\n      this._mapSlots(this._pendingSlots);\n      this._pendingSlots = [];\n    }\n  }\n\n  /**\n   * Adds the given slots. Slots are maintained in an dom-ordered list.\n   * In addition a map of name to slot is updated.\n   */\n  _mapSlots(slots) {\n    let slotNamesToSort;\n    for (let i = 0; i < slots.length; i++) {\n      const slot = slots[i];\n      // ensure insertionPoints's and their parents have logical dom info.\n      // save logical tree info\n      // a. for shadyRoot\n      // b. for insertion points (fallback)\n      // c. for parents of insertion points\n      recordChildNodes(slot);\n      const slotParent = slot[utils.SHADY_PREFIX + 'parentNode'];\n      recordChildNodes(slotParent);\n      const slotParentData = shadyDataForNode(slotParent);\n      slotParentData.__childSlotCount =\n        (slotParentData.__childSlotCount || 0) + 1;\n      let name = this._nameForSlot(slot);\n      if (this._slotMap[name]) {\n        slotNamesToSort = slotNamesToSort || {};\n        slotNamesToSort[name] = true;\n        this._slotMap[name].push(slot);\n      } else {\n        this._slotMap[name] = [slot];\n      }\n      this._slotList.push(slot);\n    }\n    if (slotNamesToSort) {\n      for (let n in slotNamesToSort) {\n        this._slotMap[n] = this._sortSlots(this._slotMap[n]);\n      }\n    }\n  }\n\n  _nameForSlot(slot) {\n    const name = slot['name'] || slot.getAttribute('name') || CATCHALL_NAME;\n    slot.__slotName = name;\n    return name;\n  }\n\n  /**\n   * Slots are kept in an ordered list. Slots with the same name\n   * are sorted here by tree order.\n   */\n  _sortSlots(slots) {\n    // NOTE: Cannot use `compareDocumentPosition` because it's not polyfilled,\n    // but the code here could be used to polyfill the preceeding/following info\n    // in `compareDocumentPosition`.\n    return slots.sort((a, b) => {\n      let listA = ancestorList(a);\n      let listB = ancestorList(b);\n      for (var i = 0; i < listA.length; i++) {\n        let nA = listA[i];\n        let nB = listB[i];\n        if (nA !== nB) {\n          let c$ = utils.childNodesArray(nA[utils.SHADY_PREFIX + 'parentNode']);\n          return c$.indexOf(nA) - c$.indexOf(nB);\n        }\n      }\n    });\n  }\n\n  /**\n   * Removes from tracked slot data any slots contained within `container` and\n   * then updates the tracked data (_slotList and _slotMap).\n   * Any removed slots also have their `assignedNodes` removed from comopsed dom.\n   */\n  _removeContainedSlots(container) {\n    if (!this._slotList) {\n      return;\n    }\n    this._validateSlots();\n    let didRemove;\n    const map = this._slotMap;\n    for (let n in map) {\n      const slots = map[n];\n      for (let i = 0; i < slots.length; i++) {\n        const slot = slots[i];\n        if (utils.contains(container, slot)) {\n          slots.splice(i, 1);\n          const x = this._slotList.indexOf(slot);\n          if (x >= 0) {\n            this._slotList.splice(x, 1);\n            const slotParentData = shadyDataForNode(\n              slot[utils.SHADY_PREFIX + 'parentNode']\n            );\n            if (slotParentData && slotParentData.__childSlotCount) {\n              slotParentData.__childSlotCount--;\n            }\n          }\n          i--;\n          this._removeFlattenedNodes(slot);\n          didRemove = true;\n        }\n      }\n    }\n    return didRemove;\n  }\n\n  _updateSlotName(slot) {\n    if (!this._slotList) {\n      return;\n    }\n    // make sure slotMap is initialized with this slot\n    this._validateSlots();\n    const oldName = slot.__slotName;\n    const name = this._nameForSlot(slot);\n    if (name === oldName) {\n      return;\n    }\n    // remove from existing tracking\n    let slots = this._slotMap[oldName];\n    const i = slots.indexOf(slot);\n    if (i >= 0) {\n      slots.splice(i, 1);\n    }\n    // add to new location and sort if nedessary\n    let list = this._slotMap[name] || (this._slotMap[name] = []);\n    list.push(slot);\n    if (list.length > 1) {\n      this._slotMap[name] = this._sortSlots(list);\n    }\n  }\n\n  _removeFlattenedNodes(slot) {\n    const data = shadyDataForNode(slot);\n    let n$ = data.flattenedNodes;\n    if (n$) {\n      for (let i = 0; i < n$.length; i++) {\n        let node = n$[i];\n        let parent = node[utils.NATIVE_PREFIX + 'parentNode'];\n        if (parent) {\n          parent[utils.NATIVE_PREFIX + 'removeChild'](node);\n        }\n      }\n    }\n    data.flattenedNodes = [];\n    data.assignedNodes = [];\n  }\n\n  _hasInsertionPoint() {\n    this._validateSlots();\n    return Boolean(this._slotList && this._slotList.length);\n  }\n}\n\npatchShadyRoot(ShadyRoot.prototype);\nexport {ShadyRoot};\n\n/**\n  Implements a pared down version of ShadowDOM's scoping, which is easy to\n  polyfill across browsers.\n*/\nexport const attachShadow = (host, options) => {\n  if (!host) {\n    throw new Error('Must provide a host.');\n  }\n  if (!options) {\n    throw new Error('Not enough arguments.');\n  }\n  let root;\n  // Optimization for booting up a shadowRoot from a fragment rather than\n  // creating one.\n  if (options['shadyUpgradeFragment'] && utils.canUpgrade()) {\n    root = options['shadyUpgradeFragment'];\n    root.__proto__ = ShadowRoot.prototype;\n    root._init(host, options);\n    recordChildNodes(root, root);\n    // Note: qsa is native when used with noPatch.\n    /** @type {?NodeList<Element>} */\n    const slotsAdded = root['__noInsertionPoint']\n      ? null\n      : root.querySelectorAll('slot');\n    // Reset scoping information so normal scoing rules apply after this.\n    root['__noInsertionPoint'] = undefined;\n    // if a slot is added, must render containing root.\n    if (slotsAdded && slotsAdded.length) {\n      root._addSlots(slotsAdded);\n      root._asyncRender();\n    }\n    /** @type {ShadowRoot} */ (root).host[utils.NATIVE_PREFIX + 'appendChild'](\n      root\n    );\n  } else {\n    root = new ShadyRoot(ShadyRootConstructionToken, host, options);\n  }\n  return root;\n};\n\n// Mitigate connect/disconnect spam by wrapping custom element classes. This\n// should happen if custom elements are available in any capacity, polyfilled or\n// not.\nif (\n  utils.hasCustomElements() &&\n  utils.settings.inUse &&\n  !utils.settings['preferPerformance']\n) {\n  // process connect/disconnect after roots have rendered to avoid\n  // issues with reaction stack.\n  let connectMap = new Map();\n  rootRendered = function () {\n    // allow elements to connect\n    // save map state (without needing polyfills on IE11)\n    const r = [];\n    connectMap.forEach((v, k) => {\n      r.push([k, v]);\n    });\n    connectMap.clear();\n    for (let i = 0; i < r.length; i++) {\n      const e = r[i][0],\n        value = r[i][1];\n      if (value) {\n        e['__shadydom_connectedCallback']();\n      } else {\n        e['__shadydom_disconnectedCallback']();\n      }\n    }\n  };\n\n  // Document is in loading state and flag is set (deferConnectionCallbacks)\n  // so process connection stack when `readystatechange` fires.\n  if (isRendering) {\n    document.addEventListener(\n      'readystatechange',\n      () => {\n        isRendering = false;\n        rootRendered();\n      },\n      {once: true}\n    );\n  }\n\n  /*\n   * (1) elements can only be connected/disconnected if they are in the expected\n   * state.\n   * (2) never run connect/disconnect during rendering to avoid reaction stack issues.\n   */\n  const ManageConnect = (base, connected, disconnected) => {\n    let counter = 0;\n    const connectFlag = `__isConnected${counter++}`;\n    if (connected || disconnected) {\n      /** @this {!HTMLElement} */\n      base.prototype.connectedCallback = base.prototype[\n        '__shadydom_connectedCallback'\n      ] = function () {\n        // if rendering defer connected\n        // otherwise connect only if we haven't already\n        if (isRendering) {\n          connectMap.set(this, true);\n        } else if (!this[connectFlag]) {\n          this[connectFlag] = true;\n          if (connected) {\n            connected.call(this);\n          }\n        }\n      };\n\n      /** @this {!HTMLElement} */\n      base.prototype.disconnectedCallback = base.prototype[\n        '__shadydom_disconnectedCallback'\n      ] = function () {\n        // if rendering, cancel a pending connection and queue disconnect,\n        // otherwise disconnect only if a connection has been allowed\n        if (isRendering) {\n          // This is necessary only because calling removeChild\n          // on a node that requires distribution leaves it in the DOM tree\n          // until distribution.\n          // NOTE: remember this is checking the patched isConnected to determine\n          // if the node is in the logical tree.\n          if (!this.isConnected) {\n            connectMap.set(this, false);\n          }\n        } else if (this[connectFlag]) {\n          this[connectFlag] = false;\n          if (disconnected) {\n            disconnected.call(this);\n          }\n        }\n      };\n    }\n\n    return base;\n  };\n\n  const originalDefine = window['customElements']['define'];\n  const define = function (name, constructor) {\n    const connected = constructor.prototype.connectedCallback;\n    const disconnected = constructor.prototype.disconnectedCallback;\n    originalDefine.call(\n      window['customElements'],\n      name,\n      ManageConnect(constructor, connected, disconnected)\n    );\n    // unpatch connected/disconnected on class; custom elements tears this off\n    // so the patch is maintained, but if the user calls these methods for\n    // e.g. testing, they will be as expected.\n    constructor.prototype.connectedCallback = connected;\n    constructor.prototype.disconnectedCallback = disconnected;\n  };\n  // Note, it would be better to only patch the CustomElementRegistry.prototype,\n  // but ShadyCSS patches define directly.\n  window.customElements.define = define;\n  // Still patch the registry directly since Safari 10 loses the patch\n  // unless this is done.\n  Object.defineProperty(window['CustomElementRegistry'].prototype, 'define', {\n    value: define,\n    configurable: true,\n  });\n}\n\n/** @return {!ShadyRoot|undefined} */\nexport const ownerShadyRootForNode = (node) => {\n  let root = node[utils.SHADY_PREFIX + 'getRootNode']();\n  if (utils.isShadyRoot(root)) {\n    return root;\n  }\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {shadyDataForNode} from '../shady-data.js';\n\nexport const SlotablePatches = utils.getOwnPropertyDescriptors({\n  /** @this {Node} */\n  get assignedSlot() {\n    // Force any parent's shadowRoot to flush so that distribution occurs\n    // and this node has an assignedSlot.\n    const parent = this[utils.SHADY_PREFIX + 'parentNode'];\n    const ownerRoot = parent && parent[utils.SHADY_PREFIX + 'shadowRoot'];\n    if (ownerRoot) {\n      ownerRoot._render();\n    }\n    const nodeData = shadyDataForNode(this);\n    return (nodeData && nodeData.assignedSlot) || null;\n  },\n});\n","/**\n * @license\n * Copyright (c) 2022 The Polymer Project Authors\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/**\n * A map describing parentheses-like grouping characters and their behavior. The\n * keys are the group's start character and the value's `end` property contains\n * the end character. The `matchNestedParens` property indicates whether or not\n * other grouping characters nested in the group retain their grouping behavior\n * within that group - i.e. if nested grouping characters need to be matched.\n *\n * @type {!Map<string, {end: string, matchNestedParens: boolean}>}\n */\nconst PARENS = new Map();\n// IE 11 doesn't support `Map`'s constructor parameter.\n[\n  ['(', {end: ')', matchNestedParens: true}],\n  ['[', {end: ']', matchNestedParens: true}],\n  ['\"', {end: '\"', matchNestedParens: false}],\n  [\"'\", {end: \"'\", matchNestedParens: false}],\n].forEach(([k, v]) => {\n  PARENS.set(k, v);\n});\n\n/**\n * Finds the first character of `queryChars` within `str` from index `start`\n * onwards that is _not_ nested within any parentheses, brackets, or\n * single/double-quoted strings or part of an escape sequence.\n *\n * If the end of the string is reached without finding a character in\n * `queryChars`, the length of the string is returned.\n *\n * @param {string} str\n * @param {number} start\n * @param {!Array<string>} queryChars\n * @param {boolean} matchNestedParens\n * @return {number}\n */\nconst findNext = (str, start, queryChars, matchNestedParens = true) => {\n  for (let i = start; i < str.length; i++) {\n    if (str[i] === '\\\\' && i < str.length - 1 && str[i + 1] !== '\\n') {\n      // Skip escape sequences.\n      i++;\n    } else if (queryChars.indexOf(str[i]) !== -1) {\n      // One of `queryChars` was found.\n      return i;\n    } else if (matchNestedParens && PARENS.has(str[i])) {\n      // Handle any grouping characters by skipping over the group.\n      const parenInfo = PARENS.get(str[i]);\n      i = findNext(str, i + 1, [parenInfo.end], parenInfo.matchNestedParens);\n      continue;\n    }\n\n    // Do nothing, let `i++` happen.\n  }\n\n  // Reached the end of the string without finding a final char.\n  return str.length;\n};\n\n/**\n * Arrays of compound selectors and combinators that form a complex selector\n * when interleaved.\n *\n * @typedef {{\n *   compoundSelectors: !Array<string>,\n *   combinators: !Array<string>,\n * }}\n */\nexport let ComplexSelectorParts;\n\n/**\n * Splits a selector list into individual complex selectors and creates a\n * `ComplexSelectorParts` for each.\n *\n * @param {string} str\n * @return {!Array<!ComplexSelectorParts>}\n */\nexport const parseSelectorList = (str) => {\n  /**\n   * @type {!Array<!ComplexSelectorParts>}\n   */\n  const results = [];\n\n  /**\n   * Compound selectors and combinators parsed from the current complex\n   * selector.\n   *\n   * @type {!Array<string>}\n   */\n  const chunks = [];\n\n  /**\n   * Creates a new `ComplexSelectorParts` from the current `chunks`, pushes it\n   * into `results` and resets `chunks`.\n   */\n  const endComplexSelector = () => {\n    if (chunks.length > 0) {\n      while (chunks[chunks.length - 1] === ' ') {\n        chunks.pop();\n      }\n      results.push({\n        compoundSelectors: chunks.filter((x, i) => i % 2 === 0),\n        combinators: chunks.filter((x, i) => i % 2 === 1),\n      });\n      chunks.length = 0;\n    }\n  };\n\n  for (let i = 0; i < str.length; ) {\n    const prevChunk = chunks[chunks.length - 1];\n    // `nextIndex` is the next complex selector boundary, combinator, or\n    // whitespace that isn't inside other grouping characters.\n    const nextIndex = findNext(str, i, [',', ' ', '>', '+', '~']);\n    // If `nextIndex` is `i`, then the chunk we're considering is only the next\n    // single character.\n    const nextChunk = nextIndex === i ? str[i] : str.substring(i, nextIndex);\n\n    if (nextChunk === ',') {\n      endComplexSelector();\n    } else if (\n      [undefined, ' ', '>', '+', '~'].indexOf(prevChunk) !== -1 &&\n      nextChunk === ' '\n    ) {\n      // Ignore leading whitespace and whitespace directly after combinators.\n    } else if (prevChunk === ' ' && ['>', '+', '~'].indexOf(nextChunk) !== -1) {\n      // If the last chunk was whitespace and this chunk is a non-whitespace\n      // combinator, replace the whitespace with this combinator.\n      chunks[chunks.length - 1] = nextChunk;\n    } else {\n      chunks.push(nextChunk);\n    }\n\n    i = nextIndex + (nextIndex === i ? 1 : 0);\n  }\n\n  endComplexSelector();\n\n  return results;\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {shadyDataForNode} from '../shady-data.js';\nimport {ComplexSelectorParts, parseSelectorList} from '../selector-parser.js'; // eslint-disable-line @typescript-eslint/no-unused-vars\n\n/**\n * @param {Node} node\n * @param {Function} matcher\n * @param {Function=} halter\n */\nexport function query(node, matcher, halter) {\n  let list = [];\n  queryChildNodes(node, matcher, halter, list);\n  return list;\n}\n\nfunction queryChildNodes(parent, matcher, halter, list) {\n  for (\n    let n = parent[utils.SHADY_PREFIX + 'firstChild'];\n    n;\n    n = n[utils.SHADY_PREFIX + 'nextSibling']\n  ) {\n    if (\n      n.nodeType === Node.ELEMENT_NODE &&\n      queryElement(n, matcher, halter, list)\n    ) {\n      return true;\n    }\n  }\n}\n\nfunction queryElement(node, matcher, halter, list) {\n  let result = matcher(node);\n  if (result) {\n    list.push(node);\n  }\n  if (halter && halter(result)) {\n    return result;\n  }\n  queryChildNodes(node, matcher, halter, list);\n}\n\n// Needed on Element, DocumentFragment, Document\nexport const ParentNodePatches = utils.getOwnPropertyDescriptors({\n  /** @this {Element} */\n  get firstElementChild() {\n    const nodeData = shadyDataForNode(this);\n    if (nodeData && nodeData.firstChild !== undefined) {\n      let n = this[utils.SHADY_PREFIX + 'firstChild'];\n      while (n && n.nodeType !== Node.ELEMENT_NODE) {\n        n = n[utils.SHADY_PREFIX + 'nextSibling'];\n      }\n      return n;\n    } else {\n      return this[utils.NATIVE_PREFIX + 'firstElementChild'];\n    }\n  },\n\n  /** @this {Element} */\n  get lastElementChild() {\n    const nodeData = shadyDataForNode(this);\n    if (nodeData && nodeData.lastChild !== undefined) {\n      let n = this[utils.SHADY_PREFIX + 'lastChild'];\n      while (n && n.nodeType !== Node.ELEMENT_NODE) {\n        n = n[utils.SHADY_PREFIX + 'previousSibling'];\n      }\n      return n;\n    } else {\n      return this[utils.NATIVE_PREFIX + 'lastElementChild'];\n    }\n  },\n\n  /** @this {Element} */\n  get children() {\n    if (!utils.isTrackingLogicalChildNodes(this)) {\n      return this[utils.NATIVE_PREFIX + 'children'];\n    }\n    return utils.createPolyfilledHTMLCollection(\n      Array.prototype.filter.call(utils.childNodesArray(this), (n) => {\n        return n.nodeType === Node.ELEMENT_NODE;\n      })\n    );\n  },\n\n  /** @this {Element} */\n  get childElementCount() {\n    let children = this[utils.SHADY_PREFIX + 'children'];\n    if (children) {\n      return children.length;\n    }\n    return 0;\n  },\n\n  /** @this {Element} */\n  append(...args) {\n    this[utils.SHADY_PREFIX + 'insertBefore'](\n      utils.convertNodesIntoANode(...args),\n      null\n    );\n  },\n\n  /** @this {Element} */\n  prepend(...args) {\n    this[utils.SHADY_PREFIX + 'insertBefore'](\n      utils.convertNodesIntoANode(...args),\n      this[utils.SHADY_PREFIX + 'firstChild']\n    );\n  },\n\n  /** @this {Element} */\n  ['replaceChildren'](...args) {\n    let child;\n    while ((child = this[utils.SHADY_PREFIX + 'firstChild']) !== null) {\n      this[utils.SHADY_PREFIX + 'removeChild'](child);\n    }\n    this[utils.SHADY_PREFIX + 'insertBefore'](\n      utils.convertNodesIntoANode(...args),\n      null\n    );\n  },\n});\n\n/**\n * Performs the equivalent of `querySelectorAll` within Shady DOM's logical\n * model of the tree for a selector list.\n *\n * See <./logicalQuerySelectorAll.md> for implementation details.\n *\n * @param {!ParentNode} contextNode\n * @param {string} selectorList\n * @return {!Array<!Element>}\n */\nconst logicalQuerySelectorAll = (contextNode, selectorList) => {\n  /**\n   * @type {!Array<!ComplexSelectorParts>}\n   */\n  const complexSelectors = parseSelectorList(selectorList);\n\n  if (complexSelectors.length < 1) {\n    return [];\n  }\n\n  /**\n   * Determines if a single compound selector matches an element. If the\n   * selector contains `:scope` (as a substring), then the selector only is only\n   * considered matching if `element` is `contextNode`.\n   *\n   * @param {!Element} element\n   * @param {string} compoundSelector\n   * @return {boolean}\n   */\n  const matchesCompoundSelector = (element, compoundSelector) => {\n    return (\n      (element === contextNode || compoundSelector.indexOf(':scope') === -1) &&\n      utils.matchesSelector(element, compoundSelector)\n    );\n  };\n\n  /**\n   * An object used to track the current position of a potential selector match.\n   *\n   * - `target` is the element that would be considered matching if the cursor\n   * eventually results in a complete match.\n   *\n   * - `complexSelectorParts` is the parsed representation of the complex\n   * selector that this cursor is attempting to match.\n   *\n   * - `index` is the index into `.complexSelectorParts.compoundSelectors` of\n   * the last successfully matched compound selector.\n   *\n   * - `matchedElement` is the element that successfully matched the compound\n   * selector in `.complexSelectorParts.compoundSelectors` at `index`.\n   *\n   * @typedef {{\n   *   target: !Element,\n   *   complexSelectorParts: !ComplexSelectorParts,\n   *   matchedElement: !Element,\n   *   index: number,\n   * }}\n   */\n  let SelectorMatchingCursor; // eslint-disable-line @typescript-eslint/no-unused-vars\n\n  /**\n   * The list of `SelectorMatchingCursor`s, initialized with cursors pointing at\n   * all descendants of `contextNode` that match the last compound selector in\n   * any complex selector in `selectorList`.\n   *\n   * @type {!Array<!SelectorMatchingCursor>}\n   */\n  let cursors = utils.flat(\n    query(contextNode, (_element) => true).map((element) => {\n      return utils.flat(\n        complexSelectors.map((complexSelectorParts) => {\n          const {compoundSelectors} = complexSelectorParts;\n          // Selectors are matched by iterating their compound selectors in\n          // reverse order for efficiency. In particular, when finding\n          // candidates for the descendant combinator, iterating forwards would\n          // imply needing to walk all descendants of the last matched element\n          // for possible candidates, but iterating backwards only requires\n          // walking up the ancestor chain.\n          const index = compoundSelectors.length - 1;\n          if (matchesCompoundSelector(element, compoundSelectors[index])) {\n            return {\n              target: element,\n              complexSelectorParts,\n              matchedElement: element,\n              index,\n            };\n          } else {\n            return [];\n          }\n        })\n      );\n    })\n  );\n\n  // At each step, any remaining cursors that have not finished matching (i.e.\n  // with `cursor.index > 0`) should be replaced with new cursors for any valid\n  // candidates that match the next compound selector.\n  while (cursors.some((cursor) => cursor.index > 0)) {\n    cursors = utils.flat(\n      cursors.map((cursor) => {\n        // Cursors with `index` of 0 have already matched and should not be\n        // replaced or removed.\n        if (cursor.index <= 0) {\n          return cursor;\n        }\n\n        const {\n          target,\n          matchedElement,\n          complexSelectorParts,\n          index: lastIndex,\n        } = cursor;\n        const index = lastIndex - 1;\n        const combinator = complexSelectorParts.combinators[index];\n        const compoundSelector = complexSelectorParts.compoundSelectors[index];\n\n        if (combinator === ' ') {\n          const results = [];\n\n          // For `a b`, where existing cursors have `matchedElement`s matching\n          // `b`, the candidates to test against `a` are all ancestors of each\n          // cursor's `matchedElement`.\n          for (\n            let ancestor = matchedElement[utils.SHADY_PREFIX + 'parentElement'];\n            ancestor;\n            ancestor = ancestor[utils.SHADY_PREFIX + 'parentElement']\n          ) {\n            if (matchesCompoundSelector(ancestor, compoundSelector)) {\n              results.push({\n                target,\n                complexSelectorParts,\n                matchedElement: ancestor,\n                index,\n              });\n            }\n          }\n\n          return results;\n        } else if (combinator === '>') {\n          const parent = matchedElement[utils.SHADY_PREFIX + 'parentElement'];\n\n          // For `a > b`, where existing cursors have `matchedElement`s matching\n          // `b`, the candidates to test against `a` are the parents of each\n          // cursor's `matchedElement`.\n          if (matchesCompoundSelector(parent, compoundSelector)) {\n            return {\n              target,\n              complexSelectorParts,\n              matchedElement: parent,\n              index,\n            };\n          }\n\n          return [];\n        } else if (combinator === '+') {\n          const sibling =\n            matchedElement[utils.SHADY_PREFIX + 'previousElementSibling'];\n\n          // For `a + b`, where existing cursors have `matchedElement`s matching\n          // `b`, the candidates to test against `a` are the immediately\n          // preceding siblings of each cursor's `matchedElement`.\n          if (sibling && matchesCompoundSelector(sibling, compoundSelector)) {\n            return {\n              target,\n              complexSelectorParts,\n              matchedElement: sibling,\n              index,\n            };\n          }\n\n          return [];\n        } else if (combinator === '~') {\n          const results = [];\n\n          // For `a ~ b`, where existing cursors have `matchedElement`s matching\n          // `b`, the candidates to test against `a` are all preceding siblings\n          // of each cursor's `matchedElement`.\n          for (\n            let sibling =\n              matchedElement[utils.SHADY_PREFIX + 'previousElementSibling'];\n            sibling;\n            sibling = sibling[utils.SHADY_PREFIX + 'previousElementSibling']\n          ) {\n            if (matchesCompoundSelector(sibling, compoundSelector)) {\n              results.push({\n                target,\n                complexSelectorParts,\n                matchedElement: sibling,\n                index,\n              });\n            }\n          }\n\n          return results;\n        } else {\n          // As of writing, there are no other combinators:\n          // <https://drafts.csswg.org/selectors/#combinators>\n          throw new Error(`Unrecognized combinator: '${combinator}'.`);\n        }\n      })\n    );\n  }\n\n  // Map remaining cursors to their `target` and deduplicate.\n  return utils.deduplicate(cursors.map(({target}) => target));\n};\n\nconst querySelectorImplementation =\n  utils.settings['querySelectorImplementation'];\n\nexport const QueryPatches = utils.getOwnPropertyDescriptors({\n  /**\n   * @this {!ParentNode}\n   * @param {string} selector\n   */\n  querySelector(selector) {\n    if (querySelectorImplementation === 'native') {\n      // Polyfilled `ShadowRoot`s don't have a native `querySelectorAll`.\n      const target =\n        this instanceof ShadowRoot\n          ? /** @type {!ShadowRoot} */ (this).host\n          : this;\n      const candidates = Array.prototype.slice.call(\n        target[utils.NATIVE_PREFIX + 'querySelectorAll'](selector)\n      );\n      const root = this[utils.SHADY_PREFIX + 'getRootNode']();\n      // This could use `find`, but Closure doesn't polyfill it.\n      for (const candidate of candidates) {\n        if (candidate[utils.SHADY_PREFIX + 'getRootNode']() == root) {\n          return candidate;\n        }\n      }\n      return null;\n    } else if (querySelectorImplementation === 'selectorEngine') {\n      return logicalQuerySelectorAll(this, selector)[0] || null;\n    } else if (querySelectorImplementation === undefined) {\n      // match selector and halt on first result.\n      let result = query(\n        this,\n        function (n) {\n          return utils.matchesSelector(n, selector);\n        },\n        function (n) {\n          return Boolean(n);\n        }\n      )[0];\n      return result || null;\n    } else {\n      throw new Error(\n        'Unrecognized value of ShadyDOM.querySelectorImplementation: ' +\n          `'${querySelectorImplementation}'`\n      );\n    }\n  },\n\n  /**\n   * @this {!ParentNode}\n   * @param {string} selector\n   * @param {boolean} useNative\n   */\n  querySelectorAll(selector, useNative) {\n    if (useNative || querySelectorImplementation === 'native') {\n      // Polyfilled `ShadowRoot`s don't have a native `querySelectorAll`.\n      const target =\n        this instanceof ShadowRoot\n          ? /** @type {!ShadowRoot} */ (this).host\n          : this;\n      const candidates = Array.prototype.slice.call(\n        target[utils.NATIVE_PREFIX + 'querySelectorAll'](selector)\n      );\n      const root = this[utils.SHADY_PREFIX + 'getRootNode']();\n      return utils.createPolyfilledHTMLCollection(\n        candidates.filter(\n          (e) => e[utils.SHADY_PREFIX + 'getRootNode']() == root\n        )\n      );\n    } else if (querySelectorImplementation === 'selectorEngine') {\n      return utils.createPolyfilledHTMLCollection(\n        logicalQuerySelectorAll(this, selector)\n      );\n    } else if (querySelectorImplementation === undefined) {\n      return utils.createPolyfilledHTMLCollection(\n        query(this, function (n) {\n          return utils.matchesSelector(n, selector);\n        })\n      );\n    } else {\n      throw new Error(\n        'Unrecognized value of ShadyDOM.querySelectorImplementation: ' +\n          `'${querySelectorImplementation}'`\n      );\n    }\n  },\n});\n\n// In preferPerformance mode, create a custom `ParentNodeDocumentOrFragment`\n// that optionally does not mixin querySelector/All; this is a performance\n// optimization. In noPatch, we need to keep the query patches here in order to\n// ensure the query API is available on the wrapper\nexport const ParentNodeDocumentOrFragmentPatches =\n  utils.settings.preferPerformance && !utils.settings.noPatch\n    ? utils.assign({}, ParentNodePatches)\n    : ParentNodePatches;\n\nutils.assign(ParentNodePatches, QueryPatches);\n","/**\n@license\nCopyright (c) 2020 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n\nexport const ChildNodePatches = utils.getOwnPropertyDescriptors({\n  /** @this {Element} */\n  after(...args) {\n    const parentNode = this[utils.SHADY_PREFIX + 'parentNode'];\n    if (parentNode === null) {\n      return;\n    }\n    const nextSibling = this[utils.SHADY_PREFIX + 'nextSibling'];\n    parentNode[utils.SHADY_PREFIX + 'insertBefore'](\n      utils.convertNodesIntoANode(...args),\n      nextSibling\n    );\n  },\n\n  /** @this {Element} */\n  before(...args) {\n    const parentNode = this[utils.SHADY_PREFIX + 'parentNode'];\n    if (parentNode === null) {\n      return;\n    }\n    parentNode[utils.SHADY_PREFIX + 'insertBefore'](\n      utils.convertNodesIntoANode(...args),\n      this\n    );\n  },\n\n  /** @this {Element} */\n  remove() {\n    const parentNode = this[utils.SHADY_PREFIX + 'parentNode'];\n    if (parentNode === null) {\n      return;\n    }\n    parentNode[utils.SHADY_PREFIX + 'removeChild'](this);\n  },\n\n  /** @this {Element} */\n  replaceWith(...args) {\n    const parentNode = this[utils.SHADY_PREFIX + 'parentNode'];\n    if (parentNode === null) {\n      return;\n    }\n    const nextSibling = this[utils.SHADY_PREFIX + 'nextSibling'];\n    parentNode[utils.SHADY_PREFIX + 'removeChild'](this);\n    parentNode[utils.SHADY_PREFIX + 'insertBefore'](\n      utils.convertNodesIntoANode(...args),\n      nextSibling\n    );\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {scopeClassAttribute} from '../style-scoping.js';\nimport {shadyDataForNode} from '../shady-data.js';\nimport {attachShadow, ownerShadyRootForNode} from '../attach-shadow.js';\n// prettier-ignore\nimport {eventPropertyNamesForElement, wrappedDescriptorForEventProperty} from '../patch-events.js';\n\nconst doc = window.document;\n\n/**\n * Should be called whenever an attribute changes. If the `slot` attribute\n * changes, provokes rendering if necessary. If a `<slot>` element's `name`\n * attribute changes, updates the root's slot map and renders.\n * @param {Node} node\n * @param {string} name\n */\nfunction distributeAttributeChange(node, name) {\n  if (name === 'slot') {\n    const parent = node[utils.SHADY_PREFIX + 'parentNode'];\n    if (utils.hasShadowRootWithSlot(parent)) {\n      shadyDataForNode(parent).root._asyncRender();\n    }\n  } else if (node.localName === 'slot' && name === 'name') {\n    let root = ownerShadyRootForNode(node);\n    if (root) {\n      root._updateSlotName(node);\n      root._asyncRender();\n    }\n  }\n}\n\nexport const ElementPatches = utils.getOwnPropertyDescriptors({\n  /** @this {Element} */\n  get previousElementSibling() {\n    const nodeData = shadyDataForNode(this);\n    if (nodeData && nodeData.previousSibling !== undefined) {\n      let n = this[utils.SHADY_PREFIX + 'previousSibling'];\n      while (n && n.nodeType !== Node.ELEMENT_NODE) {\n        n = n[utils.SHADY_PREFIX + 'previousSibling'];\n      }\n      return n;\n    } else {\n      return this[utils.NATIVE_PREFIX + 'previousElementSibling'];\n    }\n  },\n\n  /** @this {Element} */\n  get nextElementSibling() {\n    const nodeData = shadyDataForNode(this);\n    if (nodeData && nodeData.nextSibling !== undefined) {\n      let n = this[utils.SHADY_PREFIX + 'nextSibling'];\n      while (n && n.nodeType !== Node.ELEMENT_NODE) {\n        n = n[utils.SHADY_PREFIX + 'nextSibling'];\n      }\n      return n;\n    } else {\n      return this[utils.NATIVE_PREFIX + 'nextElementSibling'];\n    }\n  },\n\n  /** @this {Element} */\n  get slot() {\n    return this.getAttribute('slot');\n  },\n\n  /** @this {Element} */\n  set slot(value) {\n    this[utils.SHADY_PREFIX + 'setAttribute']('slot', value);\n  },\n\n  /** @this {Element} */\n  get className() {\n    return this.getAttribute('class') || '';\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} value\n   */\n  set className(value) {\n    this[utils.SHADY_PREFIX + 'setAttribute']('class', value);\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} attr\n   * @param {string} value\n   */\n  setAttribute(attr, value) {\n    if (this.ownerDocument !== doc) {\n      this[utils.NATIVE_PREFIX + 'setAttribute'](attr, value);\n    } else if (!scopeClassAttribute(this, attr, value)) {\n      this[utils.NATIVE_PREFIX + 'setAttribute'](attr, value);\n      distributeAttributeChange(this, attr);\n    }\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} attr\n   */\n  removeAttribute(attr) {\n    if (this.ownerDocument !== doc) {\n      this[utils.NATIVE_PREFIX + 'removeAttribute'](attr);\n    } else if (!scopeClassAttribute(this, attr, '')) {\n      this[utils.NATIVE_PREFIX + 'removeAttribute'](attr);\n      distributeAttributeChange(this, attr);\n    } else if (this.getAttribute(attr) === '') {\n      // When attr='class', scopeClassAttribute() will handle the change as a\n      // side-effect and return `true`, allowing us to get to this branch,\n      // which cleans up the 'class' attribute if it's empty and we were\n      // supposed to have removed it.\n      this[utils.NATIVE_PREFIX + 'removeAttribute'](attr);\n    }\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} attr\n   * @param {boolean | undefined} force\n   */\n  toggleAttribute(attr, force) {\n    if (this.ownerDocument !== doc) {\n      return this[utils.NATIVE_PREFIX + 'toggleAttribute'](attr, force);\n    } else if (!scopeClassAttribute(this, attr, '')) {\n      const result = this[utils.NATIVE_PREFIX + 'toggleAttribute'](attr, force);\n      distributeAttributeChange(this, attr);\n      return result;\n    } else if (this.getAttribute(attr) === '' && !force) {\n      // When attr='class', scopeClassAttribute() will handle the change as a\n      // side-effect and return `true`, allowing us to get to this branch,\n      // which cleans up the 'class' attribute if it's empty and we were\n      // supposed to have removed it.\n      // We check for `force` being falsey because we only want to clean up on\n      // removal of the attribute.\n      return this[utils.NATIVE_PREFIX + 'toggleAttribute'](attr, force);\n    }\n  },\n});\n\nif (!utils.settings.preferPerformance) {\n  eventPropertyNamesForElement.forEach((property) => {\n    ElementPatches[property] = wrappedDescriptorForEventProperty(property);\n  });\n}\n\nexport const ElementShadowPatches = utils.getOwnPropertyDescriptors({\n  /**\n   * @this {Element}\n   * @param {!{mode: string}} options\n   */\n  attachShadow(options) {\n    const root = attachShadow(this, options);\n    // TODO(sorvell): Workaround for CE not seeing shadowRoot in `on-demand`\n    // noPatch mode. CE's attachShadow patch is overwritten by this patch\n    // and cannot set its own special tracking for shadowRoot. It does this\n    // to be able to see closed shadowRoots.\n    // This is necessary so that the CE polyfill can traverse into nodes\n    // with shadowRoot that will under `on-demand` have their childNodes patched.\n    this['__CE_shadowRoot'] = root;\n    return root;\n  },\n\n  // Note: Can be patched on element prototype on all browsers.\n  // Must be patched on instance on browsers that support native Shadow DOM\n  // but do not have builtin accessors (old Chrome).\n  /** @this {Element} */\n  get shadowRoot() {\n    const nodeData = shadyDataForNode(this);\n    return (nodeData && nodeData.publicRoot) || null;\n  },\n});\n\nutils.assign(ElementPatches, ElementShadowPatches);\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {getInnerHTML} from '../innerHTML.js';\nimport {clearNode} from './Node.js';\n\n/** @type {!Document} */\nconst inertDoc = document.implementation.createHTMLDocument('inert');\n\nexport const ElementOrShadowRootPatches = utils.getOwnPropertyDescriptors({\n  /** @this {Element} */\n  get innerHTML() {\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      const content =\n        this.localName === 'template'\n          ? /** @type {HTMLTemplateElement} */ (this).content\n          : this;\n      return getInnerHTML(content, utils.childNodesArray);\n    } else {\n      return this[utils.NATIVE_PREFIX + 'innerHTML'];\n    }\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} value\n   */\n  set innerHTML(value) {\n    if (this.localName === 'template') {\n      this[utils.NATIVE_PREFIX + 'innerHTML'] = value;\n    } else {\n      clearNode(this);\n      const containerName = this.localName || 'div';\n      let htmlContainer;\n      if (!this.namespaceURI || this.namespaceURI === inertDoc.namespaceURI) {\n        htmlContainer = inertDoc.createElement(containerName);\n      } else {\n        htmlContainer = inertDoc.createElementNS(\n          this.namespaceURI,\n          containerName\n        );\n      }\n      if (utils.settings.hasDescriptors) {\n        htmlContainer[utils.NATIVE_PREFIX + 'innerHTML'] = value;\n      } else {\n        htmlContainer.innerHTML = value;\n      }\n      let firstChild;\n      while ((firstChild = htmlContainer[utils.SHADY_PREFIX + 'firstChild'])) {\n        this[utils.SHADY_PREFIX + 'insertBefore'](firstChild);\n      }\n    }\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n// prettier-ignore\nimport {eventPropertyNamesForHTMLElement, wrappedDescriptorForEventProperty} from '../patch-events.js';\nimport {shadyDataForNode} from '../shady-data.js';\n\nexport const HTMLElementPatches = utils.getOwnPropertyDescriptors({\n  /** @this {HTMLElement} */\n  blur() {\n    const nodeData = shadyDataForNode(this);\n    let root = nodeData && nodeData.root;\n    let shadowActive = root && root.activeElement;\n    if (shadowActive) {\n      shadowActive[utils.SHADY_PREFIX + 'blur']();\n    } else {\n      this[utils.NATIVE_PREFIX + 'blur']();\n    }\n  },\n});\n\nif (!utils.settings.preferPerformance) {\n  eventPropertyNamesForHTMLElement.forEach((property) => {\n    HTMLElementPatches[property] = wrappedDescriptorForEventProperty(property);\n  });\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {shadyDataForNode} from '../shady-data.js';\nimport {addEventListener, removeEventListener} from '../patch-events.js';\n\nexport const SlotPatches = utils.getOwnPropertyDescriptors({\n  /**\n   * @this {HTMLSlotElement}\n   * @param {Object=} options\n   */\n  assignedNodes(options) {\n    if (this.localName === 'slot') {\n      // Force any containing shadowRoot to flush so that distribution occurs\n      // and this node has assignedNodes.\n      const root = this[utils.SHADY_PREFIX + 'getRootNode']();\n      if (root && utils.isShadyRoot(root)) {\n        root._render();\n      }\n      const nodeData = shadyDataForNode(this);\n      return nodeData\n        ? (options && options.flatten\n            ? nodeData.flattenedNodes\n            : nodeData.assignedNodes) || []\n        : [];\n    }\n  },\n\n  /**\n   * @this {HTMLSlotElement}\n   * @param {string} type\n   * @param {Function} fn\n   * @param {Object|boolean=} optionsOrCapture\n   */\n  addEventListener(type, fn, optionsOrCapture) {\n    // NOTE, check if this is a `slot` because these patches are installed on\n    // Element where browsers don't have `<slot>`\n    if (this.localName !== 'slot' || type === 'slotchange') {\n      addEventListener.call(this, type, fn, optionsOrCapture);\n    } else {\n      if (typeof optionsOrCapture !== 'object') {\n        optionsOrCapture = {\n          capture: Boolean(optionsOrCapture),\n        };\n      }\n      const parent = this[utils.SHADY_PREFIX + 'parentNode'];\n      if (!parent) {\n        throw new Error(\n          'ShadyDOM cannot attach event to slot unless it has a `parentNode`'\n        );\n      }\n      optionsOrCapture.__shadyTarget = this;\n      parent[utils.SHADY_PREFIX + 'addEventListener'](\n        type,\n        fn,\n        optionsOrCapture\n      );\n    }\n  },\n\n  /**\n   * @this {HTMLSlotElement}\n   * @param {string} type\n   * @param {Function} fn\n   * @param {Object|boolean=} optionsOrCapture\n   */\n  removeEventListener(type, fn, optionsOrCapture) {\n    // NOTE, check if this is a `slot` because these patches are installed on\n    // Element where browsers don't have `<slot>`\n    if (this.localName !== 'slot' || type === 'slotchange') {\n      removeEventListener.call(this, type, fn, optionsOrCapture);\n    } else {\n      if (typeof optionsOrCapture !== 'object') {\n        optionsOrCapture = {\n          capture: Boolean(optionsOrCapture),\n        };\n      }\n      const parent = this[utils.SHADY_PREFIX + 'parentNode'];\n      if (!parent) {\n        throw new Error(\n          'ShadyDOM cannot attach event to slot unless it has a `parentNode`'\n        );\n      }\n      optionsOrCapture.__shadyTarget = this;\n      parent[utils.SHADY_PREFIX + 'removeEventListener'](\n        type,\n        fn,\n        optionsOrCapture\n      );\n    }\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\nimport * as utils from '../utils.js';\nimport {query} from './ParentNode.js';\n\nexport const DocumentOrFragmentPatches = utils.getOwnPropertyDescriptors({\n  /**\n   * @this {Element}\n   * @param {string} id\n   */\n  getElementById(id) {\n    if (id === '') {\n      return null;\n    }\n    let result = query(\n      this,\n      function (n) {\n        return n.id == id;\n      },\n      function (n) {\n        return Boolean(n);\n      }\n    )[0];\n    return result || null;\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {ownerShadyRootForNode} from '../attach-shadow.js';\n\nfunction getDocumentActiveElement() {\n  if (utils.settings.hasDescriptors) {\n    return document[utils.NATIVE_PREFIX + 'activeElement'];\n  } else {\n    return document.activeElement;\n  }\n}\n\n// Get the element within the given set of roots.\nfunction getElInRoot(roots, el) {\n  let elRoot;\n  while (\n    el &&\n    !roots.has((elRoot = el[utils.SHADY_PREFIX + 'getRootNode']()))\n  ) {\n    el = elRoot.host;\n  }\n  return el;\n}\n\nfunction getAncestorRoots(docOrRoot) {\n  const roots = new Set();\n  roots.add(docOrRoot);\n  while (utils.isShadyRoot(docOrRoot) && docOrRoot.host) {\n    docOrRoot = docOrRoot.host[utils.SHADY_PREFIX + 'getRootNode']();\n    roots.add(docOrRoot);\n  }\n  return roots;\n}\n\nconst USE_NATIVE_DOCUMENT_EFP = 'useNativeDocumentEFP';\n\nconst elementsFromPointProperty =\n  utils.NATIVE_PREFIX +\n  utils.getPropertyName(Document.prototype, 'elementsFromPoint');\n\nexport const DocumentOrShadowRootPatches = utils.getOwnPropertyDescriptors({\n  /** @this {Document|ShadowRoot} */\n  get activeElement() {\n    let active = getDocumentActiveElement();\n    // In IE11, activeElement might be an empty object if the document is\n    // contained in an iframe.\n    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/10998788/\n    if (!active || !active.nodeType) {\n      return null;\n    }\n    let isShadyRoot = !!utils.isShadyRoot(this);\n    if (this !== document) {\n      // If this node isn't a document or shady root, then it doesn't have\n      // an active element.\n      if (!isShadyRoot) {\n        return null;\n      }\n      // If this shady root's host is the active element or the active\n      // element is not a descendant of the host (in the composed tree),\n      // then it doesn't have an active element.\n      if (\n        this.host === active ||\n        !this.host[utils.NATIVE_PREFIX + 'contains'](active)\n      ) {\n        return null;\n      }\n    }\n    // This node is either the document or a shady root of which the active\n    // element is a (composed) descendant of its host; iterate upwards to\n    // find the active element's most shallow host within it.\n    let activeRoot = ownerShadyRootForNode(active);\n    while (activeRoot && activeRoot !== this) {\n      active = activeRoot.host;\n      activeRoot = ownerShadyRootForNode(active);\n    }\n    if (this === document) {\n      // This node is the document, so activeRoot should be null.\n      return activeRoot ? null : active;\n    } else {\n      // This node is a non-document shady root, and it should be\n      // activeRoot.\n      return activeRoot === this ? active : null;\n    }\n  },\n\n  /** @this {Document|ShadowRoot} */\n  elementsFromPoint(x, y) {\n    const nativeResult = document[elementsFromPointProperty](x, y);\n    // support optionally opt-ing out for document\n    if (this === document && utils.settings[USE_NATIVE_DOCUMENT_EFP]) {\n      return nativeResult;\n    }\n    const nativeArray = utils.arrayFrom(nativeResult);\n    // Filter native result to return the element in this root\n    // OR an above root.\n    // Set containing this root and its ancestor roots.\n    const ancestorRoots = getAncestorRoots(this);\n    // Use a Set since the elements can repeat.\n    const rootedResult = new Set();\n    for (let i = 0; i < nativeArray.length; i++) {\n      rootedResult.add(getElInRoot(ancestorRoots, nativeArray[i]));\n    }\n    // Note, for IE compat avoid Array.from(set).\n    const r = [];\n    rootedResult.forEach((x) => r.push(x));\n    return r;\n  },\n\n  /** @this {Document|ShadowRoot} */\n  elementFromPoint(x, y) {\n    // support optionally opt-ing out for document\n    return this === document && utils.settings[USE_NATIVE_DOCUMENT_EFP]\n      ? this[utils.NATIVE_PREFIX + 'elementFromPoint'](x, y)\n      : this[utils.SHADY_PREFIX + 'elementsFromPoint'](x, y)[0] || null;\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n\nconst doc = window.document;\n\nexport const DocumentPatches = utils.getOwnPropertyDescriptors({\n  // note: Though not technically correct, we fast path `importNode`\n  // when called on a node not owned by the main document.\n  // This allows, for example, elements that cannot\n  // contain custom elements and are therefore not likely to contain shadowRoots\n  // to cloned natively. This is a fairly significant performance win.\n  /**\n   * @this {Document}\n   * @param {Node} node\n   * @param {boolean} deep\n   */\n  importNode(node, deep) {\n    // A template element normally has no children with shadowRoots, so make\n    // sure we always make a deep copy to correctly construct the template.content\n    if (node.ownerDocument !== doc || node.localName === 'template') {\n      return this[utils.NATIVE_PREFIX + 'importNode'](node, deep);\n    }\n    let n = this[utils.NATIVE_PREFIX + 'importNode'](node, false);\n    if (deep) {\n      for (\n        let c = node[utils.SHADY_PREFIX + 'firstChild'], nc;\n        c;\n        c = c[utils.SHADY_PREFIX + 'nextSibling']\n      ) {\n        nc = this[utils.SHADY_PREFIX + 'importNode'](c, true);\n        n[utils.SHADY_PREFIX + 'appendChild'](nc);\n      }\n    }\n    return n;\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\nimport * as utils from '../utils.js';\n// prettier-ignore\nimport {addEventListener, removeEventListener, dispatchEvent} from '../patch-events.js';\n\nexport const WindowPatches = utils.getOwnPropertyDescriptors({\n  // Ensure that `dispatchEvent` is patched directly on Window since on\n  // IE11, Window does not descend from EventTarget.\n  dispatchEvent,\n\n  // NOTE: ensure these methods are bound to `window` so that `this` is correct\n  // when called directly from global context without a receiver; e.g.\n  // `addEventListener(...)`.\n  addEventListener: addEventListener.bind(window),\n\n  removeEventListener: removeEventListener.bind(window),\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {EventTargetPatches} from './patches/EventTarget.js';\nimport {NodePatches} from './patches/Node.js';\nimport {SlotablePatches} from './patches/Slotable.js';\n// prettier-ignore\nimport {ParentNodePatches, ParentNodeDocumentOrFragmentPatches} from './patches/ParentNode.js';\nimport {ChildNodePatches} from './patches/ChildNode.js';\nimport {ElementPatches, ElementShadowPatches} from './patches/Element.js';\nimport {ElementOrShadowRootPatches} from './patches/ElementOrShadowRoot.js';\nimport {HTMLElementPatches} from './patches/HTMLElement.js';\nimport {SlotPatches} from './patches/Slot.js';\nimport {DocumentOrFragmentPatches} from './patches/DocumentOrFragment.js';\nimport {DocumentOrShadowRootPatches} from './patches/DocumentOrShadowRoot.js';\nimport {DocumentPatches} from './patches/Document.js';\nimport {WindowPatches} from './patches/Window.js';\n\n// Some browsers (IE/Edge) have non-standard HTMLElement accessors.\nconst NonStandardHTMLElement = {};\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'parentElement')) {\n  NonStandardHTMLElement.parentElement = NodePatches.parentElement;\n}\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'contains')) {\n  NonStandardHTMLElement.contains = NodePatches.contains;\n}\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'children')) {\n  NonStandardHTMLElement.children = ParentNodePatches.children;\n}\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'innerHTML')) {\n  NonStandardHTMLElement.innerHTML = ElementOrShadowRootPatches.innerHTML;\n}\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'className')) {\n  NonStandardHTMLElement.className = ElementPatches.className;\n}\n\n// Avoid patching `innerHTML` if it does not exist on Element (IE)\n// and we can patch accessors (hasDescriptors).\nconst ElementShouldHaveInnerHTML =\n  !utils.settings.hasDescriptors || 'innerHTML' in Element.prototype;\n\n// setup patching\nconst patchMap = {\n  EventTarget: [EventTargetPatches],\n  Node: [NodePatches, !window.EventTarget ? EventTargetPatches : null],\n  Text: [SlotablePatches],\n  Comment: [SlotablePatches],\n  CDATASection: [SlotablePatches],\n  ProcessingInstruction: [SlotablePatches],\n  Element: [\n    ElementPatches,\n    ParentNodePatches,\n    ChildNodePatches,\n    SlotablePatches,\n    ElementShouldHaveInnerHTML ? ElementOrShadowRootPatches : null,\n    !window.HTMLSlotElement ? SlotPatches : null,\n  ],\n  HTMLElement: [HTMLElementPatches, NonStandardHTMLElement],\n  HTMLSlotElement: [SlotPatches],\n  DocumentFragment: [\n    ParentNodeDocumentOrFragmentPatches,\n    DocumentOrFragmentPatches,\n  ],\n  Document: [\n    DocumentPatches,\n    ParentNodeDocumentOrFragmentPatches,\n    DocumentOrFragmentPatches,\n    DocumentOrShadowRootPatches,\n  ],\n  Window: [WindowPatches],\n  CharacterData: [ChildNodePatches],\n  XMLHttpRequest: [!window.EventTarget ? EventTargetPatches : null],\n};\n\nconst getPatchPrototype = (name) => window[name] && window[name].prototype;\n\n// Note, must avoid patching accessors on prototypes when descriptors are not correct\n// because the CustomElements polyfill checks if these exist before patching instances.\n// CustomElements polyfill *only* cares about these accessors.\nconst disallowedNativePatches = utils.settings.hasDescriptors\n  ? null\n  : ['innerHTML', 'textContent'];\n\n/**\n * Patch a group of accessors on an object.\n * @param {!Object} proto\n * @param {!Array<Object>} list\n * @param {string=} prefix\n * @param {Array=} disallowed\n */\nfunction applyPatchList(proto, list, prefix, disallowed) {\n  list.forEach(\n    (patch) =>\n      proto && patch && utils.patchProperties(proto, patch, prefix, disallowed)\n  );\n}\n\n/** @param {string=} prefix */\nexport const applyPatches = (prefix) => {\n  const disallowed = prefix ? null : disallowedNativePatches;\n  for (let p in patchMap) {\n    const proto = getPatchPrototype(p);\n    applyPatchList(proto, patchMap[p], prefix, disallowed);\n  }\n};\n\nconst PROTO_IS_PATCHED = utils.SHADY_PREFIX + 'protoIsPatched';\n\n// This property is stored directly on these objects, rather than in a local\n// Map, because IE11 has a bug around `defineProperty`/`hasOwnProperty` which\n// breaks Closure Compiler's WeakMap polyfill when using both certain native\n// prototypes (e.g. of CDATASection) and their instances as keys - even if\n// they're isolated to different WeakMaps. Closure's WeakMap polyfill is used\n// transitively by its own Map and Set polyfills, so this bug applies to any\n// situation where either of Map or Set are polyfilled also.\nconst PATCHED_PROTO = utils.SHADY_PREFIX + 'patchedProto';\n\n// Patch non-element prototypes up front so that we don't have to check\n// the type of Node when patching an can always assume we're patching an element.\n['Text', 'Comment', 'CDATASection', 'ProcessingInstruction'].forEach((name) => {\n  const ctor = window[name];\n  const patchedProto = Object.create(ctor.prototype);\n  patchedProto[PROTO_IS_PATCHED] = true;\n  applyPatchList(patchedProto, patchMap.EventTarget);\n  applyPatchList(patchedProto, patchMap.Node);\n  if (patchMap[name]) {\n    applyPatchList(patchedProto, patchMap[name]);\n  }\n  ctor.prototype[PATCHED_PROTO] = patchedProto;\n});\n\nexport const patchElementProto = (proto) => {\n  proto[PROTO_IS_PATCHED] = true;\n  applyPatchList(proto, patchMap.EventTarget);\n  applyPatchList(proto, patchMap.Node);\n  applyPatchList(proto, patchMap.Element);\n  applyPatchList(proto, patchMap.HTMLElement);\n  applyPatchList(proto, patchMap.HTMLSlotElement);\n  return proto;\n};\n\nexport const patchNodeProto = (node) => {\n  if (node[PROTO_IS_PATCHED] || utils.isShadyRoot(node)) {\n    return;\n  }\n  const nativeProto = Object.getPrototypeOf(node);\n  // Note, this hasOwnProperty check is critical to avoid seeing a patched\n  // prototype lower in the prototype chain, e.g. if an <s> element has been\n  // patched, without this check, an <input> element would get the wrong patch.\n  let proto =\n    nativeProto.hasOwnProperty(PATCHED_PROTO) && nativeProto[PATCHED_PROTO];\n  if (!proto) {\n    proto = Object.create(nativeProto);\n    patchElementProto(proto);\n    nativeProto[PATCHED_PROTO] = proto;\n  }\n  Object.setPrototypeOf(node, proto);\n};\n\nexport const patchShadowOnElement = () => {\n  utils.patchProperties(Element.prototype, ElementShadowPatches);\n};\n\nexport const addShadyPrefixedProperties = () => {\n  // perform shady patches\n  applyPatches(utils.SHADY_PREFIX);\n\n  // install `_activeElement` because some browsers (older Chrome/Safari) do not have\n  // a 'configurable' `activeElement` accesssor.\n  const descriptor = DocumentOrShadowRootPatches.activeElement;\n  Object.defineProperty(document, '_activeElement', descriptor);\n\n  // On Window, we're patching `addEventListener` which is a weird auto-bound\n  // property that is not directly on the Window prototype.\n  utils.patchProperties(Window.prototype, WindowPatches, utils.SHADY_PREFIX);\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {shadyDataForNode, ensureShadyDataForNode} from './shady-data.js';\n// prettier-ignore\nimport {patchInsideElementAccessors, patchOutsideElementAccessors} from './patch-instances.js';\nimport {patchNodeProto} from './patch-prototypes.js';\n\nconst OutsideAccessors = 1;\nconst InsideAcccessors = 2;\n\nconst patchOnDemand = utils.settings.patchOnDemand;\nconst hasDescriptors = utils.settings.hasDescriptors;\n\nfunction patchNode(node, type) {\n  if (patchOnDemand) {\n    patchNodeProto(node);\n  }\n  if (!hasDescriptors) {\n    if (type === OutsideAccessors) {\n      patchOutsideElementAccessors(node);\n    } else if (type === InsideAcccessors) {\n      patchInsideElementAccessors(node);\n    }\n  }\n}\n\nfunction linkNode(node, container, containerData, ref_node) {\n  patchNode(node, OutsideAccessors);\n  ref_node = ref_node || null;\n  const nodeData = ensureShadyDataForNode(node);\n  const ref_nodeData = ref_node ? ensureShadyDataForNode(ref_node) : null;\n  // update ref_node.previousSibling <-> node\n  nodeData.previousSibling = ref_node\n    ? ref_nodeData.previousSibling\n    : container[utils.SHADY_PREFIX + 'lastChild'];\n  let psd = shadyDataForNode(nodeData.previousSibling);\n  if (psd) {\n    psd.nextSibling = node;\n  }\n  // update node <-> ref_node\n  let nsd = shadyDataForNode((nodeData.nextSibling = ref_node));\n  if (nsd) {\n    nsd.previousSibling = node;\n  }\n  // update node <-> container\n  nodeData.parentNode = container;\n  if (ref_node) {\n    if (ref_node === containerData.firstChild) {\n      containerData.firstChild = node;\n    }\n  } else {\n    containerData.lastChild = node;\n    if (!containerData.firstChild) {\n      containerData.firstChild = node;\n    }\n  }\n  // remove caching of childNodes\n  containerData.childNodes = null;\n}\n\nexport const recordInsertBefore = (node, container, ref_node) => {\n  patchNode(container, InsideAcccessors);\n  const containerData = ensureShadyDataForNode(container);\n  if (containerData.firstChild !== undefined) {\n    containerData.childNodes = null;\n  }\n  // handle document fragments\n  if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n    // Note, documentFragments should not have logical DOM so there's\n    // no need update that. It is possible to append a ShadowRoot, but we're\n    // choosing not to support that.\n    const first = node[utils.NATIVE_PREFIX + 'firstChild'];\n    for (let n = first; n; n = n[utils.NATIVE_PREFIX + 'nextSibling']) {\n      linkNode(n, container, containerData, ref_node);\n    }\n  } else {\n    linkNode(node, container, containerData, ref_node);\n  }\n};\n\nexport const recordRemoveChild = (node, container) => {\n  const nodeData = ensureShadyDataForNode(node);\n  const containerData = ensureShadyDataForNode(container);\n  if (node === containerData.firstChild) {\n    containerData.firstChild = nodeData.nextSibling;\n  }\n  if (node === containerData.lastChild) {\n    containerData.lastChild = nodeData.previousSibling;\n  }\n  let p = nodeData.previousSibling;\n  let n = nodeData.nextSibling;\n  if (p) {\n    ensureShadyDataForNode(p).nextSibling = n;\n  }\n  if (n) {\n    ensureShadyDataForNode(n).previousSibling = p;\n  }\n  // When an element is removed, logical data is no longer tracked.\n  // Explicitly set `undefined` here to indicate this. This is disginguished\n  // from `null` which is set if info is null.\n  nodeData.parentNode = nodeData.previousSibling = nodeData.nextSibling = undefined;\n  if (containerData.childNodes !== undefined) {\n    // remove caching of childNodes\n    containerData.childNodes = null;\n  }\n};\n\n/**\n * @param  {!Node|DocumentFragment} node\n * @param  {!Node|DocumentFragment=} adoptedParent\n */\nexport const recordChildNodes = (node, adoptedParent) => {\n  const nodeData = ensureShadyDataForNode(node);\n  if (!adoptedParent && nodeData.firstChild !== undefined) {\n    return;\n  }\n  // remove caching of childNodes\n  nodeData.childNodes = null;\n  const first = (nodeData.firstChild =\n    node[utils.NATIVE_PREFIX + 'firstChild']);\n  nodeData.lastChild = node[utils.NATIVE_PREFIX + 'lastChild'];\n  patchNode(node, InsideAcccessors);\n  for (let n = first, previous; n; n = n[utils.NATIVE_PREFIX + 'nextSibling']) {\n    const sd = ensureShadyDataForNode(n);\n    sd.parentNode = adoptedParent || node;\n    sd.nextSibling = n[utils.NATIVE_PREFIX + 'nextSibling'];\n    sd.previousSibling = previous || null;\n    previous = n;\n    patchNode(n, OutsideAccessors);\n  }\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n\nexport const ShadowRootPatches = utils.getOwnPropertyDescriptors({\n  /**\n   * @this {ShadowRoot}\n   * @param {string} type\n   * @param {Function} fn\n   * @param {Object|boolean=} optionsOrCapture\n   */\n  addEventListener(type, fn, optionsOrCapture) {\n    if (typeof optionsOrCapture !== 'object') {\n      optionsOrCapture = {\n        capture: Boolean(optionsOrCapture),\n      };\n    }\n    // Note, `__shadyTarget` may already be set if an event was added on a <slot> child\n    optionsOrCapture.__shadyTarget = optionsOrCapture.__shadyTarget || this;\n    this.host[utils.SHADY_PREFIX + 'addEventListener'](\n      type,\n      fn,\n      optionsOrCapture\n    );\n  },\n\n  /**\n   * @this {ShadowRoot}\n   * @param {string} type\n   * @param {Function} fn\n   * @param {Object|boolean=} optionsOrCapture\n   */\n  removeEventListener(type, fn, optionsOrCapture) {\n    if (typeof optionsOrCapture !== 'object') {\n      optionsOrCapture = {\n        capture: Boolean(optionsOrCapture),\n      };\n    }\n    // Note, `__shadyTarget` may already be set if an event was added on a <slot> child\n    optionsOrCapture.__shadyTarget = optionsOrCapture.__shadyTarget || this;\n    this.host[utils.SHADY_PREFIX + 'removeEventListener'](\n      type,\n      fn,\n      optionsOrCapture\n    );\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {NodePatches} from './patches/Node.js';\n// prettier-ignore\nimport {OutsideDescriptors, InsideDescriptors, TextContentInnerHTMLDescriptors} from './patch-instances.js';\nimport {ParentNodePatches} from './patches/ParentNode.js';\nimport {DocumentOrFragmentPatches} from './patches/DocumentOrFragment.js';\nimport {DocumentOrShadowRootPatches} from './patches/DocumentOrShadowRoot.js';\nimport {ElementOrShadowRootPatches} from './patches/ElementOrShadowRoot.js';\nimport {ShadowRootPatches} from './patches/ShadowRoot.js';\n\n/**\n * @param {!Object} proto\n * @param {string=} prefix\n */\nconst patchShadyAccessors = (proto, prefix) => {\n  utils.patchProperties(proto, ShadowRootPatches, prefix);\n  utils.patchProperties(proto, DocumentOrShadowRootPatches, prefix);\n  utils.patchProperties(proto, ElementOrShadowRootPatches, prefix);\n  // We ensure ParentNode accessors since these do not exist in Edge/IE on DocumentFragments.\n  utils.patchProperties(proto, ParentNodePatches, prefix);\n  // Ensure `shadowRoot` has basic descriptors when we cannot rely\n  // on them coming from DocumentFragment.\n  //\n  // Case 1, noPatching: Because we want noPatch ShadyRoots to have native property\n  // names so that they do not have to be wrapped...\n  // When we do *not* patch Node/DocumentFragment.prototype\n  // we must manually install those properties on ShadyRoot's prototype.\n  // Note, it's important to only install these in this mode so as not to stomp\n  // over CustomElements polyfill's patches on Node/DocumentFragment methods.\n  if (utils.settings.noPatch && !prefix) {\n    utils.patchProperties(proto, NodePatches, prefix);\n    utils.patchProperties(proto, DocumentOrFragmentPatches, prefix);\n  }\n  // Case 2, bad descriptors: Ensure accessors are on ShadowRoot.\n  // These descriptors are normally used for instance patching but because\n  // ShadyRoot can always be patched, just do it to the prototype.\n  else if (!utils.settings.hasDescriptors) {\n    utils.patchProperties(proto, OutsideDescriptors);\n    utils.patchProperties(proto, InsideDescriptors);\n    utils.patchProperties(proto, TextContentInnerHTMLDescriptors);\n  }\n};\n\nexport const patchShadyRoot = (proto) => {\n  proto.__proto__ = DocumentFragment.prototype;\n\n  // patch both prefixed and not, even when noPatch == true.\n  patchShadyAccessors(proto, utils.SHADY_PREFIX);\n  patchShadyAccessors(proto);\n\n  // Ensure native properties are all safely wrapped since ShadowRoot is not an\n  // actual DocumentFragment instance.\n  Object.defineProperties(proto, {\n    nodeType: {\n      value: Node.DOCUMENT_FRAGMENT_NODE,\n      configurable: true,\n    },\n    nodeName: {\n      value: '#document-fragment',\n      configurable: true,\n    },\n    nodeValue: {\n      value: null,\n      configurable: true,\n    },\n  });\n\n  // make undefined\n  ['localName', 'namespaceURI', 'prefix'].forEach((prop) => {\n    Object.defineProperty(proto, prop, {\n      value: undefined,\n      configurable: true,\n    });\n  });\n\n  // defer properties to host\n  ['ownerDocument', 'baseURI', 'isConnected'].forEach((prop) => {\n    Object.defineProperty(proto, prop, {\n      /** @this {ShadowRoot} */\n      get() {\n        return this.host[prop];\n      },\n      configurable: true,\n    });\n  });\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\n// prettier-ignore\nimport {eventPropertyNamesForElement, eventPropertyNamesForHTMLElement} from './patch-events.js';\n\n/** @implements {IWrapper} */\nclass Wrapper {\n  /** @param {!Node} node */\n  constructor(node) {\n    this.node = node;\n  }\n\n  // node\n  addEventListener(name, fn, options) {\n    return this.node[utils.SHADY_PREFIX + 'addEventListener'](\n      name,\n      fn,\n      options\n    );\n  }\n\n  removeEventListener(name, fn, options) {\n    return this.node[utils.SHADY_PREFIX + 'removeEventListener'](\n      name,\n      fn,\n      options\n    );\n  }\n\n  appendChild(node) {\n    return this.node[utils.SHADY_PREFIX + 'appendChild'](node);\n  }\n\n  insertBefore(node, ref_node) {\n    return this.node[utils.SHADY_PREFIX + 'insertBefore'](node, ref_node);\n  }\n\n  removeChild(node) {\n    return this.node[utils.SHADY_PREFIX + 'removeChild'](node);\n  }\n\n  replaceChild(node, ref_node) {\n    return this.node[utils.SHADY_PREFIX + 'replaceChild'](node, ref_node);\n  }\n\n  cloneNode(deep) {\n    return this.node[utils.SHADY_PREFIX + 'cloneNode'](deep);\n  }\n\n  getRootNode(options) {\n    return this.node[utils.SHADY_PREFIX + 'getRootNode'](options);\n  }\n\n  contains(node) {\n    return this.node[utils.SHADY_PREFIX + 'contains'](node);\n  }\n\n  dispatchEvent(event) {\n    return this.node[utils.SHADY_PREFIX + 'dispatchEvent'](event);\n  }\n\n  // element\n  setAttribute(name, value) {\n    this.node[utils.SHADY_PREFIX + 'setAttribute'](name, value);\n  }\n\n  // NOTE: not needed, just here for balance\n  getAttribute(name) {\n    return this.node[utils.NATIVE_PREFIX + 'getAttribute'](name);\n  }\n\n  // NOTE: not needed, just here for balance\n  hasAttribute(name) {\n    return this.node[utils.NATIVE_PREFIX + 'hasAttribute'](name);\n  }\n\n  removeAttribute(name) {\n    this.node[utils.SHADY_PREFIX + 'removeAttribute'](name);\n  }\n\n  toggleAttribute(name, force) {\n    return this.node[utils.SHADY_PREFIX + 'toggleAttribute'](name, force);\n  }\n\n  attachShadow(options) {\n    return this.node[utils.SHADY_PREFIX + 'attachShadow'](options);\n  }\n\n  /** @return {!Node|undefined} */\n  get activeElement() {\n    if (\n      utils.isShadyRoot(this.node) ||\n      this.node.nodeType === Node.DOCUMENT_NODE\n    ) {\n      const e = this.node[utils.SHADY_PREFIX + 'activeElement'];\n      return e;\n    }\n    return undefined;\n  }\n\n  /**\n   * Installed for compatibility with browsers (older Chrome/Safari) that do\n   * not have a configurable `activeElement` accessor. Enables noPatch and\n   * patch mode both to consistently use ShadyDOM.wrap(document)._activeElement.\n   * @override\n   * @return {!Node|undefined}\n   */\n  get _activeElement() {\n    return this.activeElement;\n  }\n\n  // NOTE: not needed, just here for balance\n  /** @override */\n  focus() {\n    this.node[utils.NATIVE_PREFIX + 'focus']();\n  }\n\n  blur() {\n    this.node[utils.SHADY_PREFIX + 'blur']();\n  }\n\n  // document\n  importNode(node, deep) {\n    if (this.node.nodeType === Node.DOCUMENT_NODE) {\n      return this.node[utils.SHADY_PREFIX + 'importNode'](node, deep);\n    }\n  }\n\n  getElementById(id) {\n    if (this.node.nodeType === Node.DOCUMENT_NODE) {\n      return this.node[utils.SHADY_PREFIX + 'getElementById'](id);\n    }\n  }\n\n  elementsFromPoint(x, y) {\n    return this.node[utils.SHADY_PREFIX + 'elementsFromPoint'](x, y);\n  }\n\n  elementFromPoint(x, y) {\n    return this.node[utils.SHADY_PREFIX + 'elementFromPoint'](x, y);\n  }\n\n  // query\n  querySelector(selector) {\n    return this.node[utils.SHADY_PREFIX + 'querySelector'](selector);\n  }\n\n  querySelectorAll(selector, useNative) {\n    return this.node[utils.SHADY_PREFIX + 'querySelectorAll'](\n      selector,\n      useNative\n    );\n  }\n\n  // slot\n  assignedNodes(options) {\n    if (this.node.localName === 'slot') {\n      return this.node[utils.SHADY_PREFIX + 'assignedNodes'](options);\n    }\n  }\n\n  get host() {\n    if (utils.isShadyRoot(this.node)) {\n      return /** @type {!ShadowRoot} */ (this.node).host;\n    }\n    return undefined;\n  }\n\n  get parentNode() {\n    return this.node[utils.SHADY_PREFIX + 'parentNode'];\n  }\n\n  get firstChild() {\n    return this.node[utils.SHADY_PREFIX + 'firstChild'];\n  }\n\n  get lastChild() {\n    return this.node[utils.SHADY_PREFIX + 'lastChild'];\n  }\n\n  get nextSibling() {\n    return this.node[utils.SHADY_PREFIX + 'nextSibling'];\n  }\n\n  get previousSibling() {\n    return this.node[utils.SHADY_PREFIX + 'previousSibling'];\n  }\n\n  get childNodes() {\n    return this.node[utils.SHADY_PREFIX + 'childNodes'];\n  }\n\n  get parentElement() {\n    return this.node[utils.SHADY_PREFIX + 'parentElement'];\n  }\n\n  get firstElementChild() {\n    return this.node[utils.SHADY_PREFIX + 'firstElementChild'];\n  }\n\n  get lastElementChild() {\n    return this.node[utils.SHADY_PREFIX + 'lastElementChild'];\n  }\n\n  get nextElementSibling() {\n    return this.node[utils.SHADY_PREFIX + 'nextElementSibling'];\n  }\n\n  get previousElementSibling() {\n    return this.node[utils.SHADY_PREFIX + 'previousElementSibling'];\n  }\n\n  get children() {\n    return this.node[utils.SHADY_PREFIX + 'children'];\n  }\n\n  get childElementCount() {\n    return this.node[utils.SHADY_PREFIX + 'childElementCount'];\n  }\n\n  get shadowRoot() {\n    return this.node[utils.SHADY_PREFIX + 'shadowRoot'];\n  }\n\n  get assignedSlot() {\n    return this.node[utils.SHADY_PREFIX + 'assignedSlot'];\n  }\n\n  get isConnected() {\n    return this.node[utils.SHADY_PREFIX + 'isConnected'];\n  }\n\n  get innerHTML() {\n    return this.node[utils.SHADY_PREFIX + 'innerHTML'];\n  }\n\n  set innerHTML(value) {\n    this.node[utils.SHADY_PREFIX + 'innerHTML'] = value;\n  }\n\n  get textContent() {\n    return this.node[utils.SHADY_PREFIX + 'textContent'];\n  }\n\n  set textContent(value) {\n    this.node[utils.SHADY_PREFIX + 'textContent'] = value;\n  }\n\n  get slot() {\n    return this.node[utils.SHADY_PREFIX + 'slot'];\n  }\n\n  set slot(value) {\n    this.node[utils.SHADY_PREFIX + 'slot'] = value;\n  }\n\n  get className() {\n    return this.node[utils.SHADY_PREFIX + 'className'];\n  }\n\n  set className(value) {\n    this.node[utils.SHADY_PREFIX + 'className'] = value;\n  }\n\n  append(...args) {\n    return this.node[utils.SHADY_PREFIX + 'append'](...args);\n  }\n\n  prepend(...args) {\n    return this.node[utils.SHADY_PREFIX + 'prepend'](...args);\n  }\n\n  replaceChildren(...args) {\n    return this.node[utils.SHADY_PREFIX + 'replaceChildren'](...args);\n  }\n\n  after(...args) {\n    return this.node[utils.SHADY_PREFIX + 'after'](...args);\n  }\n\n  before(...args) {\n    return this.node[utils.SHADY_PREFIX + 'before'](...args);\n  }\n\n  remove() {\n    return this.node[utils.SHADY_PREFIX + 'remove']();\n  }\n\n  replaceWith(...args) {\n    return this.node[utils.SHADY_PREFIX + 'replaceWith'](...args);\n  }\n}\n\nconst addEventPropertyWrapper = (name) => {\n  Object.defineProperty(Wrapper.prototype, name, {\n    /** @this {Wrapper} */\n    get() {\n      return this.node[utils.SHADY_PREFIX + name];\n    },\n    /** @this {Wrapper} */\n    set(value) {\n      this.node[utils.SHADY_PREFIX + name] = value;\n    },\n    configurable: true,\n  });\n};\n\neventPropertyNamesForElement.forEach((name) => addEventPropertyWrapper(name));\neventPropertyNamesForHTMLElement.forEach((name) =>\n  addEventPropertyWrapper(name)\n);\n\nexport {Wrapper};\n\nconst wrapperMap = new WeakMap();\n\nexport function wrap(obj) {\n  if (utils.isShadyRoot(obj) || obj instanceof Wrapper) {\n    return obj;\n  }\n  let wrapper = wrapperMap.get(obj);\n  if (!wrapper) {\n    wrapper = new Wrapper(obj);\n    wrapperMap.set(obj, wrapper);\n  }\n  return wrapper;\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n/**\n * Patches elements that interacts with ShadyDOM\n * such that tree traversal and mutation apis act like they would under\n * ShadowDOM.\n *\n * This import enables seemless interaction with ShadyDOM powered\n * custom elements, enabling better interoperation with 3rd party code,\n * libraries, and frameworks that use DOM tree manipulation apis.\n */\n\nimport * as utils from './utils.js';\nimport {flush, enqueue} from './flush.js';\n// prettier-ignore\nimport {observeChildren, unobserveChildren, filterMutations} from './observe-changes.js';\n// prettier-ignore\nimport {addNativePrefixedProperties, nativeMethods, nativeTree} from './patch-native.js';\n// prettier-ignore\nimport {patchInsideElementAccessors, patchOutsideElementAccessors} from './patch-instances.js';\nimport {patchEvents, patchClick, composedPath} from './patch-events.js';\nimport {ShadyRoot} from './attach-shadow.js';\nimport {wrap, Wrapper} from './wrapper.js';\n// prettier-ignore\nimport {addShadyPrefixedProperties, applyPatches, patchShadowOnElement, patchElementProto} from './patch-prototypes.js';\n\nif (utils.settings.inUse) {\n  const patch = utils.settings.hasDescriptors\n    ? (n) => n\n    : (node) => {\n        patchInsideElementAccessors(node);\n        patchOutsideElementAccessors(node);\n        return node;\n      };\n\n  let ShadyDOM = {\n    // TODO(sorvell): remove when Polymer does not depend on this.\n    'inUse': utils.settings.inUse,\n    // NOTE: old browsers without prototype accessors (very old Chrome\n    // and Safari) need manually patched accessors to properly set\n    // `innerHTML` and `textContent` when an element is:\n    // (1) inside a shadowRoot\n    // (2) does not have special (slot) children itself\n    // (3) and setting the property needs to provoke distribution (because\n    // a nested slot is added/removed)\n    'patch': patch,\n    'isShadyRoot': utils.isShadyRoot,\n    'enqueue': enqueue,\n    'flush': flush,\n    'flushInitial': (root) => {\n      root._flushInitial();\n    },\n    'settings': utils.settings,\n    'filterMutations': filterMutations,\n    'observeChildren': observeChildren,\n    'unobserveChildren': unobserveChildren,\n    // Set to true to defer native custom elements connection until the\n    // document has fully parsed. This enables custom elements that create\n    // shadowRoots to be defined while the document is loading. Elements\n    // customized as they are created by the parser will successfully\n    // render with this flag on.\n    'deferConnectionCallbacks': utils.settings['deferConnectionCallbacks'],\n    // Set to true to speed up the polyfill slightly at the cost of correctness\n    // * does not patch querySelector/All on Document or DocumentFragment\n    // * does not wrap connected/disconnected callbacks to de-dup these\n    // when using native customElements\n    // * does not wait to process children of elements with shadowRoots\n    // meaning shadowRoots should not be created while an element is parsing\n    // (e.g. if a custom element that creates a shadowRoot is defined before\n    // a candidate element in the document below it.\n    'preferPerformance': utils.settings['preferPerformance'],\n    // Integration point with ShadyCSS to disable styling MutationObserver,\n    // as ShadyDOM will now handle dynamic scoping.\n    'handlesDynamicScoping': true,\n    // Ensure the node is wrapped. This should be used when `noPatch` is set\n    // to ensure Shadow DOM compatible DOM operation.\n    // Note, wrap falls back to patch so that it ensures API \"always just works\"\n    'wrap': utils.settings.noPatch ? wrap : patch,\n    // When code should be compatible with `noPatch` `true` and `on-demand`\n    // settings, `wrapIfNeeded` can be used for optimal performance (v. `wrap`)\n    // for all DOM operations except the following: `appendChild` and\n    // `insertBefore` (when the node is being moved from a location where it\n    // was logically positioned in the DOM); when setting `className`/`class`;\n    // when calling `querySelector|All`; when setting `textContent` or\n    // `innerHTML`; `addEventListener`, `removeEventListener` and\n    // `dispatchEvent`; and all scope specific API's like `getRootNode`,\n    // `isConnected`, `slot`, `assignedSlot`, `assignedNodes`. Note,\n    // `wrapIfNeeded` falls back to a pass through to preserve optimal\n    // performance.\n    'wrapIfNeeded': utils.settings.noPatch === true ? wrap : (n) => n,\n    'Wrapper': Wrapper,\n    'composedPath': composedPath,\n    // Set to true to avoid patching regular platform property names. When set,\n    // Shadow DOM compatible behavior is only available when accessing DOM\n    // API using `ShadyDOM.wrap`, e.g. `ShadyDOM.wrap(element).shadowRoot`.\n    // This setting provides a small performance boost, but requires all DOM API\n    // access that requires Shadow DOM behavior to be proxied via `ShadyDOM.wrap`.\n    //\n    // WARNING: When `noPatch` is set and the Custom Elements polyfill is\n    // needed, the Custom Elements polyfill must be loaded before this\n    // polyfill; however, when `noPatch` is not used, this polyfill should be\n    // loaded before the Custom Elements polyfill. This is because\n    // ShadyDOM captures DOM mutation methods and when `noPatch` is used,\n    // ShadyDOM must call the mutation methods patched by the Custom Elements\n    // polyfill or custom elements will not function as expected. When `noPatch`\n    // is not used, the Custom Elements polyfill patches call through to the\n    // ShadyDOM patches so ShadyDOM should be loaded first.\n    'noPatch': utils.settings.noPatch,\n    'patchOnDemand': utils.settings.patchOnDemand,\n    'nativeMethods': nativeMethods,\n    'nativeTree': nativeTree,\n    'patchElementProto': patchElementProto,\n    // Use this setting to choose the implementation of `querySelector` and\n    // `querySelectorAll`. The options provide different tradeoffs between\n    // accuracy and performance, as explained below. More specifically, the\n    // logical tree exposed by Shady DOM through the DOM APIs it wraps doesn't\n    // match the structure of the tree seen by the browser (the 'real tree'), so\n    // the degree to which the browser itself is used to match selectors affects\n    // this tradeoff.\n    //\n    // - `undefined` (default): Shady DOM will walk the logical descendants of\n    // the context element and call `matches` with the given selector to find\n    // matching elements.\n    //\n    //   This option is a balance between accuracy and performance. This option\n    //   will be able to match all logical descendants of the context element\n    //   (i.e. including descendants of unassigned nodes) but selectors are\n    //   matched against the real tree, so complex selectors may fail to match\n    //   since their combinators will attempt to match against the structure of\n    //   the real tree. Generally, you should only pass compound selectors when\n    //   using the default implementation. This implementation also breaks the\n    //   semantics of `:scope` because the wrapped `querySelector` call is\n    //   translated into many `matches` calls on different elements.\n    //\n    // - `'native'`: Shady DOM's wrapper for (e.g.) `querySelector` will call\n    // into the native `querySelector` function and then filter out results that\n    // are not in the same shadow root in the logical tree.\n    //\n    //   This is the fastest option. This option will not match elements that\n    //   are logical descendants of unassigned nodes because they will not be in\n    //   the real tree, against which the browser matches the selector. Like the\n    //   default option, this option may not correctly match complex selectors\n    //   (i.e. those with combinators) due to the structural differences between\n    //   the real tree and the logical tree. This option preserves the semantics\n    //   of `:scope` because the context element of the call to the wrapper is\n    //   also the context element of the call to the native function.\n    //\n    // - `'selectorEngine'`: Shady DOM's wrapper for (e.g.) `querySelector` will\n    // partially parse the given selector list and perform the tree-traversal\n    // steps of a selector engine against the logical tree.\n    //\n    //   This is the slowest and most accurate option. This option is able to\n    //   find all logical descendants of the context element by manually walking\n    //   the tree. This option is also able to correctly match complex selectors\n    //   because it does not rely on the browser to handle combinators. Despite\n    //   using `matches` to match compound selectors during selector evaluation,\n    //   this option preserves the semantics of `:scope` by only considering\n    //   compound selectors containing `:scope` to be matching if the context\n    //   element of the `matches` call is also the context element of the\n    //   wrapper call.\n    //\n    //   However, the parser used for this option is not strictly correct.\n    //   Notable caveats include:\n    //\n    //     - The parser assumes the selector list it's given is syntactically\n    //     correct. When given a selector that would not parse under a full\n    //     implementation, this implementation may fail silently.\n    //\n    //     - Nested selectors are _not_ taken into consideration while walking\n    //     the tree. Each outer-most compound selector is tested against\n    //     candidate elements as a whole, without modification. This means that\n    //     selectors nested in arguments of functional pseudo-classes, such as\n    //     `a > b` in `:is(a > b)`, are still matched by the browser against the\n    //     real tree, not Shady DOM's logical tree.\n    //\n    //     - `:scope` is only supported at the top-level. Particularly, if the\n    //     text `:scope` appears anywhere within a compound selector, then the\n    //     selector engine will only allow that compound selector to match the\n    //     context element. Having the text `:scope` inside a string\n    //     (`x[y=\":scope\"]`) or an argument to a functional pseudo-selector\n    //     (`:not(:scope > x)`) will likely break your selector.\n    //\n    //     - The `:host` and `:host-context` pseudo-classes are not supported.\n    //\n    //     - Comments are not supported. (e.g. `a /* b */ c`)\n    //\n    //     - The (draft) column combinator is not supported. (e.g. `a || b`)\n    'querySelectorImplementation':\n      utils.settings['querySelectorImplementation'],\n  };\n\n  window['ShadyDOM'] = ShadyDOM;\n\n  // Modifies native prototypes for Node, Element, etc. to\n  // make native platform behavior available at prefixed names, e.g.\n  // `utils.NATIVE_PREFIX + 'firstChild'` or `__shady_native_firstChild`.\n  // This allows the standard names to be safely patched while retaining the\n  // ability for native behavior to be used. This polyfill manipulates DOM\n  // by using this saved native behavior.\n  // Note, some browsers do not have proper element descriptors for\n  // accessors; in this case, native behavior for these accessors is simulated\n  // via a TreeWalker.\n  addNativePrefixedProperties();\n\n  // Modifies native prototypes for Node, Element, etc. to make ShadowDOM\n  // behavior available at prefixed names, e.g.\n  // `utils.SHADY_PREFIX + 'firstChild` or `__shady_firstChild`. This is done\n  // so this polyfill can perform Shadow DOM style DOM manipulation.\n  // Because patching normal platform property names is optional, these prefixed\n  // names are used internally.\n  addShadyPrefixedProperties();\n\n  // Modifies native prototypes for Node, Element, etc. to patch\n  // regular platform property names to have Shadow DOM compatible API behavior.\n  // This applies the utils.SHADY_PREFIX behavior to normal names. For example,\n  // if `noPatch` is not set, then `el.__shady_firstChild` is equivalent to\n  // `el.firstChild`.\n  // NOTE, on older browsers (old Chrome/Safari) native accessors cannot be\n  // patched on prototypes (e.g. Node.prototype.firstChild cannot be modified).\n  // On these browsers, instance level patching is performed where needed; this\n  // instance patching is only done when `noPatch` is *not* set.\n  if (!utils.settings.noPatch) {\n    applyPatches();\n    // Patch click event behavior only if we're patching\n    patchClick();\n  } else if (utils.settings.patchOnDemand) {\n    // In `on-demand` patching, do patch `attachShadow` and `shadowRoot`.\n    // These are the only patched properties in `on-demand` mode and these\n    // patches kick off patching \"on-demand\" for other nodes.\n    patchShadowOnElement();\n  }\n\n  // For simplicity, patch events unconditionally.\n  // Patches the event system to have Shadow DOM compatible behavior (e.g.\n  // event retargeting). When `noPatch` is set, retargeting is only available\n  // when adding event listeners and dispatching events via `ShadyDOM.wrap`\n  // (e.g. `ShadyDOM.wrap(element).addEventListener(...)`).\n  patchEvents();\n\n  window.ShadowRoot = /** @type {function(new:ShadowRoot)} */ (ShadyRoot);\n}\n"],"names":["ScopingShim","nativeCssVariables","nativeShadow","cssBuild","disableRuntime","scopingShim","ApplyShim","CustomStyleInterface","window","ShadyCSS","prepareTemplate","template","elementName","elementExtends","flushCustomStyles","prepareTemplateDom","prepareTemplateStyles","styleSubtree","element","properties","styleElement","styleDocument","getComputedStyleValue","property","nativeCss","templateMap","StyleNode","CURRENT_VERSION","NEXT_VERSION","VALIDATING_VERSION","promise","Promise","resolve","invalidate","invalidateTemplate","isValid","templateIsValid","isValidating","templateIsValidating","startValidating","startValidatingTemplate","_validating","then","elementsAreInvalid","VAR_ASSIGN","MIXIN_MATCH","VAR_CONSUMED","ANIMATION_MATCH","MEDIA_MATCH","IS_VAR","BRACKETED","HOST_PREFIX","HOST_SUFFIX","updateNativeProperties","p","style","removeProperty","setProperty","value","getComputedStyle","getPropertyValue","trim","detectMixin","cssText","has","test","lastIndex","constructor","parse","text","clean","parseCss","lex","replace","RX","comments","port","root","length","n","i","l","OPEN_BRACE","previous","push","CLOSE_BRACE","node","t","substring","ss","_expandUnicodeEscapes","multipleSpaces","lastIndexOf","s","indexOf","AT_START","MEDIA_START","types","MEDIA_RULE","match","keyframesRule","KEYFRAMES_RULE","split","pop","VAR_START","MIXIN_RULE","STYLE_RULE","r$","r","code","arguments","repeat","stringify","preserveProperties","undefined","_hasMixinRules","removeCustomProps","rules","Boolean","removeCustomPropAssignment","removeCustomPropApply","customProp","mixinProp","mixinApply","varApply","documentWait","CustomStyleProvider","SEEN_MARKER","CACHED_STYLE","transformFn","validateFn","enqueueDocumentValidation","addCustomStyle","getStyleForCustomStyle","customStyle","processStyles","cs","styleToTransform","prototype","Object","defineProperties","get","set","fn","needsEnqueue","CustomStyleInterfaceInterface","readyPromise","whenReady","resolveFn","callback","requestAnimationFrame","document","readyState","addEventListener","StyleTransformer","getIsExtends","elementHasBuiltCss","wrap","flush","getClasses","classList","getAttribute","scopeRegExp","RegExp","concat","SCOPE_NAME","getCurrentScope","getOwnerScope","ownerRoot","getRootNode","ownerDocument","host","is","ensureCorrectScope","currentScope","domRemoveScope","ShadowRoot","ownerScope","domReplaceScope","ensureCorrectSubtreeScoping","unscopedNodes","call","j","unscopedNode","scopeForPreviouslyUnscopedNode","isElementWithBuiltCss","el","localName","handler","mxns","x","mxn","target","documentElement","head","addedNodes","nodeType","Node","ELEMENT_NODE","newScope","observer","MutationObserver","start","observe","childList","subtree","nativeCustomElements","delayedStart","body","listener","removeEventListener","takeRecords","StyleUtil","StyleProperties","ensureStylePlaceholder","getStylePlaceholder","StyleInfo","StyleCache","watcherFlush","ApplyShimUtils","adoptedCssTextMap","styleCache","_scopeCounter","_documentOwner","ast","_documentOwnerStyleInfo","_elementsHaveApplied","_applyShim","_customStyleInterface","_generateScopeSelector","name","id","getStyleAst","rulesForStyle","styleAstToString","toCssText","_gatherStyles","gatherStyleText","content","typeExtension","_prepared","extends","getCssBuild","optimalBuild","isOptimalCssBuild","info","_ensure","hasMixins","ownPropertyNames","decorateStyles","placeholder","_generateStaticStyle","_style","_ownPropertyNames","prepareAdoptedCssText","cssTextArray","join","_domPrepared","domAddScope","shadowroot","elementStyles","applyCss","_prepareHost","ownStylePropertyNames","styleInfo","_ensureApplyShim","_ensureCustomStyleInterface","transformCustomStyleForDocument","needsApplyShimUpdate","customStyles","_reorderCustomStylesRules","_updateProperties","_applyCustomStyles","_revalidateCustomStyleApplyShim","styles","map","c","filter","sort","a","b","position","compareDocumentPosition","DOCUMENT_POSITION_FOLLOWING","DOCUMENT_POSITION_PRECEDING","styleRules","overrideProps","_mixOverrideStyleProps","styleElementNativeVariables","_isRootOwner","styleElementShimVariables","overrideStyleProperties","assign","_applyStyleProperties","textContent","shadowRoot","querySelector","_styleOwnerForNode","cacheEntry","fetch","styleProperties","cachedScopeSelector","scopeSelector","cachedStyle","oldScopeSelector","applyElementStyle","applyElementScopeSelector","store","owner","ownerStyleInfo","ownerProperties","props","create","hostAndRootProps","hostAndRootPropertiesForScope","propertyData","propertyDataFromStyles","propertiesMatchingHost","hostProps","rootProps","_mixinOverrideStyles","reify","overrides","v","wrappedHost","isRootOwner","descendantRoot","descendantHosts","Array","from","querySelectorAll","_revalidateApplyShim","applyCustomStyle","forEachRule","rule","normalizeRootSelector","documentRule","setElementClass","classString","classes","definitelyString","String","scopeName","classAttr","k$","XSCOPE_NAME","setElementClassRaw","_styleInfoForNode","scopeNode","scope","unscopeNode","scopeForNode","currentScopeForNode","typeMax","cache","_validate","idx","pn","tagname","list","shift","entry","infoKey","_getStyleRules","applyStylePlaceHolder","placeholderMap","ce","origDefine","wrappedDefine","clazz","options","matchesSelector","selector","method","matches","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","rootSelector","checkRoot","hostScope","IS_IE","navigator","userAgent","self","keyframes","ruleIndex","decorateRule","index","collectPropertiesInCssText","propertyInfo","onKeyframesRule","_keyframes","names","hasProperties","collectProperties","collectCssText","m","rx","any","exec","collectConsumingCssText","getOwnPropertyNames","valueForProperty","valueForProperties","prefix","fallback","suffix","propertyValue","processVariableAndFallback","parts","colon","pp","slice","applyProperties","output","applyKeyframeTransforms","keyframeTransforms","input","hasAnimations","transform","keyframeNamesToTransform","keyframe","o","selectorToMatch","transformedSelector","addToBitMask","key","whenHostOrRootRule","_calcHostScope","parsedSelector","isRoot","isHost","_transformRuleCss","_transformComplexSelector","_calcElementScope","_element","transformStyles","hostSelector","rxHostSelector","hostRx","_elementKeyframeTransforms","isKeyframesSelector","_scopeSelector","keyframesRules","_scopeKeyframes","_keyframesRuleTransformer","keyframesNameRx","transformedKeyframesName","scopeId","splitSelectorList","old","parentNode","removeChild","applyStyle","css","bits","parseInt","nativeCssVariables_","calcCssVariables","settings","shimcssproperties","CSS","supports","dom","shouldRemoveScope","_transformDom","startNode","transformer","c$","_content","childNodes","children","remove","add","CLASS","newValue","oldScope","ext","isScoped","CSS_CLASS_PREFIX","_transformRule","p$","part","COMPLEX_SELECTOR_SEP","_twiddleNthPlus","NTH","type","inside","_preserveMatchesPseudo","MATCHES","end","findMatchingParen","Error","MATCHES_REPLACEMENT","_replaceMatchesPseudo","reduce","acc","cur","stop","isNth","inner","isMatches","SLOTTED_START","HOST","SIMPLE_SELECTOR_SEP","_transformCompoundSelector","combinator","DIR_PAREN","before","dir","after","slottedIndex","SLOTTED","_transformHostSelector","_transformSimpleSelector","slotted","SLOTTED_PAREN","paren","attributes","PSEUDO_PREFIX","HOST_PAREN","SIMPLE_SELECTOR_PREFIX","typeSelector","SELECTOR_NO_MATCH","_transformDocumentSelector","ROOT","SCOPE_DOC_SELECTOR","processUnscopedStyle","isUnscopedStyle","styleRuleCallback","keyframesRuleCallback","onlyActiveRules","skipRules","matchMedia","moniker","contextNode","createScopeStyle","createElement","setAttribute","lastHeadApplyNode","placeHolder","createComment","insertBefore","firstChild","nextSibling","isTargetedBuild","buildType","level","str","comma","styleTextParts","CSS_BUILD_ATTR","__cssBuild","attrValue","buildComment","getBuildComment","removeBuildComment","Comment","commentParts","styleTextSet","Set","scopingAttribute","newStyle","appendChild","hasAttribute","aa","done","Symbol","iterator","next","q","ba","globalThis","global","Math","ca","da","ShadyData","toJSON","ensureShadyDataForNode","__shady","u","shadyDataForNode","ShadyDOM","Element","attachShadow","ea","getOwnPropertyDescriptor","configurable","N","force","noPatch","C","preferPerformance","O","fa","ha","querySelectorImplementation","ga","V","ia","Document","msElementsFromPoint","w","ja","ka","y","la","ma","createTextNode","na","oa","characterData","pa","qa","contains","__shady_native_contains","ra","__shady_parentNode","z","d","isNaN","item","e","namedItem","f","g","sa","__shady_native_firstChild","__shady_native_nextSibling","ta","__shady_firstChild","__shady_nextSibling","ua","defineProperty","A","va","B","forEach","wa","xa","D","createDocumentFragment","ya","isArray","apply","za","E","Aa","Ba","enqueue","F","Ca","AsyncObserver","removedNodes","H","Da","Ea","Z","Fa","delete","size","Ga","filterMutations","Ha","Ia","Ja","escapeReplace","Ka","makeSet","La","Ma","Na","getInnerHTML","h","k","S","TEXT_NODE","data","COMMENT_NODE","console","error","G","Oa","__shady_native_querySelector","__shady_native_querySelectorAll","Pa","Qa","I","J","createTreeWalker","NodeFilter","SHOW_ALL","K","SHOW_ELEMENT","Ra","implementation","createHTMLDocument","Sa","__shady_native_removeChild","Ta","Ua","Va","EventTarget","__shady_native_addEventListener","Window","XMLHttpRequest","currentNode","lastChild","previousSibling","parentElement","DOCUMENT_FRAGMENT_NODE","SHOW_TEXT","nextNode","nodeValue","__shady_native_insertBefore","HTMLElement","firstElementChild","lastElementChild","childElementCount","previousElementSibling","nextElementSibling","innerHTML","namespaceURI","createElementNS","className","HTMLTemplateElement","DocumentFragment","Wa","__shady_childNodes","__shady_lastChild","__shady_childElementCount","__shady_children","__shady_firstElementChild","__shady_lastElementChild","__shady_shadowRoot","Xa","__shady_textContent","__shady_innerHTML","Ya","__shady_parentElement","__shady_previousSibling","__shady_nextElementSibling","__shady_previousElementSibling","__shady_className","Za","enumerable","$a","ab","X","bb","W","customElements","polyfillWrapFlushCallback","L","Date","now","cb","Event","db","capture","eb","once","U","T","fb","blur","focus","focusin","focusout","click","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","wheel","beforeinput","keydown","keyup","compositionstart","compositionupdate","compositionend","touchstart","touchend","touchmove","touchcancel","pointerover","pointerenter","pointerdown","pointermove","pointerup","pointercancel","pointerout","pointerleave","gotpointercapture","lostpointercapture","dragstart","drag","dragenter","dragleave","dragover","drop","dragend","DOMActivate","DOMFocusIn","DOMFocusOut","keypress","gb","DOMAttrModified","DOMAttributeNameChanged","DOMCharacterDataModified","DOMElementNameChanged","DOMNodeInserted","DOMNodeInsertedIntoDocument","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMSubtreeModified","hb","getRootNodeWithFallback","__shady_getRootNode","M","pathComposer","__shady_assignedSlot","ib","__composedPath","jb","retarget","kb","composed","__composed","isTrusted","composedPath","__target","currentTarget","__previousCurrentTarget","relatedTarget","__relatedTarget","__relatedTargetComposedPath","stopPropagation","stopImmediatePropagation","__immediatePropagationStopped","lb","AT_TARGET","__shady_native_eventPhase","mb","mixinComposedFlag","__proto__","nb","ob","hasRetargeted","pb","fireHandlers","__handlers","qb","hasOwnProperty","rb","shadyDispatchEvent","bubbles","CAPTURING_PHASE","BUBBLING_PHASE","eventPhase","sb","findListener","tb","dispatchEvent","ub","__shady_native_dispatchEvent","vb","handleEvent","__shady_removeEventListener","bubble","wb","__shady_native_removeEventListener","splice","xb","activateFocusEventOverrides","yb","patchEvent","getPrototypeOf","__shady_sourceProto","__shady_patchedProto","zb","Ab","CustomEvent","Bb","MouseEvent","Cb","patchClick","cancelable","__shady_dispatchEvent","Db","Eb","Fb","__shady_addEventListener","newSplice","Gb","calcSplices","min","Hb","reverse","equals","Ib","Jb","getScopingShim","Kb","scopeClassAttribute","Lb","removeShadyScoping","Mb","currentScopeIsCorrect","Nb","Ob","treeVisitor","Pb","Qb","Rb","Sb","Tb","clearNode","__shady_removeChild","Ub","removeOwnerShadyRoot","Vb","firstComposedNode","Wb","scheduleObserver","ac","__shady_native_parentNode","__shady_native_lastChild","__shady_native_previousSibling","__shady_native_childNodes","__shady_native_parentElement","isConnected","__shady_native_textContent","__shady_insertBefore","P","__noInsertionPoint","Xb","Q","Yb","__shady_native_appendChild","adoptNode","Zb","$b","replaceChild","cloneNode","__shady_native_cloneNode","ATTRIBUTE_NODE","__shady_cloneNode","__shady_appendChild","R","assignedSlot","bc","cc","Map","dc","ec","fc","query","gc","queryChildNodes","hc","__shady_native_firstElementChild","__shady_native_lastElementChild","__shady_native_children","append","prepend","replaceChildren","ic","some","jc","kc","lc","replaceWith","mc","nc","distributeAttributeChange","oc","Y","pc","qc","rc","__shady_native_previousElementSibling","__shady_native_nextElementSibling","slot","__shady_setAttribute","__shady_native_setAttribute","removeAttribute","__shady_native_removeAttribute","toggleAttribute","__shady_native_toggleAttribute","wc","shadyUpgradeFragment","sc","tc","uc","vc","__CE_shadowRoot","xc","yc","__shady_native_innerHTML","zc","activeElement","__shady_blur","__shady_native_blur","Ac","assignedNodes","flatten","Bc","getElementById","Cc","getElInRoot","Dc","getAncestorRoots","Ec","Fc","__shady_native_activeElement","elementsFromPoint","useNativeDocumentEFP","elementFromPoint","__shady_native_elementFromPoint","__shady_elementsFromPoint","Gc","Hc","importNode","__shady_native_importNode","__shady_importNode","Ic","bind","Text","CDATASection","ProcessingInstruction","HTMLSlotElement","CharacterData","Jc","applyPatchList","Kc","__shady_protoIsPatched","Lc","Mc","Nc","Oc","patchNode","setPrototypeOf","Pc","linkNode","Qc","Rc","deferConnectionCallbacks","Sc","Tc","ancestorList","unshift","ShadyRoot","TypeError","mode","_renderSelf","Uc","Vc","Wc","__shady_slot","nodeName","define","Xc","clear","__shadydom_connectedCallback","__shadydom_disconnectedCallback","Yc","connectedCallback","disconnectedCallback","Zc","$c","CustomElementRegistry","Wrapper","__shady_replaceChild","__shady_contains","__shady_native_getAttribute","__shady_removeAttribute","__shady_toggleAttribute","__shady_attachShadow","__shady_native_focus","DOCUMENT_NODE","__shady_getElementById","__shady_elementFromPoint","__shady_querySelector","__shady_querySelectorAll","__shady_assignedNodes","__shady_append","__shady_prepend","__shady_after","__shady_before","__shady_remove","__shady_replaceWith","__shady_activeElement","_activeElement","__shady_isConnected","ad","bd","WeakMap","cd","dd","inUse","patch","isShadyRoot","flushInitial","observeChildren","unobserveChildren","handlesDynamicScoping","wrapIfNeeded","patchOnDemand","nativeMethods","nativeTree","patchElementProto"],"sourceRoot":""}